/* :asset_packager_compatibility, 'config/asset_packages.yml' @ 1370554951 */
/* public/javascripts/jquery-ui-1.9.1.js @ 1370554951 */
/*! jQuery UI - v1.9.1 - 2012-11-14
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.effect.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js
* Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */
(function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.9.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=n.offsetHeight===100,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),function(){var t=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=t.length?!0:!1,e.ui.ie6=parseFloat(t[1],10)===6}(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})})(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a=t.split(".")[0];t=t.split(".")[1],i=a+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[a]=e[a]||{},s=e[a][t],o=e[a][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,i){e.isFunction(i)&&(r[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=r,s=i.apply(this,arguments),this._super=t,this._superApply=n,s}}())}),o.prototype=e.widget.extend(u,{widgetEventPrefix:u.widgetEventPrefix||t},r,{constructor:o,namespace:a,widgetName:t,widgetBaseClass:i,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():new i(o,this)}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetName,this),e.data(r,this.widgetFullName,this),this._on(this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n){var r,i=this;n?(t=r=e(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element,r=this.widget()),e.each(n,function(n,s){function o(){if(i.options.disabled===!0||e(this).hasClass("ui-state-disabled"))return;return(typeof s=="string"?i[s]:s).apply(i,arguments)}typeof s!="string"&&(o.guid=s.guid=s.guid||o.guid||e.guid++);var u=n.match(/^(\w+)\s*(.*)$/),a=u[1]+i.eventNamespace,f=u[2];f?r.delegate(f,a,o):t.bind(a,o)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&(e.effects.effect[u]||e.uiBackCompat!==!1&&e.effects[u])?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(e){n=!1}),e.widget("ui.mouse",{version:"1.9.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return!e.ui.ie||document.documentMode>=9||!!t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})}(jQuery),function(e,t){function h(e,t,n){return[parseInt(e[0],10)*(l.test(e[0])?t/100:1),parseInt(e[1],10)*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:i?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,d,v,m,g=e(t.of),y=e.position.getWithinInfo(t.within),b=e.position.getScrollInfo(y),w=g[0],E=(t.collision||"flip").split(" "),S={};return w.nodeType===9?(l=g.width(),d=g.height(),v={top:0,left:0}):e.isWindow(w)?(l=g.width(),d=g.height(),v={top:g.scrollTop(),left:g.scrollLeft()}):w.preventDefault?(t.at="left top",l=d=0,v={top:w.pageY,left:w.pageX}):(l=g.outerWidth(),d=g.outerHeight(),v=g.offset()),m=e.extend({},v),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),S[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),E.length===1&&(E[1]=E[0]),t.at[0]==="right"?m.left+=l:t.at[0]==="center"&&(m.left+=l/2),t.at[1]==="bottom"?m.top+=d:t.at[1]==="center"&&(m.top+=d/2),n=h(S.at,l,d),m.left+=n[0],m.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),w=p(this,"marginLeft"),x=p(this,"marginTop"),T=f+w+p(this,"marginRight")+b.width,N=c+x+p(this,"marginBottom")+b.height,C=e.extend({},m),k=h(S.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?C.left-=f:t.my[0]==="center"&&(C.left-=f/2),t.my[1]==="bottom"?C.top-=c:t.my[1]==="center"&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:w,marginTop:x},e.each(["left","top"],function(r,i){e.ui.position[E[r]]&&e.ui.position[E[r]][i](C,{targetWidth:l,targetHeight:d,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:y,elem:a})}),e.fn.bgiframe&&a.bgiframe(),t.using&&(u=function(e){var n=v.left-C.left,s=n+l-f,o=v.top-C.top,u=o+d-c,h={target:{element:g,left:v.left,top:v.top,width:l,height:d},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};l<f&&i(n+s)<l&&(h.horizontal="center"),d<c&&i(o+u)<d&&(h.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?h.important="horizontal":h.important="vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}(),e.uiBackCompat!==!1&&function(e){var n=e.fn.position;e.fn.position=function(r){if(!r||!r.offset)return n.call(this,r);var i=r.offset.split(" "),s=r.at.split(" ");return i.length===1&&(i[1]=i[0]),/^\d/.test(i[0])&&(i[0]="+"+i[0]),/^\d/.test(i[1])&&(i[1]="+"+i[1]),s.length===1&&(/left|center|right/.test(s[0])?s[1]="center":(s[1]=s[0],s[0]="center")),n.call(this,e.extend(r,{at:s[0]+i[0]+" "+s[1]+i[1],offset:t}))}}(jQuery)}(jQuery),jQuery.effects||function(e,t){var n=e.uiBackCompat!==!1,r="ui-effects-";e.effects={effect:{}},function(t,n){function p(e,t,n){var r=a[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function d(e){var n=o(),r=n._rgba=[];return e=e.toLowerCase(),h(s,function(t,i){var s,o=i.re.exec(e),a=o&&i.parse(o),f=i.space||"rgba";if(a)return s=n[f](a),n[u[f].cache]=s[u[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&t.extend(r,c.transparent),n):c[e]}function v(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),i=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],o=t.Color=function(e,n,r,i){return new t.Color.fn.parse(e,n,r,i)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},a={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=o.support={},l=t("<p>")[0],c,h=t.each;l.style.cssText="background-color:rgba(1,1,1,.5)",f.rgba=l.style.backgroundColor.indexOf("rgba")>-1,h(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),o.fn=t.extend(o.prototype,{parse:function(r,i,s,a){if(r===n)return this._rgba=[null,null,null,null],this;if(r.jquery||r.nodeType)r=t(r).css(i),i=n;var f=this,l=t.type(r),v=this._rgba=[];i!==n&&(r=[r,i,s,a],l="array");if(l==="string")return this.parse(d(r)||c._default);if(l==="array")return h(u.rgba.props,function(e,t){v[t.idx]=p(r[t.idx],t)}),this;if(l==="object")return r instanceof o?h(u,function(e,t){r[t.cache]&&(f[t.cache]=r[t.cache].slice())}):h(u,function(t,n){var i=n.cache;h(n.props,function(e,t){if(!f[i]&&n.to){if(e==="alpha"||r[e]==null)return;f[i]=n.to(f._rgba)}f[i][t.idx]=p(r[e],t,!0)}),f[i]&&e.inArray(null,f[i].slice(0,3))<0&&(f[i][3]=1,n.from&&(f._rgba=n.from(f[i])))}),this},is:function(e){var t=o(e),n=!0,r=this;return h(u,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],h(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return h(u,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=o(e),r=n._space(),i=u[r],s=this.alpha()===0?o("transparent"):this,f=s[i.cache]||i.to(s._rgba),l=f.slice();return n=n[i.cache],h(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],u=a[r.type]||{};if(o===null)return;s===null?l[i]=o:(u.mod&&(o-s>u.mod/2?s+=u.mod:s-o>u.mod/2&&(s-=u.mod)),l[i]=p((o-s)*t+s,r))}),this[r](l)},blend:function(e){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=o(e)._rgba;return o(t.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),r=n.pop();return e&&n.push(~~(r*255)),"#"+t.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),o.fn.parse.prototype=o.fn,u.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,f===0||f===1?c=f:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},u.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(v(o,s,t+1/3)*255),Math.round(v(o,s,t)*255),Math.round(v(o,s,t-1/3)*255),i]},h(u,function(e,r){var s=r.props,u=r.cache,a=r.to,f=r.from;o.fn[e]=function(e){a&&!this[u]&&(this[u]=a(this._rgba));if(e===n)return this[u].slice();var r,i=t.type(e),l=i==="array"||i==="object"?e:arguments,c=this[u].slice();return h(s,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=c[t.idx]),c[t.idx]=p(n,t)}),f?(r=o(f(c)),r[u]=c,r):o(c)},h(s,function(n,r){if(o.fn[n])return;o.fn[n]=function(s){var o=t.type(s),u=n==="alpha"?this._hsla?"hsla":"rgba":e,a=this[u](),f=a[r.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=t.type(s)),s==null&&r.empty?this:(o==="string"&&(l=i.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[r.idx]=s,this[u](a)))}})}),h(r,function(e,n){t.cssHooks[n]={set:function(e,r){var i,s,u="";if(t.type(r)!=="string"||(i=d(r))){r=o(i||r);if(!f.rgba&&r._rgba[3]!==1){s=n==="backgroundColor"?e.parentNode:e;while((u===""||u==="transparent")&&s&&s.style)try{u=t.css(s,"backgroundColor"),s=s.parentNode}catch(a){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{e.style[n]=r}catch(l){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=o(e.elem,n),e.end=o(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}}),t.cssHooks.borderColor={expand:function(e){var t={};return h(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},c=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(){var t=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,n={},r,i;if(t&&t.length&&t[0]&&t[t[0]]){i=t.length;while(i--)r=t[i],typeof t[r]=="string"&&(n[e.camelCase(r)]=t[r])}else for(r in t)typeof t[r]=="string"&&(n[r]=t[r]);return n}function s(t,n){var i={},s,o;for(s in n)o=n[s],t[s]!==o&&!r[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr)jQuery.style(e.elem,n,e.end),e.setAttr=!0}}),e.effects.animateClass=function(t,r,o,u){var a=e.speed(r,o,u);return this.queue(function(){var r=e(this),o=r.attr("class")||"",u,f=a.children?r.find("*").andSelf():r;f=f.map(function(){var t=e(this);return{el:t,start:i.call(this)}}),u=function(){e.each(n,function(e,n){t[n]&&r[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=i.call(this.el[0]),this.diff=s(this.start,this.end),this}),r.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=jQuery.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(r[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{add:t},n,r,i):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{remove:t},n,r,i):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):this._toggleClass(n,r):e.effects.animateClass.call(this,{toggle:n},r,i,s)},switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function i(t,n,r,i){e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},n==null&&(n={}),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function s(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]?n&&e.effects[t]?!1:!0:!1}e.extend(e.effects,{version:"1.9.1",save:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.data(r+t[n],e[0].style[t[n]])},restore:function(e,n){var i,s;for(s=0;s<n.length;s++)n[s]!==null&&(i=e.data(r+n[s]),i===t&&(i=""),e.css(n[s],i))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function a(n){function u(){e.isFunction(i)&&i.call(r[0]),e.isFunction(n)&&n()}var r=e(this),i=t.complete,s=t.mode;(r.is(":hidden")?s==="hide":s==="show")?u():o.call(r[0],t,u)}var t=i.apply(this,arguments),r=t.mode,s=t.queue,o=e.effects.effect[t.effect],u=!o&&n&&e.effects[t.effect];return e.fx.off||!o&&!u?r?this[r](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):o?s===!1?this.each(a):this.queue(s||"fx",a):u.call(this,{options:t,duration:t.duration,callback:t.complete,mode:t.mode})},_show:e.fn.show,show:function(e){if(s(e))return this._show.apply(this,arguments);var t=i.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(s(e))return this._hide.apply(this,arguments);var t=i.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(s(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t
])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}()}(jQuery),function(e,t){var n=/up|down|vertical/,r=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,i){var s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a=t.direction||"up",f=n.test(a),l=f?"height":"width",c=f?"top":"left",h=r.test(a),p={},d=u==="show",v,m,g;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o),s.show(),v=e.effects.createWrapper(s).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(s.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){u==="hide"&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),i()}})}}(jQuery),function(e,t){e.effects.effect.bounce=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=s==="hide",u=s==="show",a=t.direction||"up",f=t.distance,l=t.times||5,c=l*2+(u||o?1:0),h=t.duration/c,p=t.easing,d=a==="up"||a==="down"?"top":"left",v=a==="up"||a==="left",m,g,y,b=r.queue(),w=b.length;(u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r[d==="top"?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?-f*2:f*2).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0;for(m=0;m<l;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?f*2:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.clip=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"vertical",a=u==="vertical",f=a?"height":"width",l=a?"top":"left",c={},h,p,d;e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p=r[0].tagName==="IMG"?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.drop=function(t,n){var r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left"?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,f==="pos"?-c:c),l[a]=(o?f==="pos"?"+=":"-=":f==="pos"?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.explode=function(t,n){function y(){c.push(this),c.length===r*i&&b()}function b(){s.css({visibility:"visible"}),e(c).remove(),u||s.hide(),n()}var r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,i=r,s=e(this),o=e.effects.setMode(s,t.mode||"hide"),u=o==="show",a=s.show().css("visibility","hidden").offset(),f=Math.ceil(s.outerWidth()/i),l=Math.ceil(s.outerHeight()/r),c=[],h,p,d,v,m,g;for(h=0;h<r;h++){v=a.top+h*l,g=h-(r-1)/2;for(p=0;p<i;p++)d=a.left+p*f,m=p-(i-1)/2,s.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*f,top:-h*l}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:l,left:d+(u?m*f:0),top:v+(u?g*l:0),opacity:u?0:1}).animate({left:d+(u?0:m*f),top:v+(u?0:g*l),opacity:u?1:0},t.duration||500,t.easing,y)}}}(jQuery),function(e,t){e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e,t){e.effects.effect.fold=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=s==="hide",a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})}}(jQuery),function(e,t){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};s==="hide"&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e,t){e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s=i==="show",o=i==="hide",u=s||i==="hide",a=(t.times||5)*2+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length,p;if(s||!r.is(":visible"))r.css("opacity",0).show(),l=1;for(p=1;p<a;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s=i==="hide",o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u}}),r.effect(t)},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:s==="hide"?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:u!=="horizontal"?o/100:1,x:u!=="vertical"?o/100:1};i.effect="size",i.queue=!1,i.complete=n,s!=="effect"&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||(s==="show"?{height:0,width:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&(s==="show"&&(i.from.opacity=0,i.to.opacity=1),s==="hide"&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||p!=="effect",v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0};p==="show"&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},t.mode==="toggle"&&p==="show"?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||(p==="show"?b:r),o.to=t.to||(p==="hide"?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}};if(v==="box"||v==="both")s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to));(v==="content"||v==="both")&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from);if(v==="content"||v==="both")c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})});o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o.to.opacity===0&&o.css("opacity",o.from.opacity),p==="hide"&&o.hide(),e.effects.restore(o,y),d||(g==="static"?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return n==="auto"?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e,t){e.effects.effect.shake=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=a*2+1,l=Math.round(t.duration/f),c=o==="up"||o==="down"?"top":"left",h=o==="up"||o==="left",p={},d={},v={},m,g=r.queue(),y=g.length;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+u*2,v[c]=(h?"-=":"+=")+u*2,r.animate(p,l,t.easing);for(m=1;m<a;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.slide=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};e.effects.save(r,i),r.show(),l=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s=i.css("position")==="fixed",o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery);


/* public/javascripts/jquery.scrollto.js @ 1370554951 */
/*!
 * jQuery.ScrollTo
 * Copyright (c) 2007-2012 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 4/09/2012
 *
 * @projectDescription Easy element scrolling using jQuery.
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @author Ariel Flesler
 * @version 1.4.3.1
 *
 * @id jQuery.scrollTo
 * @id jQuery.fn.scrollTo
 * @param {String, Number, DOMElement, jQuery, Object} target Where to scroll the matched elements.
 *	  The different options for target are:
 *		- A number position (will be applied to all axes).
 *		- A string position ('44', '100px', '+=90', etc ) will be applied to all axes
 *		- A jQuery/DOM element ( logically, child of the element to scroll )
 *		- A string selector, that will be relative to the element to scroll ( 'li:eq(2)', etc )
 *		- A hash { top:x, left:y }, x and y can be any kind of number/string like above.
 *		- A percentage of the container's dimension/s, for example: 50% to go to the middle.
 *		- The string 'max' for go-to-end. 
 * @param {Number, Function} duration The OVERALL length of the animation, this argument can be the settings object instead.
 * @param {Object,Function} settings Optional set of settings or the onAfter callback.
 *	 @option {String} axis Which axis must be scrolled, use 'x', 'y', 'xy' or 'yx'.
 *	 @option {Number, Function} duration The OVERALL length of the animation.
 *	 @option {String} easing The easing method for the animation.
 *	 @option {Boolean} margin If true, the margin of the target element will be deducted from the final position.
 *	 @option {Object, Number} offset Add/deduct from the end position. One number for both axes or { top:x, left:y }.
 *	 @option {Object, Number} over Add/deduct the height/width multiplied by 'over', can be { top:x, left:y } when using both axes.
 *	 @option {Boolean} queue If true, and both axis are given, the 2nd axis will only be animated after the first one ends.
 *	 @option {Function} onAfter Function to be called after the scrolling ends. 
 *	 @option {Function} onAfterFirst If queuing is activated, this function will be called after the first scrolling ends.
 * @return {jQuery} Returns the same jQuery object, for chaining.
 *
 * @desc Scroll to a fixed position
 * @example $('div').scrollTo( 340 );
 *
 * @desc Scroll relatively to the actual position
 * @example $('div').scrollTo( '+=340px', { axis:'y' } );
 *
 * @desc Scroll using a selector (relative to the scrolled element)
 * @example $('div').scrollTo( 'p.paragraph:eq(2)', 500, { easing:'swing', queue:true, axis:'xy' } );
 *
 * @desc Scroll to a DOM element (same for jQuery object)
 * @example var second_child = document.getElementById('container').firstChild.nextSibling;
 *			$('#container').scrollTo( second_child, { duration:500, axis:'x', onAfter:function(){
 *				alert('scrolled!!');																   
 *			}});
 *
 * @desc Scroll on both axes, to different values
 * @example $('div').scrollTo( { top: 300, left:'+=200' }, { axis:'xy', offset:-20 } );
 */
(function(e){function n(e){return typeof e=="object"?e:{top:e,left:e}}var t=e.scrollTo=function(t,n,r){e(window).scrollTo(t,n,r)};t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})},e.fn.scrollTo=function(r,i,s){return typeof i=="object"&&(s=i,i=0),typeof s=="function"&&(s={onAfter:s}),r=="max"&&(r=9e9),s=e.extend({},t.defaults,s),i=i||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(i/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function h(e){u.animate(l,i,s.easing,e&&function(){e.call(this,r,s)})}if(r==null)return;var o=this,u=e(o),a=r,f,l={},c=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)f=(a=e(a)).offset()}e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),p="scroll"+r,d=o[p],v=t.max(o,n);if(f)l[p]=f[i]+(c?0:d-u.offset()[i]),s.margin&&(l[p]-=parseInt(a.css("margin"+r))||0,l[p]-=parseInt(a.css("border"+r+"Width"))||0),l[p]+=s.offset[i]||0,s.over[i]&&(l[p]+=a[n=="x"?"width":"height"]()*s.over[i]);else{var m=a[i];l[p]=m.slice&&m.slice(-1)=="%"?parseFloat(m)/100*v:m}s.limit&&/^\d+$/.test(l[p])&&(l[p]=l[p]<=0?0:Math.min(l[p],v)),!e&&s.queue&&(d!=l[p]&&h(s.onAfterFirst),delete l[p])}),h(s.onAfter)}).end()},t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])}})(jQuery);


/* public/javascripts/jquery.bbq.js @ 1370554951 */
/*!
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
// Script: jQuery BBQ: Back Button & Query Library
//
// *Version: 1.2.1, Last updated: 2/17/2010*
//
// Project Home - http://benalman.com/projects/jquery-bbq-plugin/
// GitHub       - http://github.com/cowboy/jquery-bbq/
// Source       - http://github.com/cowboy/jquery-bbq/raw/master/jquery.ba-bbq.js
// (Minified)   - http://github.com/cowboy/jquery-bbq/raw/master/jquery.ba-bbq.min.js (4.0kb)
//
// About: License
//
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
//
// About: Examples
//
// These working examples, complete with fully commented code, illustrate a few
// ways in which this plugin can be used.
//
// Basic AJAX     - http://benalman.com/code/projects/jquery-bbq/examples/fragment-basic/
// Advanced AJAX  - http://benalman.com/code/projects/jquery-bbq/examples/fragment-advanced/
// jQuery UI Tabs - http://benalman.com/code/projects/jquery-bbq/examples/fragment-jquery-ui-tabs/
// Deparam        - http://benalman.com/code/projects/jquery-bbq/examples/deparam/
//
// About: Support and Testing
//
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
//
// jQuery Versions - 1.3.2, 1.4.1, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.7, Safari 3-4,
//                   Chrome 4-5, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-bbq/unit/
//
// About: Release History
//
// 1.2.1 - (2/17/2010) Actually fixed the stale window.location Safari bug from
//         <jQuery hashchange event> in BBQ, which was the main reason for the
//         previous release!
// 1.2   - (2/16/2010) Integrated <jQuery hashchange event> v1.2, which fixes a
//         Safari bug, the event can now be bound before DOM ready, and IE6/7
//         page should no longer scroll when the event is first bound. Also
//         added the <jQuery.param.fragment.noEscape> method, and reworked the
//         <hashchange event (BBQ)> internal "add" method to be compatible with
//         changes made to the jQuery 1.4.2 special events API.
// 1.1.1 - (1/22/2010) Integrated <jQuery hashchange event> v1.1, which fixes an
//         obscure IE8 EmulateIE7 meta tag compatibility mode bug.
// 1.1   - (1/9/2010) Broke out the jQuery BBQ event.special <hashchange event>
//         functionality into a separate plugin for users who want just the
//         basic event & back button support, without all the extra awesomeness
//         that BBQ provides. This plugin will be included as part of jQuery BBQ,
//         but also be available separately. See <jQuery hashchange event>
//         plugin for more information. Also added the <jQuery.bbq.removeState>
//         method and added additional <jQuery.deparam> examples.
// 1.0.3 - (12/2/2009) Fixed an issue in IE 6 where location.search and
//         location.hash would report incorrectly if the hash contained the ?
//         character. Also <jQuery.param.querystring> and <jQuery.param.fragment>
//         will no longer parse params out of a URL that doesn't contain ? or #,
//         respectively.
// 1.0.2 - (10/10/2009) Fixed an issue in IE 6/7 where the hidden IFRAME caused
//         a "This page contains both secure and nonsecure items." warning when
//         used on an https:// page.
// 1.0.1 - (10/7/2009) Fixed an issue in IE 8. Since both "IE7" and "IE8
//         Compatibility View" modes erroneously report that the browser
//         supports the native window.onhashchange event, a slightly more
//         robust test needed to be added.
// 1.0   - (10/2/2009) Initial release
(function(e,t){"$:nomunge";function N(e){return typeof e=="string"}function C(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}}function k(e){return e.replace(/^[^#]*#?(.*)$/,"$1")}function L(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function A(r,o,a,f,l){var c,h,p,d,g;return f!==n?(p=a.match(r?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),g=p[3]||"",l===2&&N(f)?h=f.replace(r?S:E,""):(d=u(p[2]),f=N(f)?u[r?m:v](f):f,h=l===2?f:l===1?e.extend({},f,d):e.extend({},d,f),h=s(h),r&&(h=h.replace(x,i))),c=p[1]+(r?"#":h||!p[1]?"?":"")+h+g):c=o(a!==n?a:t[y][b]),c}function O(e,t,r){return t===n||typeof t=="boolean"?(r=t,t=s[e?m:v]()):t=N(t)?t.replace(e?S:E,""):t,u(t,r)}function M(t,r,i,o){return!N(i)&&typeof i!="object"&&(o=i,i=r,r=n),this.each(function(){var n=e(this),u=r||h()[(this.nodeName||"").toLowerCase()]||"",a=u&&n.attr(u)||"";n.attr(u,s[t](a,i,o))})}var n,r=Array.prototype.slice,i=decodeURIComponent,s=e.param,o,u,a,f=e.bbq=e.bbq||{},l,c,h,p=e.event.special,d="hashchange",v="querystring",m="fragment",g="elemUrlAttr",y="location",b="href",w="src",E=/^.*\?|#.*$/g,S=/^.*\#/,x,T={};s[v]=C(A,0,L),s[m]=o=C(A,1,k),o.noEscape=function(t){t=t||"";var n=e.map(t.split(""),encodeURIComponent);x=new RegExp(n.join("|"),"g")},o.noEscape(",/"),e.deparam=u=function(t,r){var s={},o={"true":!0,"false":!1,"null":null};return e.each(t.replace(/\+/g," ").split("&"),function(t,u){var a=u.split("="),f=i(a[0]),l,c=s,h=0,p=f.split("]["),d=p.length-1;/\[/.test(p[0])&&/\]$/.test(p[d])?(p[d]=p[d].replace(/\]$/,""),p=p.shift().split("[").concat(p),d=p.length-1):d=0;if(a.length===2){l=i(a[1]),r&&(l=l&&!isNaN(l)?+l:l==="undefined"?n:o[l]!==n?o[l]:l);if(d)for(;h<=d;h++)f=p[h]===""?c.length:p[h],c=c[f]=h<d?c[f]||(p[h+1]&&isNaN(p[h+1])?{}:[]):l;else e.isArray(s[f])?s[f].push(l):s[f]!==n?s[f]=[s[f],l]:s[f]=l}else f&&(s[f]=r?n:"")}),s},u[v]=C(O,0),u[m]=a=C(O,1),e[g]||(e[g]=function(t){return e.extend(T,t)})({a:b,base:b,iframe:w,img:w,input:w,form:"action",link:b,script:w}),h=e[g],e.fn[v]=C(M,v),e.fn[m]=C(M,m),f.pushState=l=function(e,r){N(e)&&/^#/.test(e)&&r===n&&(r=2);var i=e!==n,s=o(t[y][b],i?e:{},i?r:2);t[y][b]=s+(/#/.test(s)?"":"#")},f.getState=c=function(e,t){return e===n||typeof e=="boolean"?a(e):a(t)[e]},f.removeState=function(t){var r={};t!==n&&(r=c(),e.each(e.isArray(t)?t:arguments,function(e,t){delete r[t]})),l(r,2)},p[d]=e.extend(p[d],{add:function(t){function i(e){var t=e[m]=o();e.getState=function(e,r){return e===n||typeof e=="boolean"?u(t,e):u(t,r)[e]},r.apply(this,arguments)}var r;if(e.isFunction(t))return r=t,i;r=t.handler,t.handler=i}})})(jQuery,this),function(e,t,n){"$:nomunge";function h(e){return e=e||t[s][u],e.replace(/^[^#]*#?(.*)$/,"$1")}var r,i=e.event.special,s="location",o="hashchange",u="href",a=e.browser,f=document.documentMode,l=a.msie&&(f===n||f<8),c="on"+o in t&&!l;e[o+"Delay"]=100,i[o]=e.extend(i[o],{setup:function(){if(c)return!1;e(r.start)},teardown:function(){if(c)return!1;e(r.stop)}}),r=function(){function c(){a=f=function(e){return e},l&&(i=e('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,f=function(){return h(i.document[s][u])},a=function(e,t){if(e!==t){var n=i.document;n.open().close(),n[s].hash="#"+e}},a(h()))}var n={},r,i,a,f;return n.start=function(){if(r)return;var n=h();a||c(),function i(){var l=h(),c=f(n);l!==n?(a(n=l,c),e(t).trigger(o)):c!==n&&(t[s][u]=t[s][u].replace(/#.*/,"")+"#"+c),r=setTimeout(i,e[o+"Delay"])}()},n.stop=function(){i||(r&&clearTimeout(r),r=0)},n}()}(jQuery,this);


/* public/javascripts/jquery.transify.js @ 1370554951 */
// Transify v1.0
// COPYRIGHT JOREN RAPINI 2010
// jorenrapini@gmail.com
(function(e){e.fn.untransify=function(t){return this.each(function(){var t=e(this);t.data("transify_prev")&&(oldCSS={zIndex:t.data("transify_prev").zIndex,background:t.data("transify_prev").background,border:t.data("transify_prev").border},t.css(oldCSS),t.children(".transify").remove())}),this}})(jQuery),function(e){e.fn.transify=function(t){var n={opacityOrig:.5,fadeSpeed:600},r=e.extend({},n,t);return this.each(function(){var t=e(this);t.append('<div class="transify"></div>');var n=t.find(".transify");n.css({backgroundColor:t.css("backgroundColor"),backgroundImage:t.css("backgroundImage"),backgroundRepeat:t.css("backgroundRepeat"),borderTopColor:t.css("borderTopColor"),borderTopWidth:t.css("borderTopWidth"),borderTopStyle:t.css("borderTopStyle"),borderRightColor:t.css("borderRightColor"),borderRightWidth:t.css("borderRightWidth"),borderRightStyle:t.css("borderRightStyle"),borderBottomColor:t.css("borderBottomColor"),borderBottomWidth:t.css("borderBottomWidth"),borderBottomStyle:t.css("borderBottomStyle"),borderLeftColor:t.css("borderLeftColor"),borderLeftWidth:t.css("borderLeftWidth"),borderLeftStyle:t.css("borderLeftStyle"),position:"absolute",top:0,left:0,zIndex:-1,width:t.width()+parseInt(t.css("padding-left"),10)+parseInt(t.css("padding-right"),10),height:t.height()+parseInt(t.css("padding-top"),10)+parseInt(t.css("padding-bottom"),10),opacity:r.opacityOrig}),r.percentWidth&&n.css("width",r.percentWidth),t.data("transify_prev",{zIndex:t.css("zIndex"),background:t.css("background"),border:t.css("border")}),t.css({zIndex:4,background:"none",border:"none"}),r.opacityNew&&t.hover(function(){n.stop().animate({opacity:r.opacityNew},r.fadeSpeed)},function(){n.stop().animate({opacity:r.opacityOrig},r.fadeSpeed)})}),this}}(jQuery);


/* public/javascripts/jquery.nearest.js @ 1370554951 */
/*!
 * jQuery Nearest plugin v1.2.0
 *
 * Finds elements closest to a single point based on screen location and pixel dimensions
 * http://gilmoreorless.github.com/jquery-nearest/
 * Open source under the MIT licence: http://gilmoreorless.mit-license.org/2011/
 *
 * Requires jQuery 1.4 or above
 * Also supports Ben Alman's "each2" plugin for faster looping (if available)
 */
/**
 * Method signatures:
 *
 * $.nearest({x, y}, selector) - find $(selector) closest to point
 * $(elem).nearest(selector) - find $(selector) closest to elem
 * $(elemSet).nearest({x, y}) - filter $(elemSet) and return closest to point
 *
 * Also:
 * $.furthest()
 * $(elem).furthest()
 *
 * $.touching()
 * $(elem).touching()
 */
(function(e,t){function r(t,r,i){t||(t="div");var s=e(r.container),o=s.offset()||{left:0,top:0},u=[o.left+s.width(),o.top+s.height()],a={x:0,y:1,w:0,h:1},f,l;for(f in a)a.hasOwnProperty(f)&&(l=n.exec(r[f]),l&&(r[f]=u[a[f]]*l[1]/100));var c=e(t),h=[],p=!!r.furthest,d=!!r.checkHoriz,v=!!r.checkVert,m=p?0:Infinity,g=parseFloat(r.x)||0,y=parseFloat(r.y)||0,b=parseFloat(g+r.w)||g,w=parseFloat(y+r.h)||y,E=r.tolerance||0,S=!!e.fn.each2,x=Math.min,T=Math.max;!r.includeSelf&&i&&(c=c.not(i)),E<0&&(E=0),c[S?"each2":"each"](function(t,n){var r=S?n:e(this),i=r.offset(),s=i.left,o=i.top,u=r.outerWidth(),a=r.outerHeight(),f=s+u,l=o+a,c=T(s,g),N=x(f,b),C=T(o,y),k=x(l,w),L=N>=c,A=k>=C,O,M,_,D;if(d&&v||!d&&!v&&L&&A||d&&A||v&&L)O=L?0:c-N,M=A?0:C-k,_=L||A?T(O,M):Math.sqrt(O*O+M*M),D=p?_>=m-E:_<=m+E,D&&(m=p?T(m,_):x(m,_),h.push({node:this,dist:_}))});var N=h.length,C=[],k,L,A,O;if(N){p?(k=m-E,L=m):(k=m,L=m+E);for(A=0;A<N;A++)O=h[A],O.dist>=k&&O.dist<=L&&C.push(O.node)}return C}var n=/^([\d.]+)%$/;e.each(["nearest","furthest","touching"],function(n,i){var s={x:0,y:0,w:0,h:0,tolerance:1,container:document,furthest:i=="furthest",includeSelf:!1,checkHoriz:i!="touching",checkVert:i!="touching"};e[i]=function(n,i,o){if(!n||n.x===t||n.y===t)return e([]);var u=e.extend({},s,n,o||{});return e(r(i,u))},e.fn[i]=function(t,n){var i;if(t&&e.isPlainObject(t))return i=e.extend({},s,t,n||{}),this.pushStack(r(this,i));var o=this.offset(),u={x:o.left,y:o.top,w:this.outerWidth(),h:this.outerHeight()};return i=e.extend({},s,u,n||{}),this.pushStack(r(t,i,this))}})})(jQuery);


/* public/javascripts/jquery.form.js @ 1370554951 */
/*!
 * jQuery Form Plugin
 * version: 3.18 (28-SEP-2012)
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
/*global ActiveXObject alert */
(function(e){"use strict";function n(t){var n=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(n))}function r(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length===0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!==undefined)s.clk_x=t.offsetX,s.clk_y=t.offsetY;else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left,s.clk_y=t.pageY-o.top}else s.clk_x=t.pageX-n.offsetLeft,s.clk_y=t.pageY-n.offsetTop;setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)}function i(){if(!e.fn.ajaxSubmit.debug)return;var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}var t={};t.fileapi=e("<input type='file'/>").get(0).files!==undefined,t.formdata=window.FormData!==undefined,e.fn.ajaxSubmit=function(n){function T(t){var n=e.param(t).split("&"),r=n.length,i={},s,o;for(s=0;s<r;s++)o=n[s].split("="),i[decodeURIComponent(o[0])]=decodeURIComponent(o[1]);return i}function N(t){var i=new FormData;for(var s=0;s<t.length;s++)i.append(t[s].name,t[s].value);if(n.extraData){var o=T(n.extraData);for(var u in o)o.hasOwnProperty(u)&&i.append(u,o[u])}n.data=null;var a=e.extend(!0,{},e.ajaxSettings,n,{contentType:!1,processData:!1,cache:!1,type:r||"POST"});n.uploadProgress&&(a.xhr=function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&(e.upload.onprogress=function(e){var t=0,r=e.loaded||e.position,i=e.total;e.lengthComputable&&(t=Math.ceil(r/i*100)),n.uploadProgress(e,r,i,t)}),e}),a.data=null;var f=a.beforeSend;return a.beforeSend=function(e,t){t.data=i,f&&f.call(this,e,t)},e.ajax(a)}function C(t){function T(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function k(){function o(){try{var e=T(d).readyState;i("state = "+e),e&&e.toLowerCase()=="uninitialized"&&setTimeout(o,50)}catch(t){i("Server abort: ",t," (",t.name,")"),_(x),b&&clearTimeout(b),b=undefined}}var t=u.attr("target"),n=u.attr("action");s.setAttribute("target",h),r||s.setAttribute("method","POST"),n!=f.url&&s.setAttribute("action",f.url),!f.skipEncodingOverride&&(!r||/post/i.test(r))&&u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(b=setTimeout(function(){y=!0,_(S)},f.timeout));var a=[];try{if(f.extraData)for(var l in f.extraData)f.extraData.hasOwnProperty(l)&&(e.isPlainObject(f.extraData[l])&&f.extraData[l].hasOwnProperty("name")&&f.extraData[l].hasOwnProperty("value")?a.push(e('<input type="hidden" name="'+f.extraData[l].name+'">').attr("value",f.extraData[l].value).appendTo(s)[0]):a.push(e('<input type="hidden" name="'+l+'">').attr("value",f.extraData[l]).appendTo(s)[0]));f.iframeTarget||(p.appendTo("body"),d.attachEvent?d.attachEvent("onload",_):d.addEventListener("load",_,!1)),setTimeout(o,15),s.submit()}finally{s.setAttribute("action",n),t?s.setAttribute("target",t):u.removeAttr("target"),e(a).remove()}}function _(t){if(v.aborted||M)return;try{A=T(d)}catch(n){i("cannot access response document: ",n),t=x}if(t===S&&v){v.abort("timeout"),E.reject(v,"timeout");return}if(t==x&&v){v.abort("server abort"),E.reject(v,"error","server abort");return}if(!A||A.location.href==f.iframeSrc)if(!y)return;d.detachEvent?d.detachEvent("onload",_):d.removeEventListener("load",_,!1);var r="success",s;try{if(y)throw"timeout";var o=f.dataType=="xml"||A.XMLDocument||e.isXMLDoc(A);i("isXml="+o);if(!o&&window.opera&&(A.body===null||!A.body.innerHTML)&&--O){i("requeing onLoad callback, DOM not available"),setTimeout(_,250);return}var u=A.body?A.body:A.documentElement;v.responseText=u?u.innerHTML:null,v.responseXML=A.XMLDocument?A.XMLDocument:A,o&&(f.dataType="xml"),v.getResponseHeader=function(e){var t={"content-type":f.dataType};return t[e]},u&&(v.status=Number(u.getAttribute("status"))||v.status,v.statusText=u.getAttribute("statusText")||v.statusText);var a=(f.dataType||"").toLowerCase(),l=/(json|script|text)/.test(a);if(l||f.textarea){var h=A.getElementsByTagName("textarea")[0];if(h)v.responseText=h.value,v.status=Number(h.getAttribute("status"))||v.status,v.statusText=h.getAttribute("statusText")||v.statusText;else if(l){var m=A.getElementsByTagName("pre")[0],g=A.getElementsByTagName("body")[0];m?v.responseText=m.textContent?m.textContent:m.innerText:g&&(v.responseText=g.textContent?g.textContent:g.innerText)}}else a=="xml"&&!v.responseXML&&v.responseText&&(v.responseXML=D(v.responseText));try{L=H(v,a,f)}catch(t){r="parsererror",v.error=s=t||r}}catch(t){i("error caught: ",t),r="error",v.error=s=t||r}v.aborted&&(i("upload aborted"),r=null),v.status&&(r=v.status>=200&&v.status<300||v.status===304?"success":"error"),r==="success"?(f.success&&f.success.call(f.context,L,"success",v),E.resolve(v.responseText,"success",v),c&&e.event.trigger("ajaxSuccess",[v,f])):r&&(s===undefined&&(s=v.statusText),f.error&&f.error.call(f.context,v,r,s),E.reject(v,"error",s),c&&e.event.trigger("ajaxError",[v,f,s])),c&&e.event.trigger("ajaxComplete",[v,f]),c&&!--e.active&&e.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,v,r),M=!0,f.timeout&&clearTimeout(b),setTimeout(function(){f.iframeTarget||p.remove(),v.responseXML=null},100)}var s=u[0],o,a,f,c,h,p,d,v,m,g,y,b,w=!!e.fn.prop,E=e.Deferred();if(e(":input[name=submit],:input[id=submit]",s).length)return alert('Error: Form elements must not have name or id of "submit".'),E.reject(),E;if(t)for(a=0;a<l.length;a++)o=e(l[a]),w?o.prop("disabled",!1):o.removeAttr("disabled");f=e.extend(!0,{},e.ajaxSettings,n),f.context=f.context||f,h="jqFormIO"+(new Date).getTime(),f.iframeTarget?(p=e(f.iframeTarget),g=p.attr("name"),g?h=g:p.attr("name",h)):(p=e('<iframe name="'+h+'" src="'+f.iframeSrc+'" />'),p.css({position:"absolute",top:"-1000px",left:"-1000px"})),d=p[0],v={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n=t==="timeout"?"timeout":"aborted";i("aborting upload... "+n),this.aborted=1;if(d.contentWindow.document.execCommand)try{d.contentWindow.document.execCommand("Stop")}catch(r){}p.attr("src",f.iframeSrc),v.error=n,f.error&&f.error.call(f.context,v,n,t),c&&e.event.trigger("ajaxError",[v,f,n]),f.complete&&f.complete.call(f.context,v,n)}},c=f.global,c&&0===e.active++&&e.event.trigger("ajaxStart"),c&&e.event.trigger("ajaxSend",[v,f]);if(f.beforeSend&&f.beforeSend.call(f.context,v,f)===!1)return f.global&&e.active--,E.reject(),E;if(v.aborted)return E.reject(),E;m=s.clk,m&&(g=m.name,g&&!m.disabled&&(f.extraData=f.extraData||{},f.extraData[g]=m.value,m.type=="image"&&(f.extraData[g+".x"]=s.clk_x,f.extraData[g+".y"]=s.clk_y)));var S=1,x=2,N=e("meta[name=csrf-token]").attr("content"),C=e("meta[name=csrf-param]").attr("content");C&&N&&(f.extraData=f.extraData||{},f.extraData[C]=N),f.forceSync?k():setTimeout(k,10);var L,A,O=50,M,D=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},P=e.parseJSON||function(e){return window.eval("("+e+")")},H=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;return s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror"),r&&r.dataFilter&&(o=r.dataFilter(o,n)),typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=P(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o)),o};return E}if(!this.length)return i("ajaxSubmit: skipping submit process - no element selected"),this;var r,s,o,u=this;typeof n=="function"&&(n={success:n}),r=this.attr("method"),s=this.attr("action"),o=typeof s=="string"?e.trim(s):"",o=o||window.location.href||"",o&&(o=(o.match(/^([^#]+)/)||[])[1]),n=e.extend(!0,{url:o,success:e.ajaxSettings.success,type:r||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var a={};this.trigger("form-pre-serialize",[this,n,a]);if(a.veto)return i("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1)return i("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var f=n.traditional;f===undefined&&(f=e.ajaxSettings.traditional);var l=[],c,h=this.formToArray(n.semantic,l);n.data&&(n.extraData=n.data,c=e.param(n.data,f));if(n.beforeSubmit&&n.beforeSubmit(h,this,n)===!1)return i("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[h,this,n,a]);if(a.veto)return i("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var p=e.param(h,f);c&&(p=p?p+"&"+c:c),n.type.toUpperCase()=="GET"?(n.url+=(n.url.indexOf("?")>=0?"&":"?")+p,n.data=null):n.data=p;var d=[];n.resetForm&&d.push(function(){u.resetForm()}),n.clearForm&&d.push(function(){u.clearForm(n.includeHidden)});if(!n.dataType&&n.target){var v=n.success||function(){};d.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(v,arguments)})}else n.success&&d.push(n.success);n.success=function(e,t,r){var i=n.context||this;for(var s=0,o=d.length;s<o;s++)d[s].apply(i,[e,t,r||u,u])};var m=e("input:file:enabled[value]",this),g=m.length>0,y="multipart/form-data",b=u.attr("enctype")==y||u.attr("encoding")==y,w=t.fileapi&&t.formdata;i("fileAPI :"+w);var E=(g||b)&&!w,S;n.iframe!==!1&&(n.iframe||E)?n.closeKeepAlive?e.get(n.closeKeepAlive,function(){S=C(h)}):S=C(h):(g||b)&&w?S=N(h):S=e.ajax(n),u.removeData("jqxhr").data("jqxhr",S);for(var x=0;x<l.length;x++)l[x]=null;return this.trigger("form-submit-notify",[this,n]),this},e.fn.ajaxForm=function(t){t=t||{},t.delegation=t.delegation&&e.isFunction(e.fn.on);if(!t.delegation&&this.length===0){var s={s:this.selector,c:this.context};return!e.isReady&&s.s?(i("DOM not ready, queuing ajaxForm"),e(function(){e(s.s,s.c).ajaxForm(t)}),this):(i("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return t.delegation?(e(document).off("submit.form-plugin",this.selector,n).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,t,n).on("click.form-plugin",this.selector,t,r),this):this.ajaxFormUnbind().bind("submit.form-plugin",t,n).bind("click.form-plugin",t,r)},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(n,r){var i=[];if(this.length===0)return i;var s=this[0],o=n?s.getElementsByTagName("*"):s.elements;if(!o)return i;var u,a,f,l,c,h,p;for(u=0,h=o.length;u<h;u++){c=o[u],f=c.name;if(!f)continue;if(n&&s.clk&&c.type=="image"){!c.disabled&&s.clk==c&&(i.push({name:f,value:e(c).val(),type:c.type}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}));continue}l=e.fieldValue(c,!0);if(l&&l.constructor==Array){r&&r.push(c);for(a=0,p=l.length;a<p;a++)i.push({name:f,value:l[a]})}else if(t.fileapi&&c.type=="file"&&!c.disabled){r&&r.push(c);var d=c.files;if(d.length)for(a=0;a<d.length;a++)i.push({name:f,value:d[a],type:c.type});else i.push({name:f,value:"",type:c.type})}else l!==null&&typeof l!="undefined"&&(r&&r.push(c),i.push({name:f,value:l,type:c.type,required:c.required}))}if(!n&&s.clk){var v=e(s.clk),m=v[0];f=m.name,f&&!m.disabled&&m.type=="image"&&(i.push({name:f,value:v.val()}),i.push({name:f+".x",value:s.clk_x},{name:f+".y",value:s.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var n=[];return this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})}),e.param(n)},e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n},e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();n.test(r)||i=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:i=="select"?this.selectedIndex=-1:t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return e===undefined&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1})(jQuery);


/* public/javascripts/shared/ZeroClipboard.js @ 1370554951 */
// Simple Set Clipboard System
// Author: Joseph Huckaby
var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(e){return typeof e=="string"&&(e=document.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){var t=this.className.split(/\s+/),n=-1;for(var r=0;r<t.length;r++)t[r]==e&&(n=r,r=t.length);return n>-1&&(t.splice(n,1),this.className=t.join(" ")),this},e.hasClass=function(e){return!!this.className.match(new RegExp("\\s*"+e+"\\s*"))}),e},setMoviePath:function(e){this.moviePath=e},newClient:function(){return new ZeroClipboard.Client},dispatch:function(e,t,n){var r=this.clients[e];r&&r.receiveEvent(t,n)},register:function(e,t){this.clients[e]=t},getDOMObjectPosition:function(e,t){var n={left:0,top:0,width:e.width?e.width:e.offsetWidth,height:e.height?e.height:e.offsetHeight};while(e&&e!=t)n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent;return n},Client:function(e){this.handlers={},this.id=ZeroClipboard.nextId++,this.movieId="ZeroClipboardMovie_"+this.id,ZeroClipboard.register(this.id,this),e&&this.glue(e)}};ZeroClipboard.Client.prototype={id:0,ready:!1,movie:null,clipText:"",handCursorEnabled:!0,cssEffects:!0,handlers:null,zIndex:99,glue:function(e,t,n){this.domElement=ZeroClipboard.$(e),this.domElement.style.zIndex&&(this.zIndex=parseInt(this.domElement.style.zIndex,10)+1),typeof t=="string"?t=ZeroClipboard.$(t):typeof t=="undefined"&&(t=document.getElementsByTagName("body")[0]);var r=ZeroClipboard.getDOMObjectPosition(this.domElement,t);this.div=document.createElement("div");var i=this.div.style;i.position="absolute",i.left=""+r.left+"px",i.top=""+r.top+"px",i.width=""+r.width+"px",i.height=""+r.height+"px",i.zIndex=this.zIndex;if(typeof n=="object")for(addedStyle in n)i[addedStyle]=n[addedStyle];t.appendChild(this.div),this.div.innerHTML=this.getHTML(r.width,r.height)},getHTML:function(e,t){var n="",r="id="+this.id+"&width="+e+"&height="+t;if(navigator.userAgent.match(/MSIE/)){var i=location.href.match(/^https/i)?"https://":"http://";n+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+i+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+r+'"/><param name="wmode" value="transparent"/></object>'}else n+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+r+'" wmode="transparent" />';return n},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide(),this.div.innerHTML="";var e=document.getElementsByTagName("body")[0];try{e.removeChild(this.div)}catch(t){}this.domElement=null,this.div=null}},reposition:function(e){e&&(this.domElement=ZeroClipboard.$(e),this.domElement||this.hide());if(this.domElement&&this.div){var t=ZeroClipboard.getDOMObjectPosition(this.domElement),n=this.div.style;n.left=""+t.left+"px",n.top=""+t.top+"px"}},setText:function(e){this.clipText=e,this.ready&&this.movie.setText(e)},addEventListener:function(e,t){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},setHandCursor:function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},setCSSEffects:function(e){this.cssEffects=!!e},receiveEvent:function(e,t){e=e.toString().toLowerCase().replace(/^on/,"");switch(e){case"load":this.movie=document.getElementById(this.movieId);if(!this.movie){var n=this;setTimeout(function(){n.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var n=this;setTimeout(function(){n.receiveEvent("load",null)},100),this.ready=!0;return}this.ready=!0,this.movie.setText(this.clipText),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&(this.domElement.addClass("hover"),this.recoverActive&&this.domElement.addClass("active"));break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0),this.domElement.removeClass("hover"));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[e])for(var r=0,i=this.handlers[e].length;r<i;r++){var s=this.handlers[e][r];typeof s=="function"?s(this,t):typeof s=="object"&&s.length==2?s[0][s[1]](this,t):typeof s=="string"&&window[s](this,t)}}};


/* public/javascripts/shared/vendor/lazy_image.js @ 1370554951 */
/*
  lazyload.js: Image lazy loading

  Copyright (c) 2012 Vincent Voyer, Stphane Rios

  Permission is hereby granted, free of charge, to any person obtaining
  a copy of this software and associated documentation files (the
  "Software"), to deal in the Software without restriction, including
  without limitation the rights to use, copy, modify, merge, publish,
  distribute, sublicense, and/or sell copies of the Software, and to
  permit persons to whom the Software is furnished to do so, subject to
  the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
  LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
  OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
  WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/
(function(e,t){function f(e){e.onload=null,g(e,s.push(e)-1)}function l(){a(),setTimeout(a,20)}function c(){o=!0,a(),setTimeout(a,20)}function h(e,t){var n=0;return function(){var r=+(new Date);if(r-n<t)return;n=r,e.apply(this,arguments)}}function p(e,t,n){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)}function d(e,t,n){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)}function m(e,t){if(!e.getAttribute(r))return;e.src=e.getAttribute(r),e.removeAttribute(r),!t&&t!==0&&(t=v.call(s,e)),t>=0&&(s[t]=null)}function g(e,t){var r=e.getBoundingClientRect().top==0&&e.getBoundingClientRect().bottom==0;return!r&&e.getBoundingClientRect().top<i+n?(m(e,t),!0):!1}function y(){i=e.innerHeight||t.documentElement&&t.documentElement.clientHeight||t.body&&t.body.clientHeight||1e4}function b(){var e=s.length,t,n=!0;for(t=0;t<e;t++){var r=s[t];r!==null&&!g(r,t)&&(n=!1)}n&&o}function w(){}var n=200,r="data-src",i,s=[],o,u=h(y,20),a=h(b,20);e.lzld=f,e.force_lzld=m,y(),p(e,"resize",u),p(e,"scroll",a),p(t,"DOMContentLoaded",l),p(e,"load",c);var v=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1}})(this,document);


/* public/javascripts/shared/vendor/easyXDM.js @ 1370554951 */
/*
 * easyXDM 
 * http://easyxdm.net/
 * Copyright(c) 2009, yvind Sean Kinsey, oyvind@kinsey.no.
 * 
 * MIT Licensed - http://easyxdm.net/license/mit.txt
 * 
 */
(function(e,t,n,r,i,s){function p(e,t){var n=typeof e[t];return n=="function"||n=="object"&&!!e[t]||n=="unknown"}function d(e,t){return typeof e[t]=="object"&&!!e[t]}function g(e){return e.match(f)[2]}function y(e){return e.match(f)[1]}function b(e){e=e.replace(c,"$1/");if(!e.match(/^(http||https):\/\//)){var t=e.substring(0,1)==="/"?"":n.pathname;t.substring(t.length-1)!=="/"&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=n.protocol+"//"+n.host+t+e}while(l.test(e))e=e.replace(l,"");return e}function w(e,t){var n="",r=e.indexOf("#");r!==-1&&(n=e.substring(r),e=e.substring(0,r));var i=[];for(var s in t)t.hasOwnProperty(s)&&i.push(s+"="+t[s]);return e+(e.indexOf("?")===-1?"?":"&")+i.join("&")+n}function S(e){return typeof e=="undefined"}function x(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return JSON&&typeof JSON.stringify=="function"&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),typeof String.prototype.evalJSON=="function"&&(t=n.evalJSON(),t.a&&t.a.length===3&&t.a[2]===3&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(x=function(){return e},e):null)}function T(e,t,n){var r;for(var i in t)t.hasOwnProperty(i)&&(i in e?(r=t[i],typeof r=="object"?T(e[i],r,n):n||(e[i]=t[i])):e[i]=t[i]);return e}function N(e){var n;return e.props.name&&h?n=t.createElement('<iframe name="'+e.props.name+'"/>'):n=t.createElement("IFRAME"),T(n,e.props),n.id=n.name,e.onLoad&&(n.loadFn=function(){e.onLoad(n.contentWindow)},v(n,"load",n.loadFn)),e.container?(n.border=n.frameBorder=0,e.container.appendChild(n)):(n.style.position="absolute",n.style.left="-2000px",n.style.top="0px",t.body.appendChild(n)),n}function k(e){T(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},success:a,error:function(e){throw new Error(e)},data:{},type:"plain"},!0);var t=C(),n=[];t.open(e.method,e.url,!0);for(var r in e.headers)e.headers.hasOwnProperty(r)&&t.setRequestHeader(r,e.headers[r]);t.onreadystatechange=function(){if(t.readyState==4){if(t.status>=200&&t.status<300){var n=t.responseText;e.type==="json"&&(n=x().parse(n)),e.success(n)}else e.error("An error occured. Status code: "+t.status);t.onreadystatechange=null,delete t.onreadystatechange}};for(var i in e.data)e.data.hasOwnProperty(i)&&n.push(s(i)+"="+s(e.data[i]));t.send(n.join("&"))}function L(r){var o=r.protocol,a;r.isHost=r.isHost||S(E.xdm_p),r.props||(r.props={}),r.isHost?(r.remote=b(r.remote),r.channel=r.channel||"default"+u++,r.secret=Math.random().toString(16).substring(2),S(o)&&(p(e,"postMessage")?o="1":p(e,"ActiveXObject")&&p(e,"execScript")?o="3":r.remoteHelper?(r.remoteHelper=b(r.remoteHelper),o="2"):o="0")):(r.channel=E.xdm_c,r.secret=E.xdm_s,r.remote=i(E.xdm_e),o=E.xdm_p);switch(o){case"0":T(r,{interval:300,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0);if(r.isHost){if(!r.local){var f=n.protocol+"//"+n.host,l=t.body.getElementsByTagName("img"),c=l.length,h;while(c--){h=l[c];if(h.src.substring(0,f.length)===f){r.local=h.src;break}}r.local||(r.local=e)}var d={xdm_c:r.channel,xdm_p:0};r.local===e?(r.usePolling=!0,r.useParent=!0,r.local=n.protocol+"//"+n.host+n.pathname+n.search,d.xdm_e=s(r.local),d.xdm_pa=1):d.xdm_e=b(r.local),r.container&&(r.useResize=!1,d.xdm_po=1),r.remote=w(r.remote,d)}else T(r,{channel:E.xdm_c,remote:i(E.xdm_e),useParent:!S(E.xdm_pa),usePolling:!S(E.xdm_po),useResize:r.useParent?!1:r.useResize});a=[new easyXDM.stack.HashTransport(r),new easyXDM.stack.ReliableBehavior({timeout:(r.useResize?50:r.interval*1.5)+(r.usePolling?r.interval*1.5:50)}),new easyXDM.stack.QueueBehavior({encode:!0,maxLength:4e3-r.remote.length}),new easyXDM.stack.VerifyBehavior({initiate:r.isHost})];break;case"1":a=[new easyXDM.stack.PostMessageTransport(r),new easyXDM.stack.QueueBehavior];break;case"2":a=[new easyXDM.stack.NameTransport(r),new easyXDM.stack.QueueBehavior,new easyXDM.stack.VerifyBehavior({initiate:r.isHost})];break;case"3":a=[new easyXDM.stack.NixTransport(r),new easyXDM.stack.QueueBehavior]}return a}function A(e){var t,n={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var r=0,i=e.length;r<i;r++)t=e[r],T(t,n,!0),r!==0&&(t.down=e[r-1]),r!==i-1&&(t.up=e[r+1]);return t}var o=this,u=0,a=Function.prototype,f=/^(http.?:\/\/([^\/\s]+))/,l=/[\-\w]+\/\.\.\//,c=/([^:])\/\//g,h=/msie [67]/.test(navigator.userAgent.toLowerCase()),v=function(){return p(e,"addEventListener")?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)}}(),m=function(){return p(e,"removeEventListener")?function(e,t,n,r){e.removeEventListener(t,n,r)}:function(e,t,n){e.detachEvent("on"+t,n)}}(),E=function(){var e={},t,r=n.search.substring(1).split("&"),i=r.length;while(i--)t=r[i].split("="),e[t[0]]=t[1];return e}(),C=function(){if(p(e,"XMLHttpRequest"))return function(){return new XMLHttpRequest};var t=function(){var e=["Microsoft","Msxml2","Msxml3"],n=e.length;while(n--)try{t=e[n]+".XMLHTTP";var r=new ActiveXObject(t);return t}catch(i){}}();return function(){return new ActiveXObject(t)}}();o.easyXDM={version:"2.4.0.90",apply:T,query:E,ajax:k,getJSONObject:x,stack:{}},easyXDM.DomHelper={on:v,un:m,requiresJSON:function(n){d(e,"JSON")||t.write('<script type="text/javascript" src="'+n+'"></script>')}},function(){var e={};easyXDM.Fn={set:function(t,n){e[t]=n},get:function(t,n){var r=e[t];return n&&delete e[t],r}}}(),easyXDM.Socket=function(e){var t=A(L(e).concat([{incoming:function(t,n){e.onMessage(t,n)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=y(e.remote);this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,n)},t.init()},easyXDM.Rpc=function(e,t){if(t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var r=t.local[n];typeof r=="function"&&(t.local[n]={method:r})}var i=A(L(e).concat([new easyXDM.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.destroy=function(){i.destroy()},i.init()},easyXDM.stack.PostMessageTransport=function(t){function a(e){if(e.origin)return e.origin;if(e.uri)return y(e.uri);if(e.domain)return n.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function f(e){var n=a(e);n==u&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&i.up.incoming(e.data.substring(t.channel.length+1),n)}var i,s,o,u;return i={outgoing:function(e,n,r){o.postMessage(t.channel+" "+e,n||u),r()},destroy:function(){m(e,"message",f),s&&(o=null,s.parentNode.removeChild(s),s=null)},init:function(){u=y(t.remote),t.isHost?(v(e,"message",function a(n){n.data==t.channel+"-ready"&&(o=s.contentWindow,m(e,"message",a),v(e,"message",f),r(function(){i.up.callback(!0)},0))}),T(t.props,{src:w(t.remote,{xdm_e:n.protocol+"//"+n.host,xdm_c:t.channel,xdm_p:1})}),s=N(t)):(v(e,"message",f),o=e.parent,o.postMessage(t.channel+"-ready",u),r(function(){i.up.callback(!0)},0))}}},easyXDM.stack.NixTransport=function(t){var i,s,u,a,f;return i={outgoing:function(e,t,n){u(e),n()},destroy:function(){f=null,s&&(s.parentNode.removeChild(s),s=null)},init:function(){a=y(t.remote);if(t.isHost){try{p(e,"GetNixProxy")||e.execScript("Class NixProxy\n    Private m_parent, m_child, m_Auth\n\n    Public Sub SetParent(obj, auth)\n        If isEmpty(m_Auth) Then m_Auth = auth\n        SET m_parent = obj\n    End Sub\n    Public Sub SetChild(obj)\n        SET m_child = obj\n        m_parent.ready()\n    End Sub\n\n    Public Sub SendToParent(data, auth)\n        If m_Auth = auth Then m_parent.send(CStr(data))\n    End Sub\n    Public Sub SendToChild(data, auth)\n        If m_Auth = auth Then m_child.send(CStr(data))\n    End Sub\nEnd Class\nFunction GetNixProxy()\n    Set GetNixProxy = New NixProxy\nEnd Function\n","vbscript"),f=GetNixProxy(),f.SetParent({send:function(e){i.up.incoming(e,a)},ready:function(){r(function(){i.up.callback(!0)},0)}},t.secret),u=function(e){f.SendToChild(e,t.secret)}}catch(l){throw new Error("Could not set up VBScript NixProxy:"+l.message)}T(t.props,{src:w(t.remote,{xdm_e:n.protocol+"//"+n.host,xdm_c:t.channel,xdm_s:t.secret,xdm_p:3})}),s=N(t),s.contentWindow.opener=f}else{try{f=e.opener}catch(l){throw new Error("Cannot access window.opener")}f.SetChild({send:function(e){o.setTimeout(function(){i.up.incoming(e,a)},0)}}),u=function(e){f.SendToParent(e,t.secret)},r(function(){i.up.callback(!0)},0)}}}},easyXDM.stack.NameTransport=function(e){function c(t){var r=e.remoteHelper+(n?"#_3"+s(l+"#"+e.channel):"#_2"+e.channel);i.contentWindow.sendMessage(t,r)}function h(){n?(++u===2||!n)&&t.up.callback(!0):(c("ready"),t.up.callback(!0))}function p(e){t.up.incoming(e,f)}function d(){a&&r(function(){a(!0)},0)}var t,n,i,o,u,a,f,l;return t={outgoing:function(e,t,n){a=n,c(e)},destroy:function(){i.parentNode.removeChild(i),i=null,n&&(o.parentNode.removeChild(o),o=null)},init:function(){n=e.isHost,u=0,f=y(e.remote),e.local=b(e.local),n?(easyXDM.Fn.set(e.channel,function(t){n&&t==="ready"&&(easyXDM.Fn.set(e.channel,p),h())}),l=w(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),T(e.props,{src:l+"#"+e.channel,name:e.channel}),o=N(e)):(e.remoteHelper=e.remote,easyXDM.Fn.set(e.channel,p)),i=N({props:{src:e.local+"#_4"+e.channel},onLoad:function(){m(i,"load",i.loadFn),easyXDM.Fn.set(e.channel+"_load",d),h()}})}}},easyXDM.stack.HashTransport=function(t){function b(e){if(!c)return;var n=t.remote+"#"+f++ +"_"+e;s||!p?(c.contentWindow.location=n,d&&(c.width=c.width>75?50:100)):c.location=n}function w(e){a=e,n.up.incoming(a.substring(a.indexOf("_")+1),g)}function E(){w(l.location.hash)}function S(){l.location.hash&&l.location.hash!=a&&w(l.location.hash)}function x(){h?o=setInterval(S,u):v(l,"resize",E)}var n,i=this,s,o,u,a,f,l,c,h,p,d,g;return n={outgoing:function(e,t){b(e)},destroy:function(){h?e.clearInterval(o):l&&m(l,"resize",S),(s||!p)&&c.parentNode.removeChild(c),c=null},init:function(){s=t.isHost,u=t.interval,a="#"+t.channel,f=0,h=t.usePolling,p=t.useParent,d=t.useResize,g=y(t.remote);if(!s&&p)l=e,c=parent,x(),n.up.callback(!0);else{T(t,{props:{src:s?t.remote:t.remote+"#"+t.channel,name:(s?"local_":"remote_")+t.channel},onLoad:s&&p||!s?function(){l=e,x(),n.up.callback(!0)}:null}),c=N(t);if(s&&!p){var i=0,v=t.delay/50;(function m(){if(++i>v)throw new Error("Unable to reference listenerwindow");if(l)return;try{l=c.contentWindow.frames["remote_"+t.channel],e.clearTimeout(o),x(),n.up.callback(!0);return}catch(s){r(m,50)}})()}}}}},easyXDM.stack.ReliableBehavior=function(t){var n,i,s,o,u=0,a=0,f=t.tries||5,l=t.timeout,c=0,h;return n={incoming:function(s,o){var a=s.indexOf("_"),f=parseInt(s.substring(0,a),10),l;s=s.substring(a+1),a=s.indexOf("_"),l=parseInt(s.substring(0,a),10),a=s.indexOf("_"),s=s.substring(a+1),i&&f===u&&(e.clearTimeout(i),i=null,h&&r(function(){h(!0)},0)),l!==0&&(l!==c?(c=l,s=s.substring(l.length+1),n.down.outgoing(l+"_0_ack",o),r(function(){n.up.incoming(s,o)},t.timeout/2)):n.down.outgoing(l+"_0_ack",o))},outgoing:function(e,o,l){h=l,a=0,s={data:c+"_"+ ++u+"_"+e,origin:o},function p(){i=null,++a>f?h&&r(function(){h(!1)},0):(n.down.outgoing(s.data,s.origin),i=r(p,t.timeout))}()},destroy:function(){i&&e.clearInterval(i),n.down.destroy()}}},easyXDM.stack.QueueBehavior=function(e){function l(){if(o||n.length===0||a)return;o=!0;var e=n.shift();t.down.outgoing(e.data,e.origin,function(t){o=!1,e.callback&&r(function(){e.callback(t)},0),l()})}var t,n=[],o=!0,u="",a,f=0;return t={init:function(){S(e)&&(e={}),f=e.maxLength?e.maxLength:0,t.down.init()},callback:function(e){o=!1,l(),t.up.callback(e)},incoming:function(n,r){var s=n.indexOf("_"),o=parseInt(n.substring(0,s),10);u+=n.substring(s+1),o===0&&(e.encode&&(u=i(u)),t.up.incoming(u,r),u="")},outgoing:function(t,r,i){e.encode&&(t=s(t));var o=[],u;if(f)while(t.length!==0)u=t.substring(0,f),t=t.substring(u.length),o.push(u);else o.push(t);while(u=o.shift())n.push({data:o.length+"_"+u,origin:r,callback:o.length===0?i:null});l()},destroy:function(){a=!0,t.down.destroy()}}},easyXDM.stack.VerifyBehavior=function(e){function s(){n=Math.random().toString(16).substring(2),t.down.outgoing(n)}var t,n,r,i=!1;return t={incoming:function(i,o){var u=i.indexOf("_");u===-1?i===n?t.up.callback(!0):r||(r=i,e.initiate||s(),t.down.outgoing(i)):i.substring(0,u)===r&&t.up.incoming(i.substring(u+1),o)},outgoing:function(e,r,i){t.down.outgoing(n+"_"+e,r,i)},callback:function(t){e.initiate&&s()}}},easyXDM.stack.RpcBehavior=function(e,t){function o(e){e.jsonrpc="2.0",n.down.outgoing(r.stringify(e))}function u(e,t){var n=Array.prototype.slice;return function(){var e=arguments.length,r,u={method:t};e>0&&typeof arguments[e-1]=="function"?(e>1&&typeof arguments[e-2]=="function"?(r={success:arguments[e-2],error:arguments[e-1]},u.params=n.call(arguments,0,e-2)):(r={success:arguments[e-1]},u.params=n.call(arguments,0,e-1)),s[""+ ++i]=r,u.id=i):u.params=n.call(arguments,0),o(u)}}function f(e,t,n,r){if(!n){t&&o({id:t,error:{code:-32601,message:"Procedure not found."}});return}var i=!1,s,u;t?(s=function(e){if(i)return;i=!0,o({id:t,result:e})},u=function(e){if(i)return;i=!0,o({id:t,error:{code:-32099,message:"Application error: "+e}})}):s=u=a;try{var f=n.method.apply(n.scope,r.concat([s,u]));S(f)||s(f)}catch(l){u(l.message)}}var n,r=t.serializer||x(),i=0,s={};return n={incoming:function(e,n){var i=r.parse(e);if(i.method)t.handle?t.handle(i,o):f(i.method,i.id,t.local[i.method],i.params);else{var u=s[i.id];i.error?u.error&&u.error(i.error):u.success&&u.success(i.result),delete s[i.id]}},init:function(){if(t.remote)for(var r in t.remote)t.remote.hasOwnProperty(r)&&(e[r]=u(t.remote[r],r));n.down.init()},destroy:function(){for(var r in t.remote)t.remote.hasOwnProperty(r)&&e.hasOwnProperty(r)&&delete e[r];n.down.destroy()}}}})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);


/* public/javascripts/swfobject.js @ 1370554951 */
/**
 * SWFObject v1.4.4: Flash Player detection and embed - http://blog.deconcept.com/swfobject/
 *
 * SWFObject is (c) 2006 Geoff Stearns and is released under the MIT License:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * **SWFObject is the SWF embed script formerly known as FlashObject. The name was changed for
 *   legal reasons.
 */
if(typeof deconcept=="undefined")var deconcept=new Object;typeof deconcept.util=="undefined"&&(deconcept.util=new Object),typeof deconcept.SWFObjectUtil=="undefined"&&(deconcept.SWFObjectUtil=new Object),deconcept.SWFObject=function(e,t,n,r,i,s,o,u,a,f,l){if(!document.getElementById)return;this.DETECT_KEY=l?l:"detectflash",this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY),this.params=new Object,this.variables=new Object,this.attributes=new Array,e&&this.setAttribute("swf",e),t&&this.setAttribute("id",t),n&&this.setAttribute("width",n),r&&this.setAttribute("height",r),i&&this.setAttribute("version",new deconcept.PlayerVersion(i.toString().split("."))),this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion(),s&&this.addParam("bgcolor",s);var c=u?u:"high";this.addParam("quality",c),this.setAttribute("useExpressInstall",o),this.setAttribute("doExpressInstall",!1);var h=a?a:window.location;this.setAttribute("xiRedirectUrl",h),this.setAttribute("redirectUrl",""),f&&this.setAttribute("redirectUrl",f)},deconcept.SWFObject.prototype={setAttribute:function(e,t){this.attributes[e]=t},getAttribute:function(e){return this.attributes[e]},addParam:function(e,t){this.params[e]=t},getParams:function(){return this.params},addVariable:function(e,t){this.variables[e]=t},getVariable:function(e){return this.variables[e]},getVariables:function(){return this.variables},getVariablePairs:function(){var e=new Array,t,n=this.getVariables();for(t in n)e.push(t+"="+n[t]);return e},getSWFHTML:function(){var e="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){this.getAttribute("doExpressInstall")&&this.addVariable("MMplayerType","PlugIn"),e='<embed type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'"',e+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var t=this.getParams();for(var n in t)e+=[n]+'="'+t[n]+'" ';var r=this.getVariablePairs().join("&");r.length>0&&(e+='flashvars="'+r+'"'),e+="/>"}else{this.getAttribute("doExpressInstall")&&this.addVariable("MMplayerType","ActiveX"),e='<object id="'+this.getAttribute("id")+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'">',e+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var t=this.getParams();for(var n in t)e+='<param name="'+n+'" value="'+t[n]+'" />';var r=this.getVariablePairs().join("&");r.length>0&&(e+='<param name="flashvars" value="'+r+'" />'),e+="</object>"}return e},write:function(e){if(this.getAttribute("useExpressInstall")){var t=new deconcept.PlayerVersion([6,0,65]);this.installedVer.versionIsValid(t)&&!this.installedVer.versionIsValid(this.getAttribute("version"))&&(this.setAttribute("doExpressInstall",!0),this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl"))),document.title=document.title.slice(0,47)+" - Flash Player Installation",this.addVariable("MMdoctitle",document.title))}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n=typeof e=="string"?document.getElementById(e):e;return n.innerHTML=this.getSWFHTML(),!0}return this.getAttribute("redirectUrl")!=""&&document.location.replace(this.getAttribute("redirectUrl")),!1}},deconcept.SWFObjectUtil.getPlayerVersion=function(){var e=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var t=navigator.plugins["Shockwave Flash"];t&&t.description&&(e=new deconcept.PlayerVersion(t.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")))}else{try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(r){try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");e=new deconcept.PlayerVersion([6,0,21]),n.AllowScriptAccess="always"}catch(r){if(e.major==6)return e}try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(r){}}n!=null&&(e=new deconcept.PlayerVersion(n.GetVariable("$version").split(" ")[1].split(",")))}return e},deconcept.PlayerVersion=function(e){this.major=e[0]!=null?parseInt(e[0]):0,this.minor=e[1]!=null?parseInt(e[1]):0,this.rev=e[2]!=null?parseInt(e[2]):0},deconcept.PlayerVersion.prototype.versionIsValid=function(e){return this.major<e.major?!1:this.major>e.major?!0:this.minor<e.minor?!1:this.minor>e.minor?!0:this.rev<e.rev?!1:!0},deconcept.util={getRequestParameter:function(e){var t=document.location.search||document.location.hash;if(t){var n=t.substring(1).split("&");for(var r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return n[r].substring(n[r].indexOf("=")+1)}return""}},deconcept.SWFObjectUtil.cleanupSWFs=function(){if(window.opera||!document.all)return;var e=document.getElementsByTagName("OBJECT");for(var t=0;t<e.length;t++){e[t].style.display="none";for(var n in e[t])typeof e[t][n]=="function"&&(e[t][n]=function(){})}},deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){};if(typeof window.onunload=="function"){var e=window.onunload;window.onunload=function(){deconcept.SWFObjectUtil.cleanupSWFs(),e()}}else window.onunload=deconcept.SWFObjectUtil.cleanupSWFs};if(typeof window.onbeforeunload=="function"){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){deconcept.SWFObjectUtil.prepUnload(),oldBeforeUnload()}}else window.onbeforeunload=deconcept.SWFObjectUtil.prepUnload;Array.prototype.push==null&&(Array.prototype.push=function(e){return this[this.length]=e,this.length});var getQueryParamValue=deconcept.util.getRequestParameter,FlashObject=deconcept.SWFObject,SWFObject=deconcept.SWFObject;


/* public/javascripts/global/browser_detect.js @ 1370554951 */
// Browser Detection Code from http://www.quirksmode.org/js/detect.html
// Do NOT use this to figure out if browsers have a certain feature or not, use
// object detection instead http://www.quirksmode.org/js/support.html
//
// Usage:
// Browser name: BrowserDetect.browser
// Browser version: BrowserDetect.version
// OS name: BrowserDetect.OS
Scribd.BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,r=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!=-1)return e[t].identity}else if(r)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(t==-1)return;return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},Scribd.BrowserDetect.init();


/* public/javascripts/backbone/backbone.js @ 1370554951 */
//     Backbone.js 0.9.2
//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org
(function(){var e=this,t=e.Backbone,n=Array.prototype.slice,r=Array.prototype.splice,i;typeof exports!="undefined"?i=exports:i=e.Backbone={},i.VERSION="0.9.2";var s=e._;!s&&typeof require!="undefined"&&(s=require("underscore"));var o=e.jQuery||e.Zepto||e.ender;i.setDomLibrary=function(e){o=e},i.noConflict=function(){return e.Backbone=t,this},i.emulateHTTP=!1,i.emulateJSON=!1;var u=/\s+/,a=i.Events={on:function(e,t,n){var r,i,s,o,a;if(!t)return this;e=e.split(u),r=this._callbacks||(this._callbacks={});while(i=e.shift())a=r[i],s=a?a.tail:{},s.next=o={},s.context=n,s.callback=t,r[i]={tail:o,next:a?a.next:s};return this},off:function(e,t,n){var r,i,o,a,f,l;if(!(i=this._callbacks))return;if(!(e||t||n))return delete this._callbacks,this;e=e?e.split(u):s.keys(i);while(r=e.shift()){o=i[r],delete i[r];if(!o||!t&&!n)continue;a=o.tail;while((o=o.next)!==a)f=o.callback,l=o.context,(t&&f!==t||n&&l!==n)&&this.on(r,f,l)}return this},trigger:function(e){var t,r,i,s,o,a,f;if(!(i=this._callbacks))return this;a=i.all,e=e.split(u),f=n.call(arguments,1);while(t=e.shift()){if(r=i[t]){s=r.tail;while((r=r.next)!==s)r.callback.apply(r.context||this,f)}if(r=a){s=r.tail,o=[t].concat(f);while((r=r.next)!==s)r.callback.apply(r.context||this,o)}}return this}};a.bind=a.on,a.unbind=a.off;var f=i.Model=function(e,t){var n;e||(e={}),t&&t.parse&&(e=this.parse(e));if(n=C(this,"defaults"))e=s.extend({},n,e);t&&t.collection&&(this.collection=t.collection),this.attributes={},this._escapedAttributes={},this.cid=s.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(e,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=s.clone(this.attributes),this.initialize.apply(this,arguments)};s.extend(f.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(e){var t;if(t=this._escapedAttributes[e])return t;var n=this.get(e);return this._escapedAttributes[e]=s.escape(n==null?"":""+n)},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n||(n={});if(!r)return this;r instanceof f&&(r=r.attributes);if(n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var u=n.changes={},a=this.attributes,l=this._escapedAttributes,c=this._previousAttributes||{};for(i in r){o=r[i];if(!s.isEqual(a[i],o)||n.unset&&s.has(a,i))delete l[i],(n.silent?this._silent:u)[i]=!0;n.unset?delete a[i]:a[i]=o,!s.isEqual(c[i],o)||s.has(a,i)!=s.has(c,i)?(this.changed[i]=o,n.silent||(this._pending[i]=!0)):(delete this.changed[i],delete this._pending[i])}return n.silent||this.change(n),this},unset:function(e,t){return(t||(t={})).unset=!0,this.set(e,null,t)},clear:function(e){return(e||(e={})).unset=!0,this.set(s.clone(this.attributes),e)},fetch:function(e){e=e?s.clone(e):{};var t=this,n=e.success;return e.success=function(r,i,s){if(!t.set(t.parse(r,s),e))return!1;n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},save:function(e,t,n){var r,o;s.isObject(e)||e==null?(r=e,n=t):(r={},r[e]=t),n=n?s.clone(n):{};if(n.wait){if(!this._validate(r,n))return!1;o=s.clone(this.attributes)}var u=s.extend({},n,{silent:!0});if(r&&!this.set(r,n.wait?u:n))return!1;var a=this,f=n.success;n.success=function(e,t,i){var o=a.parse(e,i);n.wait&&(delete n.wait,o=s.extend(r||{},o));if(!a.set(o,n))return!1;f?f(a,e):a.trigger("sync",a,e,n)},n.error=i.wrapError(n.error,a,n);var l=this.isNew()?"create":"update",c=(this.sync||i.sync).call(this,l,this,n);return n.wait&&this.set(o,u),c},destroy:function(e){e=e?s.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(this.isNew())return r(),!1;e.success=function(i){e.wait&&r(),n?n(t,i):t.trigger("sync",t,i,e)},e.error=i.wrapError(e.error,t,e);var o=(this.sync||i.sync).call(this,"delete",this,e);return e.wait||r(),o},url:function(){var e=C(this,"urlRoot")||C(this.collection,"url")||k();return this.isNew()?e:e+(e.charAt(e.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(e){e||(e={});var t=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=s.extend({},e.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),e);if(t)return this;while(!s.isEmpty(this._pending)){this._pending={},this.trigger("change",this,e);for(var n in this.changed){if(this._pending[n]||this._silent[n])continue;delete this.changed[n]}this._previousAttributes=s.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(e){return arguments.length?s.has(this.changed,e):!s.isEmpty(this.changed)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t,n=!1,r=this._previousAttributes;for(var i in e){if(s.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return s.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(e,t){if(t.silent||!this.validate)return!0;e=s.extend({},this.attributes,e);var n=this.validate(e,t);return n?(t&&t.error?t.error(this,n,t):this.trigger("error",this,n,t),!1):!0}});var l=i.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,{silent:!0,parse:t.parse})};s.extend(l.prototype,a,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},add:function(e,t){var n,i,o,u,a,f,l={},c={},h=[];t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,o=e.length;n<o;n++){if(!(u=e[n]=this._prepareModel(e[n],t)))throw new Error("Can't add an invalid model to a collection");a=u.cid,f=u.id;if(l[a]||this._byCid[a]||f!=null&&(c[f]||this._byId[f])){h.push(n);continue}l[a]=c[f]=u}n=h.length;while(n--)e.splice(h[n],1);for(n=0,o=e.length;n<o;n++)(u=e[n]).on("all",this._onModelEvent,this),this._byCid[u.cid]=u,u.id!=null&&(this._byId[u.id]=u);this.length+=o,i=t.at!=null?t.at:this.models.length,r.apply(this.models,[i,0].concat(e)),this.comparator&&this.sort({silent:!0});if(t.silent)return this;for(n=0,o=this.models.length;n<o;n++){if(!l[(u=this.models[n]).cid])continue;t.index=n,u.trigger("add",u,this,t)}return this},remove:function(e,t){var n,r,i,o;t||(t={}),e=s.isArray(e)?e.slice():[e];for(n=0,r=e.length;n<r;n++){o=this.getByCid(e[n])||this.get(e[n]);if(!o)continue;delete this._byId[o.id],delete this._byCid[o.cid],i=this.indexOf(o),this.models.splice(i,1),this.length--,t.silent||(t.index=i,o.trigger("remove",o,this,t)),this._removeReference(o)}return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,t),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,s.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},where:function(e){return s.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){e||(e={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var t=s.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("reset",this,e),this},pluck:function(e){return s.map(this.models,function(t){return t.get(e)})},reset:function(e,t){e||(e=[]),t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return this._reset(),this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?s.clone(e):{},e.parse===undefined&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r,i,s){t[e.add?"add":"reset"](t.parse(r,s),e),n&&n(t,r)},e.error=i.wrapError(e.error,t,e),(this.sync||i.sync).call(this,"read",this,e)},create:function(e,t){var n=this;t=t?s.clone(t):{},e=this._prepareModel(e,t);if(!e)return!1;t.wait||n.add(e,t);var r=t.success;return t.success=function(i,s,o){t.wait&&n.add(i,t),r?r(i,s):i.trigger("sync",e,s,t)},e.save(null,t),e},parse:function(e,t){return e},chain:function(){return s(this.models).chain()},_reset:function(e){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(e,t){t||(t={});if(e instanceof f)e.collection||(e.collection=this);else{var n=e;t.collection=this,e=new this.model(n,t),e._validate(e.attributes,t)||(e=!1)}return e},_removeReference:function(e){this==e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e=="add"||e=="remove")&&n!=this)return;e=="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],this._byId[t.id]=t),this.trigger.apply(this,arguments)}});var c=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];s.each(c,function(e){l.prototype[e]=function(){return s[e].apply(s,[this.models].concat(s.toArray(arguments)))}});var h=i.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},p=/:\w+/g,d=/\*\w+/g,v=/[-[\]{}()+?.,\\^$|#\s]/g;s.extend(h.prototype,a,{initialize:function(){},route:function(e,t,n){return i.history||(i.history=new m),s.isRegExp(e)||(e=this._routeToRegExp(e)),n||(n=this[t]),i.history.route(e,s.bind(function(r){var s=this._extractParameters(e,r);n&&n.apply(this,s),this.trigger.apply(this,["route:"+t].concat(s)),i.history.trigger("route",this,t,s)},this)),this},navigate:function(e,t){i.history.navigate(e,t)},_bindRoutes:function(){if(!this.routes)return;var e=[];for(var t in this.routes)e.unshift([t,this.routes[t]]);for(var n=0,r=e.length;n<r;n++)this.route(e[n][0],e[n][1],this[e[n][1]])},_routeToRegExp:function(e){return e=e.replace(v,"\\$&").replace(p,"([^/]+)").replace(d,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var m=i.History=function(){this.handlers=[],s.bindAll(this,"checkUrl")},g=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,s.extend(m.prototype,a,{interval:50,getHash:function(e){var t=e?e.location:window.location,n=t.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||t){e=window.location.pathname;var n=window.location.search;n&&(e+=n)}else e=this.getHash();return e.indexOf(this.options.root)||(e=e.substr(this.options.root.length)),e.replace(g,"")},start:function(e){if(m.started)throw new Error("Backbone.history has already been started");m.started=!0,this.options=s.extend({},{root:"/"},this.options,e),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var t=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);r&&(this.iframe=o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=window.location,u=i.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!u)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&u&&i.hash&&(this.fragment=this.getHash().replace(g,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){o(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t==this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=s.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!m.started)return!1;if(!t||t===!0)t={trigger:t};var n=(e||"").replace(g,"");if(this.fragment==n)return;this._hasPushState?(n.indexOf(this.options.root)!=0&&(n=this.options.root+n),this.fragment=n,window.history[t.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,t.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,t.replace))):window.location.assign(this.options.root+e),t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){n?e.replace(e.toString().replace(/(javascript:|#).*$/,"")+"#"+t):e.hash=t}});var b=i.View=function(e){this.cid=s.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName"];s.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(e,t,n){var r=document.createElement(e);return t&&o(r).attr(t),n&&o(r).html(n),r},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o?e:o(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=C(this,"events")))return;this.undelegateEvents();for(var t in e){var n=e[t];s.isFunction(n)||(n=this[e[t]]);if(!n)throw new Error('Method "'+e[t]+'" does not exist');var r=t.match(w),i=r[1],o=r[2];n=s.bind(n,this),i+=".delegateEvents"+this.cid,o===""?this.$el.bind(i,n):this.$el.delegate(o,i,n)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=s.extend({},this.options,e));for(var t=0,n=E.length;t<n;t++){var r=E[t];e[r]&&(this[r]=e[r])}this.options=e},_ensureElement:function(){if(!this.el){var e=C(this,"attributes")||{};this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),this.setElement(this.make(this.tagName,e),!1)}else this.setElement(this.el,!1)}});var S=function(e,t){var n=N(this,e,t);return n.extend=this.extend,n};f.extend=l.extend=h.extend=b.extend=S;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};i.sync=function(e,t,n){var r=x[e];n||(n={});var u={type:r,dataType:"json"};return n.url||(u.url=C(t,"url")||k()),!n.data&&t&&(e=="create"||e=="update")&&(u.contentType="application/json",u.data=JSON.stringify(t.toJSON())),i.emulateJSON&&(u.contentType="application/x-www-form-urlencoded",u.data=u.data?{model:u.data}:{}),i.emulateHTTP&&(r==="PUT"||r==="DELETE")&&(i.emulateJSON&&(u.data._method=r),u.type="POST",u.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r)}),u.type!=="GET"&&!i.emulateJSON&&(u.processData=!1),o.ajax(s.extend(u,n))},i.wrapError=function(e,t,n){return function(r,i){i=r===t?i:r,e?e(t,i,n):t.trigger("error",t,i,n)}};var T=function(){},N=function(e,t,n){var r;return t&&t.hasOwnProperty("constructor")?r=t.constructor:r=function(){e.apply(this,arguments)},s.extend(r,e),T.prototype=e.prototype,r.prototype=new T,t&&s.extend(r.prototype,t),n&&s.extend(r,n),r.prototype.constructor=r,r.__super__=e.prototype,r},C=function(e,t){return!e||!e[t]?null:s.isFunction(e[t])?e[t]():e[t]},k=function(){throw new Error('A "url" property or function must be specified')}}).call(this);


/* public/javascripts/backbone/backbone-relational.js @ 1370554951 */
/**
 * Backbone-relational.js 0.6.0
 * (c) 2011 Paul Uithol
 * 
 * Backbone-relational may be freely distributed under the MIT license; see the accompanying LICENSE.txt.
 * For details and documentation: https://github.com/PaulUithol/Backbone-relational.
 * Depends on Backbone (and thus on Underscore as well): https://github.com/documentcloud/backbone.
 */
(function(e){"use strict";var t,n,r;typeof window=="undefined"?(t=require("underscore"),n=require("backbone"),r=module.exports=n):(t=window._,n=window.Backbone,r=window),n.Relational={showWarnings:!0},n.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");this._permitsUsed++},release:function(){if(this._permitsUsed===0)throw new Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(e){if(this._permitsUsed>e)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=e}},n.BlockingQueue=function(){this._queue=[]},t.extend(n.BlockingQueue.prototype,n.Semaphore,{_queue:null,add:function(e){this.isBlocked()?this._queue.push(e):e()},process:function(){while(this._queue&&this._queue.length)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),n.Relational.eventQueue=new n.BlockingQueue,n.Store=function(){this._collections=[],this._reverseRelations=[],this._subModels=[],this._modelScopes=[r]},t.extend(n.Store.prototype,n.Events,{addModelScope:function(e){this._modelScopes.push(e)},addSubModels:function(e,t){this._subModels.push({superModelType:t,subModels:e})},setupSuperModel:function(e){t.find(this._subModels,function(n){return t.find(n.subModels,function(t,r){var i=this.getObjectByName(t);if(e===i)return n.superModelType._subModels[r]=e,e._superModel=n.superModelType,e._subModelTypeValue=r,e._subModelTypeAttribute=n.superModelType.prototype.subModelTypeAttribute,!0},this)},this)},addReverseRelation:function(e){var n=t.any(this._reverseRelations,function(n){return t.all(e,function(e,t){return e===n[t]})});if(!n&&e.model&&e.type){this._reverseRelations.push(e);var r=function(e,n){e.prototype.relations||(e.prototype.relations=[]),e.prototype.relations.push(n),t.each(e._subModels,function(e){r(e,n)},this)};r(e.model,e),this.retroFitRelation(e)}},retroFitRelation:function(e){var t=this.getCollection(e.model);t.each(function(t){if(!(t instanceof e.model))return;new e.type(t,e)},this)},getCollection:function(e){e instanceof n.RelationalModel&&(e=e.constructor);var r=e;while(r._superModel)r=r._superModel;var i=t.detect(this._collections,function(e){return e.model===r});return i||(i=this._createCollection(r)),i},getObjectByName:function(e){var n=e.split("."),r=null;return t.find(this._modelScopes,function(e){r=t.reduce(n,function(e,t){return e[t]},e);if(r&&r!==e)return!0},this),r},_createCollection:function(e){var t;return e instanceof n.RelationalModel&&(e=e.constructor),e.prototype instanceof n.RelationalModel&&(t=new n.Collection,t.model=e,this._collections.push(t)),t},resolveIdForItem:function(e,r){var i=t.isString(r)||t.isNumber(r)?r:null;return i===null&&(r instanceof n.RelationalModel?i=r.id:t.isObject(r)&&(i=r[e.prototype.idAttribute])),!i&&i!==0&&(i=null),i},find:function(e,t){var n=this.resolveIdForItem(e,t),r=this.getCollection(e);if(r){var i=r.get(n);if(i instanceof e)return i}return null},register:function(e){var t=this.getCollection(e);if(t){if(t.get(e))throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!");var n=e.collection;t.add(e),e.bind("destroy",this.unregister,this),e.collection=n}},update:function(e){var t=this.getCollection(e);t._onModelEvent("change:"+e.idAttribute,e,t)},unregister:function(e){e.unbind("destroy",this.unregister);var t=this.getCollection(e);t&&t.remove(e)}}),n.Relational.store=new n.Store,n.Relation=function(e,r){this.instance=e,r=t.isObject(r)?r:{},this.reverseRelation=t.defaults(r.reverseRelation||{},this.options.reverseRelation),this.reverseRelation.type=t.isString(this.reverseRelation.type)?n[this.reverseRelation.type]||n.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.model=r.model||this.instance.constructor,this.options=t.defaults(r,this.options,n.Relation.prototype.options),this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.relatedModel=this.options.relatedModel,t.isString(this.relatedModel)&&(this.relatedModel=n.Relational.store.getObjectByName(this.relatedModel));if(!this.checkPreconditions())return!1;e&&(this.keyContents=this.instance.get(this.keySource),this.key!==this.keySource&&this.instance.unset(this.keySource,{silent:!0}),this.instance._relations.push(this)),!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&n.Relational.store.addReverseRelation(t.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation)),t.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved"),e&&(this.initialize(),n.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection),n.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved))},n.Relation.extend=n.Model.extend,t.extend(n.Relation.prototype,n.Events,n.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(e,t,n){var r=this;e.queue(function(){r.tryAddRelated(e,n)})},_relatedModelRemoved:function(e,t,n){this.removeRelated(e,n)},_modelRemovedFromCollection:function(e){e===this.instance&&this.destroy()},checkPreconditions:function(){var e=this.instance,r=this.key,i=this.model,s=this.relatedModel,o=n.Relational.showWarnings&&typeof console!="undefined";if(!i||!r||!s)return o&&console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,i,r,s),!1;if(i.prototype instanceof n.RelationalModel){if(s.prototype instanceof n.RelationalModel){if(this instanceof n.HasMany&&this.reverseRelation.type===n.HasMany)return o&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(e&&e._relations.length){var u=t.any(e._relations,function(e){var t=this.reverseRelation.key&&e.reverseRelation.key;return e.relatedModel===s&&e.key===r&&(!t||this.reverseRelation.key===e.reverseRelation.key)},this);if(u)return o&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,e,r,s,this.reverseRelation.key),!1}return!0}return o&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,s),!1}return o&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",this,e),!1},setRelated:function(e,n){this.related=e,this.instance.acquire(),this.instance.set(this.key,e,t.defaults(n||{},{silent:!0})),this.instance.release()},_isReverseRelation:function(e){return e.instance instanceof this.relatedModel&&this.reverseRelation.key===e.key&&this.key===e.reverseRelation.key?!0:!1},getReverseRelations:function(e){var n=[],r=t.isUndefined(e)?this.related&&(this.related.models||[this.related]):[e];return t.each(r,function(e){t.each(e.getRelations(),function(e){this._isReverseRelation(e)&&n.push(e)},this)},this),n},sanitizeOptions:function(e){return e=e?t.clone(e):{},e.silent&&(e.silentChange=!0,delete e.silent),e},unsanitizeOptions:function(e){return e=e?t.clone(e):{},e.silentChange&&(e.silent=!0,delete e.silentChange),e},destroy:function(){n.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection),n.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",this._relatedModelRemoved),t.each(this.getReverseRelations(),function(e){e.removeRelated(this.instance)},this)}}),n.HasOne=n.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){t.bindAll(this,"onChange"),this.instance.bind("relational:change:"+this.key,this.onChange);var e=this.findRelated({silent:!0});this.setRelated(e),t.each(this.getReverseRelations(),function(e){e.addRelated(this.instance)},this)},findRelated:function(e){var t=this.keyContents,n=null;if(t instanceof this.relatedModel)n=t;else if(t||t===0)n=this.relatedModel.findOrCreate(t,{create:this.options.createModels});return n},onChange:function(e,r,i){if(this.isLocked())return;this.acquire(),i=this.sanitizeOptions(i);var s=t.isUndefined(i._related),o=s?this.related:i._related;if(s){this.keyContents=r;if(r instanceof this.relatedModel)this.related=r;else if(r){var u=this.findRelated(i);this.setRelated(u)}else this.setRelated(null)}o&&this.related!==o&&t.each(this.getReverseRelations(o),function(e){e.removeRelated(this.instance,i)},this),t.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,i)},this);if(!i.silentChange&&this.related!==o){var a=this;n.Relational.eventQueue.add(function(){a.instance.trigger("update:"+a.key,a.instance,a.related,i)})}this.release()},tryAddRelated:function(e,r){if(this.related)return;r=this.sanitizeOptions(r);var i=this.keyContents;if(i||i===0){var s=n.Relational.store.resolveIdForItem(this.relatedModel,i);!t.isNull(s)&&e.id===s&&this.addRelated(e,r)}},addRelated:function(e,t){if(e!==this.related){var n=this.related||null;this.setRelated(e),this.onChange(this.instance,e,{_related:n})}},removeRelated:function(e,t){if(!this.related)return;if(e===this.related){var n=this.related||null;this.setRelated(null),this.onChange(this.instance,e,{_related:n})}}}),n.HasMany=n.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:n.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(){t.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset"),this.instance.bind("relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,t.isString(this.collectionType)&&(this.collectionType=n.Relational.store.getObjectByName(this.collectionType));if(!this.collectionType.prototype instanceof n.Collection)throw new Error("collectionType must inherit from Backbone.Collection");this.keyContents instanceof n.Collection?this.setRelated(this._prepareCollection(this.keyContents)):this.setRelated(this._prepareCollection()),this.findRelated({silent:!0})},_getCollectionOptions:function(){return t.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions},_prepareCollection:function(e){this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset);if(!e||!(e instanceof n.Collection))e=new this.collectionType([],this._getCollectionOptions());e.model=this.relatedModel;if(this.options.collectionKey){var t=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;e[t]&&e[t]!==this.instance?n.Relational.showWarnings&&typeof console!="undefined"&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,t,this.options.collectionKey):t&&(e[t]=this.instance)}return e.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset),e},findRelated:function(e){if(this.keyContents){var r=[];this.keyContents instanceof n.Collection?r=this.keyContents.models:(this.keyContents=t.isArray(this.keyContents)?this.keyContents:[this.keyContents],t.each(this.keyContents,function(e){var t=null;if(e instanceof this.relatedModel)t=e;else if(e||e===0)t=this.relatedModel.findOrCreate(e,{create:this.options.createModels});t&&!this.related.getByCid(t)&&!this.related.get(t)&&r.push(t)},this)),r.length&&(e=this.unsanitizeOptions(e),this.related.add(r,e))}},onChange:function(e,r,i){i=this.sanitizeOptions(i),this.keyContents=r,t.each(this.getReverseRelations(),function(e){e.removeRelated(this.instance,i)},this);if(r instanceof n.Collection)this._prepareCollection(r),this.related=r;else{var s;this.related instanceof n.Collection?(s=this.related,s.remove(s.models)):s=this._prepareCollection(),this.setRelated(s),this.findRelated(i)}t.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,i)},this);var o=this;n.Relational.eventQueue.add(function(){!i.silentChange&&o.instance.trigger("update:"+o.key,o.instance,o.related,i)})},tryAddRelated:function(e,r){r=this.sanitizeOptions(r);if(!this.related.getByCid(e)&&!this.related.get(e)){var i=t.any(this.keyContents,function(r){var i=n.Relational.store.resolveIdForItem(this.relatedModel,r);return!t.isNull(i)&&i===e.id},this);i&&this.related.add(e,r)}},handleAddition:function(e,r,i){if(!(e instanceof n.Model))return;i=this.sanitizeOptions(i),t.each(this.getReverseRelations(e),function(e){e.addRelated(this.instance,i)},this);var s=this;n.Relational.eventQueue.add(function(){!i.silentChange&&s.instance.trigger("add:"+s.key,e,s.related,i)})},handleRemoval:function(e,r,i){if(!(e instanceof n.Model))return;i=this.sanitizeOptions(i),t.each(this.getReverseRelations(e),function(e){e.removeRelated(this.instance,i)},this);var s=this;n.Relational.eventQueue.add(function(){!i.silentChange&&s.instance.trigger("remove:"+s.key,e,s.related,i)})},handleReset:function(e,t){t=this.sanitizeOptions(t);var r=this;n.Relational.eventQueue.add(function(){!t.silentChange&&r.instance.trigger("reset:"+r.key,r.related,t)})},addRelated:function(e,t){var n=this;t=this.unsanitizeOptions(t),e.queue(function(){n.related&&!n.related.getByCid(e)&&!n.related.get(e)&&n.related.add(e,t)})},removeRelated:function(e,t){t=this.unsanitizeOptions(t),(this.related.getByCid(e)||this.related.get(e))&&this.related.remove(e,t)}}),n.RelationalModel=n.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(e,r){var i=this;if(r&&r.collection){this._deferProcessing=!0;var s=function(e){e===i&&(i._deferProcessing=!1,i.processQueue(),r.collection.unbind("relational:add",s))};r.collection.bind("relational:add",s),t.defer(function(){s(i)})}this._queue=new n.BlockingQueue,this._queue.block(),n.Relational.eventQueue.block(),n.Model.apply(this,arguments),n.Relational.eventQueue.unblock()},trigger:function(e){if(e.length>5&&"change"===e.substr(0,6)){var t=this,r=arguments;n.Relational.eventQueue.add(function(){n.Model.prototype.trigger.apply(t,r)})}else n.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire(),this._relations=[],t.each(this.relations,function(e){var r=t.isString(e.type)?n[e.type]||n.Relational.store.getObjectByName(e.type):e.type;r&&r.prototype instanceof n.Relation?new r(this,e):n.Relational.showWarnings&&typeof console!="undefined"&&console.warn("Relation=%o; missing or invalid type!",e)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(e){this._isInitialized&&!this.isLocked()&&t.each(this._relations,function(t){var n=this.attributes[t.keySource]||this.attributes[t.key];t.related!==n&&this.trigger("relational:change:"+t.key,this,n,e||{})},this)},queue:function(e){this._queue.add(e)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(e){return t.detect(this._relations,function(t){if(t.key===e)return!0},this)},getRelations:function(){return this._relations},fetchRelated:function(e,r,i){r||(r={});var s,o=[],u=this.getRelation(e),a=u&&u.keyContents,f=a&&t.select(t.isArray(a)?a:[a],function(e){var r=n.Relational.store.resolveIdForItem(u.relatedModel,e);return!t.isNull(r)&&(i||!n.Relational.store.find(u.relatedModel,r))},this);if(f&&f.length){var l=t.map(f,function(e){var n;if(t.isObject(e))n=u.relatedModel.build(e);else{var r={};r[u.relatedModel.prototype.idAttribute]=e,n=u.relatedModel.build(r)}return n},this);u.related instanceof n.Collection&&t.isFunction(u.related.url)&&(s=u.related.url(l));if(s&&s!==u.related.url()){var c=t.defaults({error:function(){var e=arguments;t.each(l,function(t){t.trigger("destroy",t,t.collection,r),r.error&&r.error.apply(t,e)})},url:s},r,{add:!0});o=[u.related.fetch(c)]}else o=t.map(l,function(e){var n=t.defaults({error:function(){e.trigger("destroy",e,e.collection,r),r.error&&r.error.apply(e,arguments)}},r);return e.fetch(n)},this)}return o},set:function(e,r,i){n.Relational.eventQueue.block();var s;t.isObject(e)||e==null?(s=e,i=r):(s={},s[e]=r);var o=n.Model.prototype.set.apply(this,arguments);return!this._isInitialized&&!this.isLocked()?(this.constructor.initializeModelHierarchy(),n.Relational.store.register(this),this.initializeRelations()):s&&this.idAttribute in s&&n.Relational.store.update(this),s&&this.updateRelations(i),n.Relational.eventQueue.unblock(),o},unset:function(e,t){n.Relational.eventQueue.block();var r=n.Model.prototype.unset.apply(this,arguments);return this.updateRelations(t),n.Relational.eventQueue.unblock(),r},clear:function(e){n.Relational.eventQueue.block();var t=n.Model.prototype.clear.apply(this,arguments);return this.updateRelations(e),n.Relational.eventQueue.unblock(),t},change:function(e){var t=this,r=arguments;n.Relational.eventQueue.add(function(){n.Model.prototype.change.apply(t,r)})},clone:function(){var e=t.clone(this.attributes);return t.isUndefined(e[this.idAttribute])||(e[this.idAttribute]=null),t.each(this.getRelations(),function(t){delete e[t.key]}),new this.constructor(e)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var e=n.Model.prototype.toJSON.call(this);return this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in e)&&(e[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),t.each(this._relations,function(r){var i=e[r.key];if(r.options.includeInJSON===!0)i&&t.isFunction(i.toJSON)?e[r.keyDestination]=i.toJSON():e[r.keyDestination]=null;else if(t.isString(r.options.includeInJSON))i instanceof n.Collection?e[r.keyDestination]=i.pluck(r.options.includeInJSON):i instanceof n.Model?e[r.keyDestination]=i.get(r.options.includeInJSON):e[r.keyDestination]=null;else if(t.isArray(r.options.includeInJSON))if(i instanceof n.Collection){var s=[];i.each(function(e){var n={};t.each(r.options.includeInJSON,function(t){n[t]=e.get(t)}),s.push(n)}),e[r.keyDestination]=s}else if(i instanceof n.Model){var s={};t.each(r.options.includeInJSON,function(e){s[e]=i.get(e)}),e[r.keyDestination]=s}else e[r.keyDestination]=null;else delete e[r.key];r.keyDestination!==r.key&&delete e[r.key]}),this.release(),e}},{setup:function(e){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?n.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,t.each(this.prototype.relations,function(e){e.model||(e.model=this);if(e.reverseRelation&&e.model===this){var r=!0;if(t.isString(e.relatedModel)){var i=n.Relational.store.getObjectByName(e.relatedModel);r=i&&i.prototype instanceof n.RelationalModel}var s=t.isString(e.type)?n[e.type]||n.Relational.store.getObjectByName(e.type):e.type;r&&s&&s.prototype instanceof n.Relation&&new s(null,e)}},this),this},build:function(e,t){var n=this;this.initializeModelHierarchy();if(this._subModels&&this.prototype.subModelTypeAttribute in e){var r=e[this.prototype.subModelTypeAttribute],i=this._subModels[r];i&&(n=i)}return new n(e,t)},initializeModelHierarchy:function(){if(t.isUndefined(this._superModel)||t.isNull(this._superModel)){n.Relational.store.setupSuperModel(this);if(this._superModel){if(this._superModel.prototype.relations){var e=t.any(this.prototype.relations,function(e){return e.model&&e.model!==this},this);e||(this.prototype.relations=this._superModel.prototype.relations.concat(this.prototype.relations))}}else this._superModel=!1}this.prototype.subModelTypes&&t.keys(this.prototype.subModelTypes).length!==t.keys(this._subModels).length&&t.each(this.prototype.subModelTypes,function(e){var t=n.Relational.store.getObjectByName(e);t&&t.initializeModelHierarchy()})},findOrCreate:function(e,r){var i=n.Relational.store.find(this,e);if(t.isObject(e))if(i)i.set(i.parse?i.parse(e):e,r);else if(!r||r&&r.create!==!1)i=this.build(e,r);return i}}),t.extend(n.RelationalModel.prototype,n.Semaphore),n.Collection.prototype.__prepareModel=n.Collection.prototype._prepareModel,n.Collection.prototype._prepareModel=function(e,t){t||(t={});if(e instanceof n.Model)e.collection||(e.collection=this);else{var r=e;t.collection=this,typeof this.model.findOrCreate!="undefined"?e=this.model.findOrCreate(r,t):e=new this.model(r,t),e._validate(e.attributes,t)||(e=!1)}return e};var i=n.Collection.prototype.__add=n.Collection.prototype.add;n.Collection.prototype.add=function(e,r){r||(r={}),t.isArray(e)||(e=[e]);var s=[];return t.each(e,function(e){e instanceof n.Model||(e=n.Collection.prototype._prepareModel.call(this,e,r)),e instanceof n.Model&&!this.get(e)&&!this.getByCid(e)&&s.push(e)},this),s.length&&(i.call(this,s,r),t.each(s,function(e){this.trigger("relational:add",e,this,r)},this)),this};var s=n.Collection.prototype.__remove=n.Collection.prototype.remove;n.Collection.prototype.remove=function(e,r){return r||(r={}),t.isArray(e)?e=e.slice(0):e=[e],t.each(e,function(e){e=this.getByCid(e)||this.get(e),e instanceof n.Model&&(s.call(this,e,r),this.trigger("relational:remove",e,this,r))},this),this};var o=n.Collection.prototype.__reset=n.Collection.prototype.reset;n.Collection.prototype.reset=function(e,t){return o.call(this,e,t),this.trigger("relational:reset",this,t),this};var u=n.Collection.prototype.__sort=n.Collection.prototype.sort;n.Collection.prototype.sort=function(e){return u.call(this,e),this.trigger("relational:reset",this,e),this};var a=n.Collection.prototype.__trigger=n.Collection.prototype.trigger;n.Collection.prototype.trigger=function(e){if(e==="add"||e==="remove"||e==="reset"){var r=this,i=arguments;e==="add"&&(i=t.toArray(i),t.isObject(i[3])&&(i[3]=t.clone(i[3]))),n.Relational.eventQueue.add(function(){a.apply(r,i)})}else a.apply(this,arguments);return this},n.RelationalModel.extend=function(e,t){var r=n.Model.extend.apply(this,arguments);return r.setup(this),r};var f=n.Collection.prototype.fetch;n.Collection.prototype.fetch=function(e){e||(e={}),t.defaults(e,{add:!0}),e.reset&&this.reset();var n=this,r=f.call(this,e);return r.done(function(){e.silent||n.trigger("fetch",n,e)}),r}})();


/* public/javascripts/backbone/backbone-subset.js @ 1370554951 */
/**
 * @class  Backbone.Subset
 * @name   Backbone Subset collections
 * @desc   Implements a collection that is a subset other Backbone Collections
*/
(function(){function t(e,t){return _.difference(_.union(e,t),_.intersection(e,t))}var e={};Backbone.Subset=function(t,n){var r;n=n||{},n.parent&&(this.parent=n.parent);if(!(r=_.result(this,"parent")))throw new Error("Can't create a subset without a parent collection");this.model=r.model,this.comparator=this.comparator||n.comparator||r.comparator,this.liveupdate_keys=this.liveupdate_keys||n.liveupdate_keys||"none",_.bindAll(this,"_onModelEvent","_unbindModelEvents","_proxyAdd","_proxyReset","_proxyRemove","_proxyChange"),r.bind("add",this._proxyAdd),r.bind("remove",this._proxyRemove),r.bind("reset",this._proxyReset),r.bind("all",this._proxyChange),this.beforeInitialize&&this.beforeInitialize.apply(this,arguments),n.no_reset?this._resetSubset({silent:!0}):(this._reset(),this.reset(t||r.models,{silent:!0})),this.initialize.apply(this,arguments)},e.exclusiveSubset=function(){return!1},e.reset=function(e,n){var r=_.result(this,"parent"),i=_.clone(r.models),s,o=this.pluck("id");return e=e||[],e=_.isArray(e)?e:[e],n=n||{},i=_.reject(i,function(e){return _.include(o,e.id)}),_.each(e,function(e){i.push(e)}),s=t(o,_.pluck(e,"id")),r.reset(i,_.extend({silent:!0},n)),this.exclusiveSubset()?r.trigger("reset",this,_.extend({model_ids:s,exclusive_collection:this},n)):r.trigger("reset",this,_.extend({model_ids:s},n)),this},e.recalculate=function(e){e=e||{};var t,n=this;return t=_.result(this,"parent").reduce(function(e,t){return n._updateModelMembership(t,{silent:!0})||e},!1),t&&!e.silent&&this.trigger("reset",this,e),this},e._resetSubset=function(e){return e=e||{},this.each(this._unbindModelEvents),this._reset(),_.result(this,"parent").each(function(e){this._addToSubset(e,{silent:!0})},this),e.silent||this.trigger("reset",this,e),this},e.add=function(e,t){return this.exclusiveSubset()&&(t=_.extend(t,{exclusive_collection:this})),_.result(this,"parent").add(e,t)},e._addToSubset=function(e,t){if(this.sieve(e))return Backbone.Collection.prototype.add.call(this,e,t)},e.remove=function(e,t){return this.exclusiveSubset()&&(t=_.extend(t,{exclusive_collection:this})),_.result(this,"parent").remove(e,t)},e._removeFromSubset=function(e,t){return Backbone.Collection.prototype.remove.call(this,e,t)},e._prepareModel=function(e,t){var n=_.result(this,"parent");if(e instanceof Backbone.Model)e.collection||(e.collection=n);else{var r=e;e=new this.model(r,{collection:n}),e.validate&&!e._performValidation(e.attributes,t)&&(e=!1)}return e=this.sieve(e)?e:!1,e},e._proxyAdd=function(e,t,n){n=n||{};if(n.exclusive_collection&&n.exclusive_collection!==this)return;t!==this&&this.sieve(e)&&!n.noproxy&&this._addToSubset(e,n)},e._proxyRemove=function(e,t,n){n=n||{};if(n.exclusive_collection&&n.exclusive_collection!==this)return;t!==this&&this.sieve(e)&&!n.noproxy&&this._removeFromSubset(e,n)},e._proxyChange=function(e,t,n){n!==this&&e==="change"&&this.liveupdate_keys==="all"?this._updateModelMembership(t):e.slice(0,7)==="change:"&&_.isArray(this.liveupdate_keys)&&_.include(this.liveupdate_keys,e.slice(7))&&this._updateModelMembership(t)},e._proxyReset=function(e,t){function i(){return _.filter(t.model_ids,function(e){var t=r.parent().get(e)||r.get(e);return t&&r.sieve(t)})}t=t||{};var n,r=this;if(t.exclusive_collection&&t.exclusive_collection!==this)return;(!t||!t.noproxy)&&(!t.model_ids||this===e||i().length)&&this._resetSubset(_.extend(_.clone(t),{proxied:!0}))},e._updateModelMembership=function(e,t){var n=!e.id,r=this._byCid[e.cid]||n&&this._byId[e.id];if(this.sieve(e)){if(!r)return this._addToSubset(e,t),!0}else if(r)return this._removeFromSubset(e,t),!0;return!1},e._unbindModelEvents=function(e){e.unbind("all",this._onModelEvent)},_.extend(Backbone.Subset.prototype,Backbone.Collection.prototype,e),Backbone.Subset.extend=Backbone.Collection.extend})();


/* public/javascripts/moment.js @ 1370554951 */
// moment.js
// version : 1.7.2
// author : Tim Wood
// license : MIT
// momentjs.com
(function(e){function O(e,t,n,r){var i=n.lang();return i[e].call?i[e](n,r):i[e][t]}function M(e,t){return function(n){return B(e.call(this,n),t)}}function _(e){return function(t){var n=e.call(this,t);return n+this.lang().ordinal(n)}}function D(e,t,n){this._d=e,this._isUTC=!!t,this._a=e._a||null,this._lang=n||!1}function P(e){var t=this._data={},n=e.years||e.y||0,r=e.months||e.M||0,i=e.weeks||e.w||0,s=e.days||e.d||0,o=e.hours||e.h||0,u=e.minutes||e.m||0,a=e.seconds||e.s||0,f=e.milliseconds||e.ms||0;this._milliseconds=f+a*1e3+u*6e4+o*36e5,this._days=s+i*7,this._months=r+n*12,t.milliseconds=f%1e3,a+=H(f/1e3),t.seconds=a%60,u+=H(a/60),t.minutes=u%60,o+=H(u/60),t.hours=o%24,s+=H(o/24),s+=i*7,t.days=s%30,r+=H(s/30),t.months=r%12,n+=H(r/12),t.years=n,this._lang=!1}function H(e){return e<0?Math.ceil(e):Math.floor(e)}function B(e,t){var n=e+"";while(n.length<t)n="0"+n;return n}function j(e,t,n){var r=t._milliseconds,i=t._days,s=t._months,o;r&&e._d.setTime(+e+r*n),i&&e.date(e.date()+i*n),s&&(o=e.date(),e.date(1).month(e.month()+s*n).date(Math.min(o,e.daysInMonth())))}function F(e){return Object.prototype.toString.call(e)==="[object Array]"}function I(e,t){var n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),i=0,s;for(s=0;s<n;s++)~~e[s]!==~~t[s]&&i++;return i+r}function q(e,t,n,r){var i,s,o=[];for(i=0;i<7;i++)o[i]=e[i]=e[i]==null?i===2?1:0:e[i];return e[7]=o[7]=t,e[8]!=null&&(o[8]=e[8]),e[3]+=n||0,e[4]+=r||0,s=new Date(0),t?(s.setUTCFullYear(e[0],e[1],e[2]),s.setUTCHours(e[3],e[4],e[5],e[6])):(s.setFullYear(e[0],e[1],e[2]),s.setHours(e[3],e[4],e[5],e[6])),s._a=o,s}function R(e,n){var r,i,o=[];!n&&u&&(n=require("./lang/"+e));for(r=0;r<a.length;r++)n[a[r]]=n[a[r]]||s.en[a[r]];for(r=0;r<12;r++)i=t([2e3,r]),o[r]=new RegExp("^"+(n.months[r]||n.months(i,""))+"|^"+(n.monthsShort[r]||n.monthsShort(i,"")).replace(".",""),"i");return n.monthsParse=n.monthsParse||o,s[e]=n,n}function U(e){var n=typeof e=="string"&&e||e&&e._lang||null;return n?s[n]||R(n):t}function z(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t=e.match(l),n,r;for(n=0,r=t.length;n<r;n++)A[t[n]]?t[n]=A[t[n]]:t[n]=z(t[n]);return function(i){var s="";for(n=0;n<r;n++)s+=typeof t[n].call=="function"?t[n].call(i,e):t[n];return s}}function X(e,t){function r(t){return e.lang().longDateFormat[t]||t}var n=5;while(n--&&c.test(t))t=t.replace(c,r);return C[t]||(C[t]=W(t)),C[t](e)}function V(e){switch(e){case"DDDD":return v;case"YYYY":return m;case"S":case"SS":case"SSS":case"DDD":return d;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return g;case"Z":case"ZZ":return y;case"T":return b;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return p;default:return new RegExp(e.replace("\\",""))}}function $(e,t,n,r){var i,s;switch(e){case"M":case"MM":n[1]=t==null?0:~~t-1;break;case"MMM":case"MMMM":for(i=0;i<12;i++)if(U().monthsParse[i].test(t)){n[1]=i,s=!0;break}s||(n[8]=!1);break;case"D":case"DD":case"DDD":case"DDDD":t!=null&&(n[2]=~~t);break;case"YY":n[0]=~~t+(~~t>70?1900:2e3);break;case"YYYY":n[0]=~~Math.abs(t);break;case"a":case"A":r.isPm=(t+"").toLowerCase()==="pm";break;case"H":case"HH":case"h":case"hh":n[3]=~~t;break;case"m":case"mm":n[4]=~~t;break;case"s":case"ss":n[5]=~~t;break;case"S":case"SS":case"SSS":n[6]=~~(("0."+t)*1e3);break;case"Z":case"ZZ":r.isUTC=!0,i=(t+"").match(x),i&&i[1]&&(r.tzh=~~i[1]),i&&i[2]&&(r.tzm=~~i[2]),i&&i[0]==="+"&&(r.tzh=-r.tzh,r.tzm=-r.tzm)}t==null&&(n[8]=!1)}function J(e,t){var n=[0,0,1,0,0,0,0],r={tzh:0,tzm:0},i=t.match(l),s,o;for(s=0;s<i.length;s++)o=(V(i[s]).exec(e)||[])[0],o&&(e=e.slice(e.indexOf(o)+o.length)),A[i[s]]&&$(i[s],o,n,r);return r.isPm&&n[3]<12&&(n[3]+=12),r.isPm===!1&&n[3]===12&&(n[3]=0),q(n,r.isUTC,r.tzh,r.tzm)}function K(e,t){var n,r=e.match(h)||[],i,s=99,o,u,a;for(o=0;o<t.length;o++)u=J(e,t[o]),i=X(new D(u),t[o]).match(h)||[],a=I(r,i),a<s&&(s=a,n=u);return n}function Q(e){var t="YYYY-MM-DDT",n;if(w.exec(e)){for(n=0;n<4;n++)if(S[n][1].exec(e)){t+=S[n][0];break}return y.exec(e)?J(e,t+" Z"):J(e,t)}return new Date(e)}function G(e,t,n,r,i){var s=i.relativeTime[e];return typeof s=="function"?s(t||1,!!n,e,r):s.replace(/%d/i,t||1)}function Y(e,t,n){var i=r(Math.abs(e)/1e3),s=r(i/60),o=r(s/60),u=r(o/24),a=r(u/365),f=i<45&&["s",i]||s===1&&["m"]||s<45&&["mm",s]||o===1&&["h"]||o<22&&["hh",o]||u===1&&["d"]||u<=25&&["dd",u]||u<=45&&["M"]||u<345&&["MM",r(u/30)]||a===1&&["y"]||["yy",a];return f[2]=t,f[3]=e>0,f[4]=n,G.apply({},f)}function Z(e,n){t.fn[e]=function(e){var t=this._isUTC?"UTC":"";return e!=null?(this._d["set"+t+n](e),this):this._d["get"+t+n]()}}function et(e){t.duration.fn[e]=function(){return this._data[e]}}function tt(e,n){t.duration.fn["as"+e]=function(){return+this/n}}var t,n="1.7.2",r=Math.round,i,s={},o="en",u=typeof module!="undefined"&&module.exports,a="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),f=/^\/?Date\((\-?\d+)/i,l=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|.)/g,c=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?)/g,h=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,p=/\d\d?/,d=/\d{1,3}/,v=/\d{3}/,m=/\d{1,4}/,g=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,y=/Z|[\+\-]\d\d:?\d\d/i,b=/T/i,w=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,E="YYYY-MM-DDTHH:mm:ssZ",S=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],x=/([\+\-]|\d\d)/gi,T="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),N={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},C={},k="DDD w M D d".split(" "),L="M D H h m s w".split(" "),A={M:function(){return this.month()+1},MMM:function(e){return O("monthsShort",this.month(),this,e)},MMMM:function(e){return O("months",this.month(),this,e)},D:function(){return this.date()},DDD:function(){var e=new Date(this.year(),this.month(),this.date()),t=new Date(this.year(),0,1);return~~((e-t)/864e5+1.5)},d:function(){return this.day()},dd:function(e){return O("weekdaysMin",this.day(),this,e)},ddd:function(e){return O("weekdaysShort",this.day(),this,e)},dddd:function(e){return O("weekdays",this.day(),this,e)},w:function(){var e=new Date(this.year(),this.month(),this.date()-this.day()+5),t=new Date(e.getFullYear(),0,4);return~~((e-t)/864e5/7+1.5)},YY:function(){return B(this.year()%100,2)},YYYY:function(){return B(this.year(),4)},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return B(~~(this.milliseconds()/10),2)},SSS:function(){return B(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+B(~~(e/60),2)+":"+B(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+B(~~(10*e/6),4)}};while(k.length)i=k.pop(),A[i+"o"]=_(A[i]);while(L.length)i=L.pop(),A[i+i]=M(A[i],2);A.DDDD=M(A.DDD,3),t=function(n,r){if(n===null||n==="")return null;var i,s;return t.isMoment(n)?new D(new Date(+n._d),n._isUTC,n._lang):(r?F(r)?i=K(n,r):i=J(n,r):(s=f.exec(n),i=n===e?new Date:s?new Date(+s[1]):n instanceof Date?n:F(n)?q(n):typeof n=="string"?Q(n):new Date(n)),new D(i))},t.utc=function(e,n){return F(e)?new D(q(e,!0),!0):(typeof e=="string"&&!y.exec(e)&&(e+=" +0000",n&&(n+=" Z")),t(e,n).utc())},t.unix=function(e){return t(e*1e3)},t.duration=function(e,n){var r=t.isDuration(e),i=typeof e=="number",s=r?e._data:i?{}:e,o;return i&&(n?s[n]=e:s.milliseconds=e),o=new P(s),r&&(o._lang=e._lang),o},t.humanizeDuration=function(e,n,r){return t.duration(e,n===!0?null:n).humanize(n===!0?!0:r)},t.version=n,t.defaultFormat=E,t.lang=function(e,n){var r;if(!e)return o;(n||!s[e])&&R(e,n);if(s[e]){for(r=0;r<a.length;r++)t[a[r]]=s[e][a[r]];t.monthsParse=s[e].monthsParse,o=e}},t.langData=U,t.isMoment=function(e){return e instanceof D},t.isDuration=function(e){return e instanceof P},t.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"}}),t.fn=D.prototype={clone:function(){return t(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return this._d.toString()},toDate:function(){return this._d},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds(),!!this._isUTC]},isValid:function(){return this._a?this._a[8]!=null?!!this._a[8]:!I(this._a,(this._a[7]?t.utc(this._a):t(this._a)).toArray()):!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(e){return X(this,e?e:t.defaultFormat)},add:function(e,n){var r=n?t.duration(+n,e):t.duration(e);return j(this,r,1),this},subtract:function(e,n){var r=n?t.duration(+n,e):t.duration(e);return j(this,r,-1),this},diff:function(e,n,i){var s=this._isUTC?t(e).utc():t(e).local(),o=(this.zone()-s.zone())*6e4,u=this._d-s._d-o,a=this.year()-s.year(),f=this.month()-s.month(),l=this.date()-s.date(),c;return n==="months"?c=a*12+f+l/30:n==="years"?c=a+(f+l/30)/12:c=n==="seconds"?u/1e3:n==="minutes"?u/6e4:n==="hours"?u/36e5:n==="days"?u/864e5:n==="weeks"?u/6048e5:u,i?c:r(c)},from:function(e,n){return t.duration(this.diff(e)).lang(this._lang).humanize(!n)},fromNow:function(e){return this.from(t(),e)},calendar:function(){var e=this.diff(t().sod(),"days",!0),n=this.lang().calendar,r=n.sameElse,i=e<-6?r:e<-1?n.lastWeek:e<0?n.lastDay:e<1?n.sameDay:e<2?n.nextDay:e<7?n.nextWeek:r;return this.format(typeof i=="function"?i.apply(this):i)},isLeapYear:function(){var e=this.year();return e%4===0&&e%100!==0||e%400===0},isDST:function(){return this.zone()<t([this.year()]).zone()||this.zone()<t([this.year(),5]).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return e==null?t:this.add({d:e-t})},startOf:function(e){switch(e.replace(/s$/,"")){case"year":this.month(0);case"month":this.date(1);case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return this},endOf:function(e){return this.startOf(e).add(e.replace(/s?$/,"s"),1).subtract("ms",1)},sod:function(){return this.clone().startOf("day")},eod:function(){return this.clone().endOf("day")},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return t.utc([this.year(),this.month()+1,0]).date()},lang:function(t){return t===e?U(this):(this._lang=t,this)}};for(i=0;i<T.length;i++)Z(T[i].toLowerCase(),T[i]);Z("year","FullYear"),t.duration.fn=P.prototype={weeks:function(){return H(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months*2592e6},humanize:function(e){var t=+this,n=this.lang().relativeTime,r=Y(t,!e,this.lang()),i=t<=0?n.past:n.future;return e&&(typeof i=="function"?r=i(r):r=i.replace(/%s/i,r)),r},lang:t.fn.lang};for(i in N)N.hasOwnProperty(i)&&(tt(i,N[i]),et(i.toLowerCase()));tt("Weeks",6048e5),u&&(module.exports=t),typeof ender=="undefined"&&(this.moment=t),typeof define=="function"&&define.amd&&define("moment",[],function(){return t})}).call(this);


/* public/javascripts/jquery.jeditable.js @ 1370554951 */
/*
 * Jeditable - jQuery in place edit plugin
 *
 * Copyright (c) 2006-2009 Mika Tuupola, Dylan Verheul
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 *   http://www.appelsiini.net/projects/jeditable
 *
 * Based on editable by Dylan Verheul <dylan_at_dyve.net>:
 *    http://www.dyve.net/jquery/?editable
 *
 */
/**
  * Version 1.7.1
  *
  * ** means there is basic unit tests for this parameter.
  *
  * @name  Jeditable
  * @type  jQuery
  * @param String  target             (POST) URL or function to send edited content to **
  * @param Hash    options            additional options
  * @param String  options[method]    method to use to send edited content (POST or PUT) **
  * @param Function options[callback] Function to run after submitting edited content **
  * @param String  options[name]      POST parameter name of edited content
  * @param String  options[id]        POST parameter name of edited div id
  * @param Hash    options[submitdata] Extra parameters to send when submitting edited content.
  * @param String  options[type]      text, textarea or select (or any 3rd party input type) **
  * @param Integer options[rows]      number of rows if using textarea **
  * @param Integer options[cols]      number of columns if using textarea **
  * @param Mixed   options[height]    'auto', 'none' or height in pixels **
  * @param Mixed   options[width]     'auto', 'none' or width in pixels **
  * @param String  options[loadurl]   URL to fetch input content before editing **
  * @param String  options[loadtype]  Request type for load url. Should be GET or POST.
  * @param String  options[loadtext]  Text to display while loading external content.
  * @param Mixed   options[loaddata]  Extra parameters to pass when fetching content before editing.
  * @param Mixed   options[data]      Or content given as paramameter. String or function.**
  * @param String  options[indicator] indicator html to show when saving
  * @param String  options[tooltip]   optional tooltip text via title attribute **
  * @param String  options[event]     jQuery event such as 'click' of 'dblclick' **
  * @param String  options[submit]    submit button value, empty means no button **
  * @param String  options[cancel]    cancel button value, empty means no button **
  * @param String  options[cssclass]  CSS class to apply to input form. 'inherit' to copy from parent. **
  * @param String  options[style]     Style to apply to input form 'inherit' to copy from parent. **
  * @param String  options[select]    true or false, when true text is highlighted ??
  * @param String  options[placeholder] Placeholder text or html to insert when element is empty. **
  * @param String  options[onblur]    'cancel', 'submit', 'ignore' or function ??
  *
  * @param Function options[onsubmit] function(settings, original) { ... } called before submit
  * @param Function options[onreset]  function(settings, original) { ... } called before reset
  * @param Function options[onerror]  function(settings, original, xhr) { ... } called on error
  *
  * @param Hash    options[ajaxoptions]  jQuery Ajax options. See docs.jquery.com.
  *
  */
(function($){$.fn.editable=function(e,t){if("disable"==e){$(this).data("disabled.editable",!0);return}if("enable"==e){$(this).data("disabled.editable",!1);return}if("destroy"==e){$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");return}var n=$.extend({},$.fn.editable.defaults,{target:e},t),r=$.editable.types[n.type].plugin||function(){},i=$.editable.types[n.type].submit||function(){},s=$.editable.types[n.type].buttons||$.editable.types.defaults.buttons,o=$.editable.types[n.type].content||$.editable.types.defaults.content,u=$.editable.types[n.type].element||$.editable.types.defaults.element,a=$.editable.types[n.type].reset||$.editable.types.defaults.reset,f=n.callback||function(){},l=n.onedit||function(){},c=n.onsubmit||function(){},h=n.onreset||function(){},p=n.onerror||a;return n.tooltip&&$(this).attr("title",n.tooltip),n.autowidth="auto"==n.width,n.autoheight="auto"==n.height,this.each(function(){var e=this,t=$(e).width(),d=$(e).height();$(this).data("event.editable",n.event),$.trim($(this).html())||$(this).html(n.placeholder),$(this).bind(n.event,function(h){if(!0===$(this).data("disabled.editable"))return;if(e.editing)return;if(!1===l.apply(this,[n,e]))return;h.preventDefault(),h.stopPropagation(),n.tooltip&&$(e).removeAttr("title"),0==$(e).width()?(n.width=t,n.height=d):(n.width!="none"&&(n.width=n.autowidth?$(e).width():n.width),n.height!="none"&&(n.height=n.autoheight?$(e).height():n.height)),$(this).html().toLowerCase().replace(/(;|")/g,"")==n.placeholder.toLowerCase().replace(/(;|")/g,"")&&$(this).html(""),e.editing=!0,e.revert=$(e).html(),$(e).html("");var v=$("<form />");n.cssclass&&("inherit"==n.cssclass?v.attr("class",$(e).attr("class")):v.attr("class",n.cssclass)),n.style&&("inherit"==n.style?(v.attr("style",$(e).attr("style")),v.css("display",$(e).css("display"))):v.attr("style",n.style));var m=u.apply(v,[n,e]),g;if(n.loadurl){var y=setTimeout(function(){m.disabled=!0,o.apply(v,[n.loadtext,n,e])},100),b={};b[n.id]=e.id,$.isFunction(n.loaddata)?$.extend(b,n.loaddata.apply(e,[e.revert,n])):$.extend(b,n.loaddata),$.ajax({type:n.loadtype,url:n.loadurl,data:b,async:!1,success:function(e){window.clearTimeout(y),g=e,m.disabled=!1}})}else n.data?(g=n.data,$.isFunction(n.data)&&(g=n.data.apply(e,[e.revert,n]))):g=e.revert;o.apply(v,[g,n,e]),m.attr("name",n.name),s.apply(v,[n,e]),$(e).append(v),r.apply(v,[n,e]),$(":input:visible:enabled:first",v).focus(),n.select&&m.select(),m.keydown(function(t){t.keyCode==27&&(t.preventDefault(),a.apply(v,[n,e]))});var y;"cancel"==n.onblur?m.blur(function(t){y=setTimeout(function(){a.apply(v,[n,e])},500)}):"submit"==n.onblur?m.blur(function(e){y=setTimeout(function(){v.submit()},200)}):$.isFunction(n.onblur)?m.blur(function(t){n.onblur.apply(e,[m.val(),n])}):m.blur(function(e){}),v.submit(function(t){y&&clearTimeout(y),t.preventDefault();if(!1!==c.apply(v,[n,e])&&!1!==i.apply(v,[n,e]))if($.isFunction(n.target)){var r=n.target.apply(e,[m.val(),n]);$(e).html(r),e.editing=!1,f.apply(e,[e.innerHTML,n]),$.trim($(e).html())||$(e).html(n.placeholder)}else{var s={};s[n.name]=m.val(),s[n.id]=e.id,$.isFunction(n.submitdata)?$.extend(s,n.submitdata.apply(e,[e.revert,n])):$.extend(s,n.submitdata),"PUT"==n.method&&(s._method="put"),$(e).html(n.indicator);var o={type:"POST",data:s,dataType:"html",url:n.target,success:function(t,r){o.dataType=="html"&&$(e).html(t),e.editing=!1,f.apply(e,[t,n]),$.trim($(e).html())||$(e).html(n.placeholder)},error:function(t,r,i){p.apply(v,[n,e,t])}};$.extend(o,n.ajaxoptions),$.ajax(o)}return $(e).attr("title",n.tooltip),!1})}),this.reset=function(t){this.editing&&!1!==h.apply(t,[n,e])&&($(e).html(e.revert),e.editing=!1,$.trim($(e).html())||$(e).html(n.placeholder),n.tooltip&&$(e).attr("title",n.tooltip))}})},$.editable={types:{defaults:{element:function(e,t){var n=$('<input type="hidden"></input>');return $(this).append(n),n},content:function(e,t,n){$(":input:first",this).val(e)},reset:function(e,t){t.reset(this)},buttons:function(e,t){var n=this;if(e.submit){if(e.submit.match(/>$/))var r=$(e.submit).click(function(){r.attr("type")!="submit"&&n.submit()});else{var r=$('<button type="submit" />');r.html(e.submit)}$(this).append(r)}if(e.cancel){if(e.cancel.match(/>$/))var i=$(e.cancel);else{var i=$('<button type="cancel" />');i.html(e.cancel)}$(this).append(i),$(i).click(function(r){if($.isFunction($.editable.types[e.type].reset))var i=$.editable.types[e.type].reset;else var i=$.editable.types.defaults.reset;return i.apply(n,[e,t]),!1})}}},text:{element:function(e,t){var n=$("<input />");return e.width!="none"&&n.width(e.width),e.height!="none"&&n.height(e.height),n.attr("autocomplete","off"),$(this).append(n),n}},textarea:{element:function(e,t){var n=$("<textarea />");return e.rows?n.attr("rows",e.rows):e.height!="none"&&n.height(e.height),e.cols?n.attr("cols",e.cols):e.width!="none"&&n.width(e.width),$(this).append(n),n}},select:{element:function(e,t){var n=$("<select />");return $(this).append(n),n},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json){if(!json.hasOwnProperty(key))continue;if("selected"==key)continue;var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){($(this).val()==json["selected"]||$(this).text()==$.trim(original.revert))&&$(this).attr("selected","selected")})}}},addInputType:function(e,t){$.editable.types[e]=t}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}})(jQuery);


/* public/javascripts/jquery.starbox.js @ 1370554951 */
/*
 * Copyright (c) 2011 Raphael Schweikert, http://sabberworm.com/
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){var e="jstarbox-data",t=".jstarbox",n={average:.5,stars:5,buttons:5,ghosting:!1,changeable:!0,autoUpdateAverage:!1},r={destroy:function(){this.removeData(e),this.unbind(t).find("*").unbind(t),this.removeClass("starbox"),this.empty()},getValue:function(){var t=this.data(e);return t.opts.currentValue},setValue:function(t){var n=this.data(e),r=arguments[1]||n.positioner.width(),i=arguments[2];i&&n.ghost.css({width:""+t*r+"px"}),n.colorbar.css({width:""+t*r+"px"}),n.opts.currentValue=t},getOption:function(t){var n=this.data(e);return n.opts[t]},setOption:function(t,n){var r=this.data(e);t==="changeable"&&n===!1&&r.positioner.triggerHandler("mouseleave"),r.opts[t]=n,t==="stars"?r.methods.update_stars():t==="average"&&this.starbox("setValue",n,null,!0)},markAsRated:function(){var t=this.data(e);t.positioner.addClass("rated")}};jQuery.fn.extend({starbox:function(i){return i.constructor===String&&r[i]?r[i].apply(this,Array.prototype.slice.call(arguments,1))||this:(i=jQuery.extend({},n,i),this.each(function(n){var s=jQuery(this),o=jQuery.extend({},i),u={opts:o,methods:{}};s.data(e,u);var a=u.positioner=jQuery("<div/>").addClass("positioner"),f=u.stars=jQuery("<div/>").addClass("stars").appendTo(a),l=u.ghost=jQuery("<div/>").addClass("ghost").hide().appendTo(f),c=u.colorbar=jQuery("<div/>").addClass("colorbar").appendTo(f),h=u.star_holder=jQuery("<div/>").addClass("star_holder").appendTo(f);s.empty().addClass("starbox").append(a),u.methods.update_stars=function(){h.empty();for(var e=0;e<o.stars;e++)var t=jQuery("<div/>").addClass("star").addClass("star-"+e).appendTo(h);r.setOption.call(s,"average",o.average)},u.methods.update_stars(),a.bind("mousemove"+t,function(e){if(!o.changeable)return;o.ghosting&&l.show();var t=a.width(),n=e.layerX;n===undefined&&(n=e.pageX-a.offset().left);var i=n/t;o.buttons&&(i*=o.buttons,i=Math.floor(i),i+=1,i/=o.buttons),a.addClass("hover"),r.setValue.call(s,i,t),s.starbox("setValue",i,t),s.triggerHandler("starbox-value-moved",i)}),a.bind("mouseleave"+t,function(e){if(!o.changeable)return;l.hide(),a.removeClass("hover"),r.setValue.call(s,o.average)}),a.bind("click"+t,function(e){if(!o.changeable)return;o.autoUpdateAverage&&(r.markAsRated.call(s),r.setOption.call(s,"average",o.currentValue));var t=s.triggerHandler("starbox-value-changed",o.currentValue);!isNaN(parseFloat(t))&&isFinite(t)&&r.setOption.call(s,"average",t),o.changeable==="once"&&r.setOption.call(s,"changeable",!1)})}),this)}})})();


/* public/javascripts/jquery.color.js @ 1370554951 */
/*!
 * jQuery Color Animations v@VERSION
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: @DATE
 */
(function(e,t){function h(e,t,n){var r=u[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function p(t){var n=s(),r=n._rgba=[];return t=t.toLowerCase(),c(i,function(e,i){var s,u=i.re.exec(t),a=u&&i.parse(u),f=i.space||"rgba";if(a)return s=n[f](a),n[o[f].cache]=s[o[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&e.extend(r,l.transparent),n):l[t]}function d(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var n="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],s=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},o={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},a=s.support={},f=e("<p>")[0],l,c=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",a.rgba=f.style.backgroundColor.indexOf("rgba")>-1,c(o,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),s.fn=e.extend(s.prototype,{parse:function(n,r,i,u){if(n===t)return this._rgba=[null,null,null,null],this;if(n.jquery||n.nodeType)n=e(n).css(r),r=t;var a=this,f=e.type(n),d=this._rgba=[];r!==t&&(n=[n,r,i,u],f="array");if(f==="string")return this.parse(p(n)||l._default);if(f==="array")return c(o.rgba.props,function(e,t){d[t.idx]=h(n[t.idx],t)}),this;if(f==="object")return n instanceof s?c(o,function(e,t){n[t.cache]&&(a[t.cache]=n[t.cache].slice())}):c(o,function(t,r){var i=r.cache;c(r.props,function(e,t){if(!a[i]&&r.to){if(e==="alpha"||n[e]==null)return;a[i]=r.to(a._rgba)}a[i][t.idx]=h(n[e],t,!0)}),a[i]&&e.inArray(null,a[i].slice(0,3))<0&&(a[i][3]=1,r.from&&(a._rgba=r.from(a[i])))}),this},is:function(e){var t=s(e),n=!0,r=this;return c(o,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],c(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return c(o,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=s(e),r=n._space(),i=o[r],a=this.alpha()===0?s("transparent"):this,f=a[i.cache]||i.to(a._rgba),l=f.slice();return n=n[i.cache],c(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],a=u[r.type]||{};if(o===null)return;s===null?l[i]=o:(a.mod&&(o-s>a.mod/2?s+=a.mod:s-o>a.mod/2&&(s-=a.mod)),l[i]=h((o-s)*t+s,r))}),this[r](l)},blend:function(t){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=s(t)._rgba;return s(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(r*255)),"#"+e.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),s.fn.parse.prototype=s.fn,o.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,u===0?c=0:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},o.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(d(o,s,t+1/3)*255),Math.round(d(o,s,t)*255),Math.round(d(o,s,t-1/3)*255),i]},c(o,function(n,i){var o=i.props,u=i.cache,a=i.to,f=i.from;s.fn[n]=function(n){a&&!this[u]&&(this[u]=a(this._rgba));if(n===t)return this[u].slice();var r,i=e.type(n),l=i==="array"||i==="object"?n:arguments,p=this[u].slice();return c(o,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=p[t.idx]),p[t.idx]=h(n,t)}),f?(r=s(f(p)),r[u]=p,r):s(p)},c(o,function(t,i){if(s.fn[t])return;s.fn[t]=function(s){var o=e.type(s),u=t==="alpha"?this._hsla?"hsla":"rgba":n,a=this[u](),f=a[i.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=e.type(s)),s==null&&i.empty?this:(o==="string"&&(l=r.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[i.idx]=s,this[u](a)))}})}),s.hook=function(t){var n=t.split(" ");c(n,function(t,n){e.cssHooks[n]={set:function(t,r){var i,o,u="";if(e.type(r)!=="string"||(i=p(r))){r=s(i||r);if(!a.rgba&&r._rgba[3]!==1){o=n==="backgroundColor"?t.parentNode:t;while((u===""||u==="transparent")&&o&&o.style)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(f){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{t.style[n]=r}catch(f){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=s(t.elem,n),t.end=s(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},s.hook(n),e.cssHooks.borderColor={expand:function(e){var t={};return c(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},l=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);


/* public/javascripts/4gen.js @ 1370554951 */
init_4gen=function(){var e;typeof jQuery!="undefined"&&(e=jQuery);var t="scroll",n=3,r=8,i="/images/4gen/trans_1x1.gif",s=30,o=315,u,a=1,f=2,l=3,c=12;window.console||(window.console={log:function(){}});var h=function(){function h(e){}function p(e,t){e.prototype.addEvent=h.prototype.addEvent,e.prototype.removeEvent=h.prototype.removeEvent,e.prototype.fireEvent=h.prototype.fireEvent,e.prototype.initEventHelper=h.prototype.initEventHelper,e.prototype.possibleEvents=t}function S(e,t,n,r,i,s){this.id=e,this.shortstyle=t,this.family=n,this.fallback=r,this.weight=i,this.style=s}function x(e){this.fonts=[],this.docManager=e,this._cssRuleQueue=[],this._fontLoadQueue=[]}function T(e,t){this.pages=[],this.loaded=!1,this.fonts={},this.numFonts=0,this.fontLoader=t,this.groupNum=e||0}function O(e){for(var t in this._defaultParams)this._defaultParams.hasOwnProperty(t)&&(this[t]=e[t]||this._defaultParams[t]);for(var n=0;n<this._requiredParams.length;n++){var r=this._requiredParams[n];if(!this[r])throw"Missing required Page param: "+r}if(!this.contentUrl&&!this.innerPageElem)throw"Must initialize a page with either a contentUrl or innerPageElem element";if(this.containerElem.boundToPageObj===!0)throw"Container Elem is already bound to a page.  We shouldn't get here";this.containerElem.boundToPageObj=!0,this._targetWidth=null,this._innerPageVisible=!!this.innerPageElem,this._imagesTurnedOn=!1,this.boundingRect=null,this.isVisible=!1,this.displayDirty=!0,this.displayOn=null,this.loadHasStarted=!!this.innerPageElem}function _(){this.initEventHelper(),this.viewRect=null,this.enabled=!1;var e=this;this._scrollCallback=function(){e._eventHandler("scroll")},this._resizeCallback=function(t){e._eventHandler("resize")}}function D(){}function P(t,n,r){typeof e=="undefined"&&typeof scribd!="undefined"&&F.setJQuery(scribd.jQuery),e("html, body").animate({scrollTop:e(t).offset().top},{queue:!1,duration:n,easing:"linear",complete:r})}function H(){this._name="book",this.currentPageId=null;var e=this;this._fullscreenResizedCallback=function(t){e._fullscreenResized(t)}}function B(){this._name="slideshow",this.currentPageId=null;var e=this;this._fullscreenResizedCallback=function(t){e._fullscreenResized(t)}}function j(){this._name="scroll";var e=this;this._verticalPositionChangeCallback=function(){e.checkAndUpdateVisiblePages()},this._fullscreenResizedCallback=function(){e._fullscreenResized()},this._afterGotoPage=function(){e.documentManager.setIsScrolling(!1),e.isScrolling||(e.documentManager.visiblePagesChanged(),e._scrollEffect&&delete e._scrollEffect)}}function F(e,t,n){this.options=n||{},this.options.extrasWidth=this.options.extrasWidth||o,this.defaultViewMode=e||"scroll",this.mobile=t||!1,this.initEventHelper(),this.pages={},this._pageWidths=null,this._fontLoader=new x(this),this.viewManagers={scroll:new j,slideshow:new B,book:new H},this.viewportManager=new _,this._currentFontAggregatorHostIdx=0,this.visiblePages=[],this.firstVisiblePage=null,this.lastVisiblePage=null,this.currentFontGroup=new T(0,this._fontLoader),this.isScrolling=!1,this._scrollingCount=0}function I(e,t,n){return Math.min(n,Math.max(t,e))}function q(e){return Math.floor(e*100)/100}var t={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(e){var n="",r,i,s,o,u,a,f,l=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<e.length)o=this._keyStr.indexOf(e.charAt(l++)),u=this._keyStr.indexOf(e.charAt(l++)),a=this._keyStr.indexOf(e.charAt(l++)),f=this._keyStr.indexOf(e.charAt(l++)),r=o<<2|u>>4,i=(u&15)<<4|a>>2,s=(a&3)<<6|f,n+=String.fromCharCode(r),a!=64&&(n+=String.fromCharCode(i)),f!=64&&(n+=String.fromCharCode(s));return n=t._utf8_decode(n),n},_utf8_decode:function(e){var t="",n=0,r=0,i=0,s=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(s=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|s&63),n+=2):(s=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(s&63)<<6|c3&63),n+=3);return t}};h.prototype.initEventHelper=function(){this.eventListenerEnabled=!0,this.eventListeners={};for(var e=0;e<this.possibleEvents.length;e++)this.eventListeners[this.possibleEvents[e]]={}},h.prototype.addEvent=function(e,t){if(!this.eventListeners[e])throw e+" is not a valid type of event";this.eventListeners[e].next_uid||(this.eventListeners[e].next_uid=1),t._event_listener_uid||(t._event_listener_uid=this.eventListeners[e].next_uid,this.eventListeners[e].next_uid++),this.eventListeners[e][t._event_listener_uid]=t},h.prototype.removeEvent=function(e,t){delete this.eventListeners[e][t._event_listener_uid]},h.prototype.fireEvent=function(e,t){function o(e){e.apply(s,r)}if(!this.eventListenerEnabled)return;var n=this.eventListeners[e],r=[];if(arguments.length>1){r[arguments.length-2]=null;for(var i=1;i<arguments.length;i++)r[i-1]=arguments[i]}var s=this;for(var u in n)u!="next_uid"&&n.hasOwnProperty(u)&&o(n[u])};var d="font_preload_bed",v="",m=function(){return!document.styleSheets[0].insertRule},g=function(e){return e%1==0},y=function(e,t){if(m()){var n=e.innerHTML;e.href=t,e.innerHTML!=n&&(e.innerHTML=n)}else e.href=t},b=function(){var e=navigator.userAgent.toLowerCase();return e.search("android 2.2")>-1}(),w=function(){var e=navigator.userAgent.toLowerCase();return e.search("mobile")>-1&&e.search("safari")>-1&&!b}(),E=navigator.userAgent.indexOf("AppleWebKit/")>-1;u=function(){return m()?a:w?f:f}(),m()&&(r=5,n=2),b&&(r=1,n=1),S.prototype.eotCssRule=function(e){var t="src: url("+e+this.family+".eot); "+"font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+t+"}"},S.prototype.ttfCssRule=function(e){var t="src: url("+e+this.family+".ttf) format('truetype'); "+"font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+t+"}"},S.prototype.svgCssRule=function(e){var t="src: url("+e+"#"+this.family+") format('svg'); "+"font-family: "+this.family+"; font-weight: "+this.weight+"; font-style: "+this.style;return"@font-face {"+t+"}"},S.prototype.createPreloadElem=function(){return"<span style='font-family: "+this.family+"'>scribd.</span> "},x.prototype._makeNewStyleBlock=function(){var e=document.createElement("style");window.createPopup||e.appendChild(document.createTextNode(""));var t=document.getElementsByTagName("head")[0];return t.appendChild(e),e},x.prototype._insertCssRule=function(e){this._cssRuleQueue.push(e)},x.prototype._flushCssRuleQueue=function(e){if(this._cssRuleQueue.length>0){var t=e&&document.getElementById(e)||this._makeNewStyleBlock(),n=this._cssRuleQueue.join("\n");m()?t.styleSheet.cssText=n:window.createPopup?t.innerHTML=n:t.appendChild(document.createTextNode(n)),this._cssRuleQueue=[]}},x.prototype.getFontAggregatorHostForFonts=function(e){var t=[];for(var n=0;n<e.length;n++)t.push(e[n].shortstyle+e[n].id);t.sort();var r=this.docManager.nextFontAggregatorHost()+"/"+this.docManager.assetPrefix+"/"+t.join(",")+"/"+c+"/";switch(u){case a:break;case f:b||(r+="ttfs.css");break;case l:r+="fonts.svg"}return r},x.prototype._addTTFRules=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];this._insertCssRule(r.ttfCssRule(t))}},x.prototype._addSVGRules=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];this._insertCssRule(r.svgCssRule(t))}},x.prototype._addEOTRules=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];this._insertCssRule(r.eotCssRule(t))}},x.prototype._nextPreloadId=function(){this._preloadId||(this._preloadId=0);var e="preload_bed"+this._preloadId;return this._preloadId+=1,e},x.prototype._addCSSWebkit=function(e,t){function i(){var e=document.createElement("div"),i=n._nextPreloadId();e.innerHTML=o;var s=document.getElementById(d),u=window.setInterval(function(){r.contentDocument.styleSheets.length>0&&(window.clearInterval(u),r.contentDocument.body.getBoundingClientRect(),s.appendChild(e),window.setTimeout(function(){r.contentDocument.body.getBoundingClientRect(),n._addCSSLink(t)},500))},0)}var n=this,r=document.createElement("iframe"),s=this._nextPreloadId();r.id=s;var o="";for(var u=0;u<e.length;u++){var a=e[u];o+=a.createPreloadElem()}var f=this._makeNewStyleBlock();r.addEventListener("load",function(){i()},!1),r.style.display="none",document.body.appendChild(r),r.contentDocument.body.innerHTML=o;var l=r.contentDocument.createElement("link");l.href=t,l.rel="stylesheet",l.type="text/css",l.media="screen";var c=r.contentDocument.getElementsByTagName("head")[0];c.appendChild(l)},x.prototype._addCSSLink=function(e){var t=document.createElement("link");t.href=e,t.rel="stylesheet",t.type="text/css";var n=document.getElementsByTagName("head")[0];n.appendChild(t)},x.prototype.flushFontQueue=function(){if(this._fontLoadQueue.length===0)return;if(this.docManager.displayType=="rasterize")return;var e=this._fontLoadQueue;this._fontLoadQueue=[];var t=this.getFontAggregatorHostForFonts(e);switch(u){case a:this._addEOTRules(e,t);break;case f:b?this._addTTFRules(e,t):E?this._addCSSWebkit(e,t):this._addCSSLink(t);break;case l:this._addSVGRules(e,t)}this._flushCssRuleQueue()},x.prototype.addFontToQueue=function(e){var t=this.fonts[e];t._loadQueued||(t._loadQueued=!0,this._fontLoadQueue.push(t))},x.prototype.addFont=function(e,t,n,r,i,s){var o=new S(e,t,n,r,i,s);this.fonts[e]=o},x.prototype.setNumFonts=function(e){for(var t=0;t<e;t++)this.fonts[t]=new S(t,"","ff"+t,"sans-serif","normal","normal")},x.prototype._initHidersCSS=function(){var e=[];for(var t=0;t<this.fonts.length;t++)e.push("."+this.fonts[t].family);this._insertCssRule(e.join(", ")+" {display: none;}\n")},x.prototype._initFamilyCSS=function(){for(var e=0;e<this.fonts.length;e++){var t=this.fonts[e].family,n=this.fonts[e].fallback,r=this.fonts[e].weight,i=this.fonts[e].style,s="div."+t+" span";typeof scribd!="undefined"&&typeof scribd.embed_div_id!="undefined"&&(s="#"+scribd.embed_div_id+" "+s),m()?this._insertCssRule(s+" {font-family: "+t+" !important;\n}"):this._insertCssRule(s+" {font-family: "+t+", "+n+"; font-weight: "+r+"; font-style: "+i+";\n}")}},x.prototype.initStyles=function(e){if(this.docManager.displayType=="rasterize")return;this._initFamilyCSS();switch(u){case a:break;case f:b||this._initHidersCSS();break;case l:}this._flushCssRuleQueue("preload_styler")},x.prototype.setupTestElements=function(){if(u!=f||E||this.docManager.displayType=="rasterize")return;var e="";for(var t=0;t<this.fonts.length;t++){var n=this.fonts[t];e+=n.createPreloadElem()}var r=document.getElementById(d);r.innerHTML=e,document.body.appendChild(r),this._insertCssRule("#"+d+" span {display: block; visibility: hidden}"),this._flushCssRuleQueue()},T.prototype.addPage=function(e){for(var t=0;t<e.fonts.length;t++){var n=e.fonts[t];this.fonts[n]===undefined&&(this.fonts[n]=!0,this.numFonts+=1)}this.pages.push(e)},T.prototype.isFull=function(){var e=this.pages.length,t=this.groupNum,n=this.numFonts;return u==a?this.hasLoaded||n>50||n>=20&&(t===0&&e>=r+3||e>=15):u==l||b?this.hasLoaded||n>=5&&e>=r:this.hasLoaded||n>100||n>=20&&(t===0&&e>=r+3||e>=100)},T.prototype.load=function(e){function n(){for(var e in t.fonts)t.fonts.hasOwnProperty(e)&&t.fontLoader.addFontToQueue(e);t.fontLoader.flushFontQueue()}if(this.hasLoaded)return;this.hasLoaded=!0;var t=this;e?window.setTimeout(function(){n()},e):n()},T.prototype.newNextGroup=function(){return new T(this.groupNum+1,this.fontLoader)};var N=1,C=2,k=3,L=4,A=function(){return document.documentElement.style.WebkitTransform!==undefined?N:document.documentElement.style.MozTransform!==undefined?C:document.documentElement.style.OTransform!==undefined?L:k}();O.prototype._defaultParams={containerElem:null,innerPageElem:null,contentUrl:null,origWidth:null,origHeight:null,fonts:null,docManager:null,pageNum:null},O.prototype._requiredParams=["origWidth","origHeight","fonts","docManager","containerElem","pageNum"],O.prototype._updateBoundingRect=function(){var e,t,n,r;if(this.containerElem.getBoundingClientRect&&this.docManager.viewportManager.viewRect){var i=this.containerElem.getBoundingClientRect(),s=this.docManager.viewportManager.viewRect;t=i.left+s.left,e=i.top+s.top,n=i.right-i.left,r=i.bottom-i.top,this.boundingRect={left:t,top:e,bottom:e+r,right:t+n,width:n,height:r}}else e=this.containerElem.offsetTop,t=this.containerElem.offsetLeft,n=this.containerElem.offsetWidth,r=this.containerElem.offsetHeight,this.boundingRect={left:t,top:e,bottom:e+r,right:t+n,width:n,height:r}},O.prototype._setContainerContents=function(e){var t=/<noscript *><img[^<>]*\/><\/noscript *>/g,n=document.createElement("div");n.innerHTML=e.replace(t,""),this.containerElem.appendChild(n);var r=this;this.innerPageElem=this.containerElem.lastChild,this.turnOnLinks(),this.turnOnImages(),this.fixSVGFonts(),this.displayDirty=!0,this.displayOn?this.display():this.hide()},O.prototype.fixSVGFonts=function(){if(this._svgFontsFixed)throw"Already fixed the svg fonts";if(!this.innerPageElem)return;if(w){var e=function(t){if(t.nodeType==document.TEXT_NODE){var n=t.textContent.search(/[  \n][^ \n ]/);n>=0&&e(t.splitText(n+1))}else{var r=t.childNodes;for(var i=0;i<r.length;i++)e(r[i])}},t=function(e){var n=e.childNodes;for(var r=0;r<n.length;r++){var i=n[r];if(i.nodeType==document.ELEMENT_NODE)t(i);else{var s=n[r+1];s&&s.nodeName=="#text"&&e.insertBefore(document.createElement("span"),s)}}};e(this.innerPageElem),t(this.innerPageElem)}this._svgFontsFixed=!0},O.prototype.imagePageContent=function(e){return str="<img src='"+e+"'></img>",str},O.prototype.load=function(){this.currentlyLoading=!0,this.loadHasStarted=!0;if(this.innerPageElem)throw"We already have loaded this page, but it looks like you called loadPage again";this.loadFonts();var e="page"+this.pageNum+"_callback";if(window[e])try{delete window[e]}catch(t){window[e]=undefined}if(this.docManager.displayType=="rasterize"){delete this.currentlyLoading,this._setContainerContents(this.imagePageContent(this.contentUrl));return}var n=document.createElement("script"),r=this;window[e]=function(t){document.body.removeChild(n);var i=t[0];delete r.currentlyLoading,r._setContainerContents(i),r.docManager.fireEvent("pageLoaded",r.containerElem);try{delete window[e]}catch(s){window[e]=undefined}},n.src=this.contentUrl,n.type="text/javascript",n.charset="UTF-8",document.body.appendChild(n)},O.prototype.remove=function(){if(this.innerPageElem){var e=this.innerPageElem.parentNode;e.removeChild(this.innerPageElem),delete this.innerPageElem,delete this.currentLoading,delete this.loadHasStarted,this._linksTurnedOn=!1,this._imagesTurnedOn=!1,this._svgFontsFixed=!1}},O.prototype.display=function(e,t){if(this.displayOn&&!this.displayDirty)return;this.displayOn=!0;if(this.currentlyLoading)return;if(!this.innerPageElem){if(this.loadHasStarted)return;if(e){this.load();return}return}this.displayDirty=!1,t||(this._linksTurnedOn||this.turnOnLinks(),this._imagesTurnedOn||this.turnOnImages(),this._svgFontsFixed||this.fixSVGFonts()),this.loadFonts();if(this._innerPageVisible)return;this.containerElem.className=this.containerElem.className.replace(/placeholder|not_visible/g,""),this._innerPageVisible=!0,t||(this._fitContentsToWidth(),this.innerPageElem.style.display="block")},O.prototype.hide=function(){if(!this.displayOn&&!this.displayDirty)return;this.displayOn=!1;if(!this.innerPageElem)return;this.displayDirty=!1,this.containerElem.className=this.containerElem.className+" not_visible",this._innerPageVisible=!1,this.innerPageElem.style.display="none"},O.prototype.setLoadFontGroup=function(e){e.addPage(this),this.loadFontGroup=e},O.prototype.loadFonts=function(){this.loadFontGroup.load()};var M=!!(document.all&&/msie 6./i.test(navigator.appVersion)&&window.ActiveXObject);return O.prototype._setZoomScale=function(e){var t=this.innerPageElem;switch(A){case N:t.style.WebkitTransform="scale("+e+")",t.style.WebkitTransformOrigin="top left";break;case C:t.style.MozTransform="scale("+e+")",t.style.MozTransformOrigin="top left";break;case L:t.style.OTransform="scale("+e+")",t.style.OTransformOrigin="top left";break;case k:t.originalZoom||(t.originalZoom=t.currentStyle.zoom=="normal"?1:parseFloat(t.currentStyle.zoom)/100,M&&!this.docManager._isEmbed&&(t.originalZoom*=1.35)),t.style.zoom=t.originalZoom*e*100+"%";if(M){var n=this.innerPageElem;setTimeout(function(){n.style.marginLeft=n.style.marginLeft===""?0:""},500)}break;default:throw"Unknown scale method "+A}},O.prototype._fitContentsToWidth=function(){if(this._targetWidth&&this.innerPageElem&&this._innerPageVisible){var e=this._targetWidth/this.origWidth;this._setZoomScale(e),this._targetWidth=null}},O.prototype.setWidth=function(e){var t=Math.ceil(e/this.origWidth*this.origHeight);this.containerElem.style.width=e+"px",this.containerElem.style.height=t+"px",this._targetWidth=e,this._fitContentsToWidth()},O.prototype.setBounds=function(e,t){this.origWidth/this.origHeight>e/t?t=Math.ceil(e/this.origWidth*this.origHeight):e=Math.ceil(t/this.origHeight*this.origWidth),this.containerElem.style.width=e+"px",this.containerElem.style.height=t+"px",this._targetWidth=e,this._fitContentsToWidth()},O.prototype.turnOnImages=function(){if(!this.innerPageElem)throw"Can't turn on images for a page that's not loaded";if(this._imagesTurnedOn)throw"Images have already been turned on for this document";this._imagesTurnedOn=!0;var e=this.innerPageElem.getElementsByTagName("img");for(var t=0;t<e.length;t++){var n=e[t];if(n.className.toLowerCase().search("absimg")>-1&&!n.src){var r=this.docManager.subImageSrc(n.getAttribute("orig"));this.docManager.enablePNGHack?(n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"', sizingMethod='scale')",n.src=i):n.src=r,n.removeAttribute("orig"),n.style.display="block"}}},O.prototype.turnOnLinks=function(){if(!this.innerPageElem)throw"Can't turn on links for a page that's not loaded";if(this._linksTurnedOn)throw"Links have already been turned on for this document";this._linksTurnedOn=!0;var e=this.docManager,n=function(t){return function(){e.gotoPage(t.substring(4))}},r=this.innerPageElem.getElementsByTagName("a");for(var i=0;i<r.length;i++){var s=r[i];if(s.className.toLowerCase().search("ll")>-1&&!s.href){var o=s.getAttribute("orig");if(o){var u=t.decode(o).replace(/^j[\W]*a[\W]*v[\W]*a[\W]*s[\W]*c[\W]*r[\W]*i[\W]*p[\W]*t[\W]*:|^f[\W]*i[\W]*l[\W]*e[\W]*:/ig,"");u.search(/^page/)>-1?s.onclick=n(u):(u.search(/^mailto:/)>=0||u.search(/^(http|ftp)/)<0&&(u="http://"+u),s.target="_blank",y(s,u),s.rel="nofollow")}}}},p(_,["vertical","horizontal","either","resize"]),_.prototype._makeViewRect=function(){var e=document.documentElement,t=window.scrollY||window.pageYOffset||e.scrollTop,n=window.scrollX||window.pageXOffset||e.scrollLeft,r=window.innerWidth||e.clientWidth,i=window.innerHeight||e.clientHeight,s=n+r,o=t+i;return{top:t,left:n,right:s,bottom:o,width:r,height:i}},_.prototype._updateViewRect=function(){var e=this.viewRect;this.viewRect=this._makeViewRect();var t=!e||e.left!=this.viewRect.left||e.width!=this.viewRect.width,n=!e||e.top!=this.viewRect.top||e.height!=this.viewRect.height;return{xChanged:t,yChanged:n}},_.prototype._eventHandler=function(e){var t=this._updateViewRect();(e=="resize"||e=="both")&&(t.xChanged||t.yChanged)&&this.fireEvent("resize",this.viewRect),(t.xChanged||t.yChanged)&&this.fireEvent("either",this.viewRect),t.xChanged&&this.fireEvent("horizontal",this.viewRect),t.yChanged&&this.fireEvent("vertical",this.viewRect)},_.prototype.enable=function(){if(this.enabled)throw"ViewportManager has already been enabled";this.enabled=!0,this.container=window,this._eventHandler("both"),window.addEventListener?(window.addEventListener("resize",this._resizeCallback,!1),window.document.addEventListener("scroll",this._scrollCallback,!1)):window.attachEvent&&(window.attachEvent("onresize",this._resizeCallback),window.attachEvent("onscroll",this._scrollCallback))},_.prototype.disable=function(){if(!this.enabled)throw"ViewportManager has already been disabled";this.enabled=!1,this.container.removeEventListener?(window.removeEventListener("resize",this._resizeCallback,!1),this.container.removeEventListener("scroll",this._scrollCallback,!1)):window.detatchEvent&&(window.detatchEvent("onresize",this._resizeCallback),this.container.detatchEvent("onscroll",this._scrollCallback))},D.prototype.name=function(){return this._name},D.prototype.register=function(e,t){if(this.registered)throw"This ViewManager is already registered";this.registered=!0,this.documentManager=e,this.viewportManager=t,this._currentPageWidth=defaultViewWidth,this._currentZoomMultiplier=1,this._updatePageWidths();var n=this.documentManager.firstVisiblePage;this._register(e,t),n&&this.documentManager.gotoPage(n.pageNum,{pretty:!1})},D.prototype._zoomedPageWidth=function(){return this._currentPageWidth*this._currentZoomMultiplier},D.prototype._updatePageWidths=function(){this.documentManager.setPageWidths(this._zoomedPageWidth())},D.prototype.isTopPageInView=function(){return!0},D.prototype._register=function(e,t){},D.prototype.unregister=function(){if(!this.registered)throw"This ViewManager is already unregistered";this.isFullscreen&&this.exitFullscreen(),this._checkBodyWidth(),this._unregister(),this.registered=!1,delete this.documentManager,delete this.viewportManager},D.prototype._unregister=function(){},D.prototype._pagingStep=function(){return 1},D.prototype.gotoPage=function(e,t){if(!this.registered)throw"ViewManager must be registerd to call gotoPage";this._gotoPage(e,t)},D.prototype._gotoPage=function(e,t){},D.prototype._fireHideExtras=function(){this.documentManager._fireHideExtras(),this._extrasHidden=!0},D.prototype._fireShowExtras=function(){this.documentManager._fireShowExtras(),this._extrasHidden=!1},D.prototype.enterFullscreen=function(){if(this.isFullscreen)throw"Fullscreen is already set";this._checkBodyWidth(),this.viewportManager.addEvent("resize",this._fullscreenResizedCallback),this._fireHideExtras(),this.resetZoom(),this._enterFullscreen(),this._fullscreenResized(this.viewportManager.viewRect),this._currentPageWidth=this.viewportManager.viewRect.width,this.isFullscreen=!0;var e=this.documentManager.firstVisiblePage;e&&this.documentManager.gotoPage(e.pageNum,{pretty:!1}),this.documentManager._fireEnteredFullscreen()},D.prototype.exitFullscreen=function(){if(!this.isFullscreen)throw"Fullscreen is not set";this.viewportManager.removeEvent("resize",this._fullscreenResizedCallback),this._fireShowExtras(),this.resetZoom(),this._exitFullscreen(),this.isFullscreen=!1;var e=this.documentManager.firstVisiblePage;e&&this.documentManager.gotoPage(e.pageNum,{pretty:!1}),this.documentManager._fireExitedFullscreen()},D.prototype._viewBarWidth=function(){return this._extrasHidden?0:this.documentManager.options.extrasWidth},D.prototype._enterFullscreen=function(){},D.prototype._exitFullscreen=function(){},D.prototype._fullscreenResized=function(e){},D.prototype._scrollWithZoom=function(e,t){window.scrollTo(0,e.top*t)},D.prototype.zoom=function(e){var t=this.viewportManager.viewRect;if(!t)return;this._currentZoomMultiplier*=e,this._checkBodyWidth(),this._updatePageWidths(),this.documentManager.setIsScrolling(!0),this._scrollWithZoom(t,e),this._zoomed(),this.documentManager.setIsScrolling(!1),this.documentManager._fireZoomed(e)},D.prototype._zoomed=function(){},D.prototype.resetZoom=function(){this._currentZoomMultiplier=1,this._checkBodyWidth(),this._updatePageWidths(),this._zoomed()},D.prototype._checkBodyWidth=function(e){var t=document.documentElement.clientWidth,n=this._zoomedPageWidth()+this._viewBarWidth()+10;globalHeader=document.getElementById("global_header"),n>t?(document.body.style.width=n+"px",globalHeader&&(globalHeader.style.width=t+"px")):(document.body.style.width="100%",globalHeader&&(globalHeader.style.width="100%"))},H.prototype=new D,H.prototype._register=function(e,t){this._prepareDisplay()},H.prototype._unregister=function(){for(var t in this.documentManager.pages)if(this.documentManager.pages.hasOwnProperty(t)){var n=this.documentManager.pages[t];e(n.containerElem).removeClass("book_view"),n.containerElem.style.display=""}},H.prototype._prepareDisplay=function(){for(var t in this.documentManager.pages)if(this.documentManager.pages.hasOwnProperty(t)){var n=this.documentManager.pages[t];e(n.containerElem).addClass("book_view"),n.containerElem.style.display="none",n.hide()}this.documentManager.setPageMissingModulesVisible(!1),this.documentManager.gotoPage(this.documentManager.currentPageNum()||1)},H.prototype._zoomed=function(){var e=this.documentManager.pages[this.currentPageId]},H.prototype._updatePageWidths=function(){this.documentManager.setPageWidths(this._zoomedPageWidth()/2)},H.prototype._pagingStep=function(){return 2},H.prototype._showPage=function(e){var t=this.documentManager.pages[e];t&&(t.isVisible=!0,t.display(!0),t.containerElem.style.display="")},H.prototype._hidePage=function(e){var t=this.documentManager.pages[e];t&&(t.isVisible=!1,t.containerElem.style.display="none",t.hide())},H.prototype._gotoPage=function(e,t){e=parseInt(e,10),e%2==1&&(e-=1);var n=null,r=null;typeof this.currentPageId=="number"&&(this._hidePage(this.currentPageId),this._hidePage(this.currentPageId+1)),n=this.documentManager.pages[e],r=this.documentManager.pages[e+1];if(!n&&!r)return;this.currentPageId=e,this.isFullscreen&&this._setPageBounds(this.viewportManager.viewRect),this._showPage(e),this._showPage(e+1),this.documentManager.visiblePagesChanged()},H.prototype._setWidth=function(e){this._currentPageWidth=e,this.documentManager.setPageWidths(e)},H.prototype._fullscreenResized=function(e){this._setWidth(e.width-s)},H.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentPageWidth||defaultViewWidth,P(this.documentManager.pages[this.currentPageId].containerElem,300)},H.prototype._exitFullscreen=function(){this._setWidth(defaultViewWidth),this._checkBodyWidth()},B.prototype=new D,B.prototype._register=function(e,t){this._prepareDisplay();var n=document.getElementById("scroll_preventer");n&&(n.style.overflow="hidden",n.style.height="100%")},B.prototype._unregister=function(){var e=document.getElementById("scroll_preventer");e&&(e.style.overflow="visible",e.style.height="auto")},B.prototype._prepareDisplay=function(){for(var e in this.documentManager.pages)if(this.documentManager.pages.hasOwnProperty(e)){var t=this.documentManager.pages[e];t.containerElem.style.display="none",t.hide()}this.documentManager.setPageMissingModulesVisible(!1),this.documentManager.gotoPage(this.documentManager.currentPageNum()||1)},B.prototype._setPageBounds=function(e){var t=this.documentManager.pages[this.currentPageId];t&&t.setBounds(e.width,e.height)},B.prototype._gotoPage=function(e,t){if(!this.documentManager.pages.hasOwnProperty(e))return;var n;this.currentPageId&&(n=this.documentManager.pages[this.currentPageId],n&&(n.isVisible=!1,n.containerElem.style.display="none",n.hide())),this.currentPageId=e,n=this.documentManager.pages[e],this.isFullscreen&&this._setPageBounds(this.viewportManager.viewRect),n.isVisible=!0,n.display(!0),n.containerElem.style.display="",n._updateBoundingRect(),this.documentManager.visiblePagesChanged()},B.prototype._setWidth=function(e){this._currentPageWidth=e,this.documentManager.setPageWidths(e)},B.prototype._fullscreenResized=function(e){this._setPageBounds(e)},B.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentPageWidth||defaultViewWidth,P(this.documentManager.pages[this.currentPageId].containerElem,300)},B.prototype._exitFullscreen=function(){this._setWidth(defaultViewWidth),this._checkBodyWidth()},j.prototype=new D,j.prototype._updateInViewport=function(e){var t=this.viewportManager.viewRect,n=e.boundingRect,r=e.isVisible;return!t||!n?e.isVisible=!1:e.isVisible=n.left<t.right&&n.right>t.left&&n.top<t.bottom&&n.bottom>t.top,this.adjacentVisiblePages=2,r!=e.isVisible},j.prototype.checkAndUpdateVisiblePages=function(){var e=!1;for(var t in this.pages)if(this.pages.hasOwnProperty(t)){var n=this.pages[t],r=this._updateInViewport(n);e=e||r}e?this.documentManager.visiblePagesChanged():this.documentManager.scheduleLogPageView(),this._updateDisplayOnPages()},j.prototype._updateDisplayOnPages=function(){if(this.documentManager.firstVisiblePage&&this.documentManager.lastVisiblePage){var e=this.documentManager.firstVisiblePage.pageNum-this.adjacentVisiblePages,t=this.documentManager.lastVisiblePage.pageNum+this.adjacentVisiblePages;for(var n in this.pages)if(this.pages.hasOwnProperty(n)){var r=this.pages[n];r&&(r.pageNum>=e&&r.pageNum<=t?r.display():(r.hide(),this.documentManager.fireEvent("pageHide",r)))}}},j.prototype._zoomed=function(){this.checkAndUpdateVisiblePages()},j.prototype._register=function(e,t){this.pages=e.pages,this.viewportManager.addEvent("vertical",this._verticalPositionChangeCallback);for(var n in this.pages)if(this.pages.hasOwnProperty(n)){var r=this.documentManager.pages[n];r.containerElem.style.display=""}this.documentManager.setPageMissingModulesVisible(!0),this.documentManager._updatePageBoundingRects(),this.checkAndUpdateVisiblePages()},j.prototype.isTopPageInView=function(){var e=this.documentManager.firstVisiblePage;return e?this.documentManager._expectedFirstPageNum>e.pageNum?!0:e.boundingRect.top+5>=this.viewportManager.viewRect.top:!0},j.prototype._unregister=function(){this.viewportManager.removeEvent("vertical",this._verticalPositionChangeCallback),delete this.pages},j.prototype._gotoPage=function(t,n){typeof e=="undefined"&&typeof scribd!="undefined"&&F.setJQuery(scribd.jQuery);if(!this.pages.hasOwnProperty(t))return;var r=this.documentManager.pages[t];this.documentManager.setIsScrolling(!0);var i=typeof e!="undefined"&&typeof e.scrollTo!="undefined";if(n.pretty&&i){var s=r.boundingRect;if(n.frac){var o=r.boundingRect.top+Math.floor(r.boundingRect.height*n.frac);s=e.extend({},r.boundingRect,{top:o})}e.scrollTo(s,{duration:600,onAfter:this._afterGotoPage})}else r._updateBoundingRect(),scrollTo(r.boundingRect.left,r.boundingRect.top),this._afterGotoPage();return r.pageNum},j.prototype._gotoNextPage=function(){if(!this.documentManager.firstVisiblePage)return;this.documentManager.gotoPage(this.documentManager.firstVisiblePage.pageNum+1,{direction:1})},j.prototype._gotoPreviousPage=function(){if(!this.documentManager.firstVisiblePage)return;this.documentManager.gotoPage(this.documentManager.firstVisiblePage.pageNum-1,{direction:-1})},j.prototype._setWidth=function(e){this._currentPageWidth=e,this._updatePageWidths(),this._checkBodyWidth()},j.prototype._fullscreenResized=function(){this._setWidth((window.innerWidth||document.documentElement.clientWidth)-s)},j.prototype._enterFullscreen=function(){this._previousPageWidth=this._currentWidth||defaultViewWidth},j.prototype._exitFullscreen=function(){this._setWidth(this._previousPageWidth)},p(F,["expectedFirstPageChanged","viewmodeChanged","enteredFullscreen","exitedFullscreen","hideExtras","showExtras","zoomed","pageHide","pageLoaded","allPagesAdded","pageView","viewmodeInitialized"]),F.prototype._fireZoomed=function(e){this.fireEvent("zoomed",e)},F.prototype.nextFontAggregatorHost=function(){return this._currentFontAggregatorHostIdx=(this._currentFontAggregatorHostIdx+1)%this.fontAggregatorHosts.length,this.fontAggregatorHosts[this._currentFontAggregatorHostIdx]},F.prototype._fireHideExtras=function(){this.fireEvent("hideExtras")},F.prototype._fireShowExtras=function(){this.fireEvent("showExtras")},F.prototype.currentPageNum=function(){return this._expectedFirstPageNum},F.prototype.setupTestElements=function(){this._fontLoader.setupTestElements()},F.prototype.pageCount=function(){if(this.hasOwnProperty("_pageCount"))return this._pageCount;var e=0;for(var t in this.pages)this.pages.hasOwnProperty(t)&&e++;return this._pageCount=e,this._pageCount},F.prototype.setupPaidDocument=function(e,t){this.allowedPages=e,this.originalPageCount=t,this._allowedPagesHash=[],this._maximumAllowedPage=Math.max.apply(null,this.allowedPages),this._minimumAllowedPage=Math.min.apply(null,this.allowedPages),this._isPaidDocument=!0,this._pageMissingElements=[];for(var n=0;n<e.length;n++)this._allowedPagesHash[e[n]]=!0,(n>0&&e[n]>e[n-1]+1||n===0&&e[n]!=1)&&this._pageMissingElements.push("page_missing_explanation_"+e[n].toString());this._maximumAllowedPage!=this.originalPageCount&&this._pageMissingElements.push("page_missing_explanation_"+(this.originalPageCount+1).toString())},F.prototype.minimumPageNumber=function(){return this.viewMode()=="book"?0:1},F.prototype.maximumPageNumber=function(){return this.allowedPages?this.originalPageCount:this.pageCount()},F.prototype.getClosestPageNumber=function(e,t){if(!this.allowedPages)return e;if(this._allowedPagesHash[e])return e;if(e>=this._maximumAllowedPage)return this._maximumAllowedPage;if(e<=this._minimumAllowedPage)return this._minimumAllowedPage;for(var n=1;n<=this
.originalPageCount;n++){if(t<=0&&this._allowedPagesHash[e-n]===!0)return e-n;if(t>=0&&e+n<this.originalPageCount&&this._allowedPagesHash[e+n]===!0)return e+n}},F.prototype.setPageMissingModulesVisible=function(t){typeof e=="undefined"&&typeof scribd!="undefined"&&F.setJQuery(scribd.jQuery);if(!this._isPaidDocument)return;for(var n=0;n<this._pageMissingElements.length;n++){var r=e(this._pageMissingElements[n]);r&&(t?r.show():r.hide())}},F.prototype.getNextAvailablePage=function(e){return getClosestPageNumber(e,1)},F.prototype.getPreviousAvailablePage=function(e){return getClosestPageNumber(e,-1)},F.prototype.flushFontQueue=function(){this._fontLoader.flushFontQueue()},F.prototype.visiblePagesChanged=function(){var e=[];for(var t in this.pages)if(this.pages.hasOwnProperty(t)){var n=this.pages[t];n.isVisible&&e.push(n)}e.sort(function(e,t){return e.pageNum<t.pageNum?-1:1}),this.visiblePages=e;var r=this.firstVisiblePage;this.firstVisiblePage=e.length>0?e[0]:null,this.lastVisiblePage=e.length>0?e[e.length-1]:null,this.isScrolling||(this._loadAdjacentFonts(),this._loadAdjacentPages()),(this.firstVisiblePage!==r&&(!this.firstVisiblePage||!r)||this.firstVisiblePage.pageNum!=r.pageNum)&&!this.isScrolling&&this.firstVisiblePage&&this._updateExpectedFirstPage(this.firstVisiblePage.pageNum),this.scheduleLogPageView()},F.prototype.boundingRatioForPage=function(e){var t=this.viewportManager.viewRect,n=e.boundingRect,r=n.bottom-n.top,i=n.right-n.left;return{left:(t.left-n.left)/i,right:(t.right-n.right)/i+1,top:I((t.top-n.top)/r+e.pageNum,e.pageNum,e.pageNum+1),bottom:I((t.bottom-n.bottom)/r+e.pageNum+1,e.pageNum,e.pageNum+1)}},F.prototype.scheduleLogPageView=function(){this.logPageViewTimout&&window.clearTimeout(this.logPageViewTimout);var e=this;this.logPageViewTimout=window.setTimeout(function(){e.logPageView(),e.logPageViewTimout=null},1e3)},F.prototype.getVisibleBBox=function(){var e={};if(this.firstVisiblePage){var t=this.boundingRatioForPage(this.firstVisiblePage);e.left=t.left,e.right=t.right,e.top=t.top}if(this.lastVisiblePage){var n=this.boundingRatioForPage(this.lastVisiblePage);e.bottom=n.bottom}return e},F.prototype.logPageView=function(){var e=this.getVisibleBBox();for(var t in e)e.hasOwnProperty(t)&&(e[t]=q(e[t]));var n=window.$rat;if(n){var r;window.RAT_API_VERSION=="2"?r=[[e.left,e.top],[e.right,e.bottom]]:r="("+e.left+" "+e.top+") ("+e.right+" "+e.bottom+")",n("fourgen.viewchange",r)}return this.fireEvent("pageView"),e},F.prototype._updateExpectedFirstPage=function(e){this._expectedFirstPageNum=e,this.fireEvent("expectedFirstPageChanged",this._expectedFirstPageNum)},F.prototype._loadAdjacentFonts=function(){if(this.firstVisiblePage&&this.lastVisiblePage){var e=[],t=this.firstVisiblePage.pageNum-r,n=this.lastVisiblePage.pageNum+r;for(var i=t;i<=n;i++){var s=this.pages[i];s&&s.loadFonts()}}},F.prototype._loadAdjacentPages=function(){if(this.firstVisiblePage&&this.lastVisiblePage){var e=[],t=this.firstVisiblePage.pageNum-n,r=this.lastVisiblePage.pageNum+n;for(var i=t;i<=r;i++){var s=this.pages[i];s&&!s.loadHasStarted&&(s.load(),this.mobile&&s.setWidth(this._pageWidths))}this.mobile&&this._removeUnusedPages()}},F.prototype._removeUnusedPages=function(){var e=this.firstVisiblePage.pageNum-n,t=this.lastVisiblePage.pageNum+n,r=this.pages,i=n+1;while(r[i])(i<e||i>t)&&r[i].remove(),i++},F.prototype._updatePageBoundingRects=function(){for(var e in this.pages)this.pages.hasOwnProperty(e)&&this.pages[e]._updateBoundingRect()},F.prototype.addPage=function(e){if(e.pageNum===undefined)throw"must have pageNum param";e.docManager=this;var t=new O(e);return this.pages[e.pageNum]=t,this._pageWidths&&t.setWidth(this._pageWidths),this.currentFontGroup.isFull()&&(this.currentFontGroup=this.currentFontGroup.newNextGroup()),t.setLoadFontGroup(this.currentFontGroup),t},F.prototype.setIsScrolling=function(e){e?this._scrollingCount+=1:this._scrollingCount-=1,this._scrollingCount<0&&(this._scrollingCount=0),this._scrollingCount===0?this.isScrolling=!1:this.isScrolling=!0},F.prototype.setViewManager=function(e,t){if(this._currentViewManager)this._setViewManager(e),typeof t=="function"&&t();else{var n=this;this.addEvent("viewmodeInitialized",function(){n.setViewManager(e,t)})}},F.prototype._setViewManager=function(e,t){t||this._currentViewManager.unregister();var n=this._currentViewManager;this._currentViewManager=this.viewManagers[e],this._currentViewManager.register(this,this.viewportManager),this.fireEvent("viewmodeChanged",this.viewMode(),n?n.name():null)},F.prototype.setInitialViewManager=function(e){if(this._currentViewManager)throw"This should be called before any view manager exists";this._setViewManager(e,!0),this.fireEvent("viewmodeInitialized",this.viewMode(),null)},F.prototype.setDefaultWidth=function(e){this._currentViewManager._currentPageWidth=e,this._currentViewManager._currentZoomMultiplier=1,this._currentViewManager._updatePageWidths()},F.prototype.subImageSrc=function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e.charCodeAt(t);var r=this._imageDomainSubstitutionList[n%this._imageDomainSubstitutionList.length];return e.replace(this._imageDomainSubstitutionFrom,r)},F.prototype.allPagesAdded=function(){if(this._allPagesAddedCalled)throw"can only call allPagesAdded once";this.viewportManager.enable(),this._updatePageBoundingRects(),this.setInitialViewManager(this.defaultViewMode),this.fireEvent("allPagesAdded")},F.prototype.setEmbeddedDoc=function(e){this._isEmbed=e==="True"},F.prototype.setPageWidths=function(e){this._pageWidths=e;for(var t in this.pages)this.pages.hasOwnProperty(t)&&this.pages[t].setWidth(this._pageWidths);this._updatePageBoundingRects()},F.prototype.addFont=function(e,t,n,r,i,s){this._fontLoader.addFont(e,t,n,r,i,s)},F.prototype.setNumFonts=function(e){this._fontLoader.setNumFonts(e)},F.prototype.initStyles=function(){this._fontLoader.initStyles()},F.prototype.gotoPage=function(e,t){var n=!g(e),r=null;n&&(r=+(e%1).toFixed(2),e=Math.floor(e));if(e<this.minimumPageNumber()||e>this.maximumPageNumber())return;t||(t={}),t.pretty===undefined&&(t.pretty=!0),n&&t.frac==undefined&&(t.frac=r);var i=t.direction||0,s=this.pages[e];s===undefined&&this._isPaidDocument&&(e=this.getClosestPageNumber(e,i),s=this.pages[e]),this.mobile&&this.pages[e]&&this.pages[e].setWidth(this._pageWidths),this._updateExpectedFirstPage(e),this._currentViewManager.gotoPage(this._expectedFirstPageNum,t)},F.prototype.gotoPreviousPage=function(){var e=this._currentViewManager._pagingStep();this._currentViewManager.isTopPageInView()?this.gotoPage(this._expectedFirstPageNum-e,{direction:-1}):this.gotoPage(this._expectedFirstPageNum,{direction:-1})},F.prototype.gotoNextPage=function(){var e=this._currentViewManager._pagingStep();this.gotoPage(this._expectedFirstPageNum+e,{direction:1})},F.prototype.enterFullscreen=function(){this._currentViewManager.enterFullscreen()},F.prototype.exitFullscreen=function(){this._currentViewManager.exitFullscreen()},F.prototype.isFullscreen=function(){return this._currentViewManager.isFullscreen},F.prototype._fireEnteredFullscreen=function(){this.fireEvent("enteredFullscreen")},F.prototype._fireExitedFullscreen=function(){this.fireEvent("exitedFullscreen")},F.prototype.viewMode=function(){return this._currentViewManager?this._currentViewManager.name():null},F.prototype.zoom=function(e){this._currentViewManager.zoom(e)},F.prototype.resetZoom=function(){this._currentViewManager.resetZoom()},F.prototype.setImageDomainSubstitution=function(e,t){this._imageDomainSubstitutionFrom=e,this._imageDomainSubstitutionList=t},F.prototype.disableViewManagerResizeWidth=function(){D.prototype._checkBodyWidth=function(){}},F.prototype.disable=function(){this.disabled||(this.disabled=!0,this.viewportManager.disable())},F.setJQuery=function(t){e=t},F}();window.DocumentManager=h},window.DocumentManager===undefined&&init_4gen();


/* public/javascripts/verify_fonts.js @ 1370554951 */
(function(){function s(){if(t)return;var s=document.getElementById("hairspace_ff");e+=1;var o=null,u=0,a=0,f=0;for(nr in i){var l=i[nr],c=document.getElementById("scb_fonttest"+nr);if(c===null)continue;l.ok||c.offsetWidth>10?(l.ok=!0,u++):(a===null?o="":o+=", ",o+=nr,a++),f++}if(u==f){t=!0,n!==null&&(r.removeChild(n),n=null);return}if(e>10&&a>f/2){n=document.createElement("div"),n.style.color="white",n.style.backgroundColor="#ffc0c0",n.style.zIndex=1073741824,n.style.position="fixed",n.style.top="20px",n.style.left="20px",n.style.right="20px",n.style.height="40px",n.style.padding="10px",n.style.border="1px solid #ff0000",n.style.borderRadius="7px",n.style.opacity="50%";var h="We've detected an error with the way your browser renders custom fonts. Some content may display incorrectly.";h+="<br />",h+="(Error with fonts "+o+")",n.innerHTML=h,r.appendChild(n)}e+=1}var e=0,t=!1,n=null,r=null,i=null;window.check_fontface_fonts=function(){i=window.ff_fonts;if(i===undefined)return;r=document.getElementsByTagName("body")[0];for(nr in i){var e=i[nr],t=document.createElement("div");t.innerHTML="&#8202;",t.id="scb_fonttest"+nr,t.style.cssText=e.style,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.style.color="#ffffff",t.style.backgroundColor="#ffffff",t.style.zIndex=-1073741824,t.style.display="inline-block",t.style.fontSize="32px",r.appendChild(t)}setInterval(s,1e3)}})();


/* :asset_packager_compatibility, 'config/asset_packages.yml' @ 1370554951 */
/* public/javascripts/perf.jquery.coffee @ 1370554951 */
(function(){this.Scribd||(this.Scribd={}),Scribd.Perf=function(){function e(e){this.reported_stats=!1,this.custom_logger=e}return e.prototype.recordPerceivedLoadTime=function(e){if($rat&&window.performance&&window.performance.timing)return $rat("perceivedLoadTime",e)},e.prototype.recordPerf=function(e){var t,n,r,i,s,o,u;if($rat&&window.performance&&window.performance.timing&&!this.reported_stats){n={},r=window.performance.timing,s=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedStart","domContentLoadedEnd","domComplete","loadEventStart","loadEventEnd","domContentLoadedEventStart","domContentLoadedEventEnd"],t=0;for(o=0,u=s.length;o<u;o++)i=s[o],n[i]=r[i]||0;n.domContentLoadedStart===0&&n.domContentLoadedEventStart!==0&&(n.domContentLoadedStart=n.domContentLoadedEventStart,delete n.domContentLoadedEventStart),n.domContentLoadedEnd===0&&n.domContentLoadedEventEnd!==0&&(n.domContentLoadedEnd=n.domContentLoadedEventEnd,delete n.domContentLoadedEventEnd);if(e==="onload"?n.loadEventEnd===0:void 0)n.loadEventEnd=(new Date).getTime();this.custom_logger?this.custom_logger(n):$rat("window.performance.timing",n),e&&e.type==="beforeunload"&&n.loadEventEnd===0&&$rat("bouncedBeforeOnload",!0),this.reported_stats=!0}},e.prototype.registerOnbeforeunload=function(){return $(window).on("beforeunload",_.bind(this.recordPerf,this))},e.prototype.registerOnload=function(){var e,t=this;return e=window.onload,window.onload=function(n){return e!=null?e:n,_.defer(function(){return t.recordPerf("onload")})}},e}()}).call(this);


/* public/javascripts/shared/embed_code.jquery.coffee @ 1370554951 */
(function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Scribd.Embed||(Scribd.Embed={}),e=function(){function e(e){this.options=$.extend({object_id:"doc_"+Math.floor(Math.random()*99999)},this.default_options,e),this.options.auto_width||this.options.width==="100%"?this.options.width="100%":parseInt(e.width)<this.options.minWidth&&(this.options.width=this.options.minWidth),this.options.auto_height?this.options.height=this.default_options.height:parseInt(e.height)<this.options.min_height&&(this.options.height=this.options.min_height)}return e.prototype.default_options={minWidth:400,minHeight:400,maxWidth:1600,maxHeight:1600,width:400,height:600,page:1,mode:"scroll",auto_width:!0,auto_height:!1,show_title:!0,show_recommendations:!0},e.prototype.make_title=function(e){var t,n,r,i,s,o,u;return n=[],s=_.escape(Scribd.truncate($.trim(e.title),110)),e.user_title!=null&&(u=_.escape(Scribd.truncate($.trim(e.user_title),110)),o=_.escape(e.user_title)),e.show_title&&(i=_.escape(e.title),r=' style="\nmargin: 12px auto 6px auto;\nfont-family: Helvetica,Arial,Sans-serif;\nfont-style: normal;\nfont-variant: normal;\nfont-weight: normal;\nfont-size: 14px;\nline-height: normal;\nfont-size-adjust: none;\nfont-stretch: normal;\n-x-system-font: none;\ndisplay: block;"',t=' style="text-decoration: underline;" ',n.push("<p "+r+'>\n  <a title="View '+i+' on Scribd" href="'+e.doc_url+'" '+t+">"+s+"</a>"),e.user_title!=null&&n.push(' by\n<a title="View '+o+'\'s profile on Scribd" href="'+e.user_url+'" '+t+">"+u+"</a>"),n.push("</p>")),n},e}(),Scribd.Embed.HTML5CodeGenerator=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.embed_url=function(){var e,t;return t="http://www.scribd.com/embeds/"+this.options.doc_id+"/content",e={start_page:this.options.page,view_mode:this.options.mode},this.options.access_key&&(""+this.options.access_key).length&&(e.access_key=this.options.access_key),e.show_recommendations=this.options.show_recommendations,t+"?"+$.param(e)},t.prototype.render=function(e){var t,n,r,i;return e&&(this.options=$.extend(this.options,e)),t=!1,this.options.auto_height&&this.options.aspect_ratio&&(this.options.auto_width?t=!0:this.options.height=Math.round(1/this.options.aspect_ratio*this.options.width)+60),i=this.make_title(this.options),r=this.embed_url(),n=!!this.options.auto_height,i.push('<iframe class="scribd_iframe_embed" src="'+r+'" data-auto-height="'+n+'" data-aspect-ratio="'+this.options.aspect_ratio+'" scrolling="no" id="'+this.options.object_id+'" width="'+this.options.width+'" height="'+this.options.height+'" frameborder="0"></iframe>'),t&&i.push('<script type="text/javascript">(function() { var scribd = document.createElement("script"); scribd.type = "text/javascript"; scribd.async = true; scribd.src = "http://www.scribd.com/javascripts/embed_code/inject.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(scribd, s); })();</script>'),i.join("").replace(/\n/g," ")},t}(e),Scribd.Embed.FlashCodeGenerator=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.render=function(e){var t;return e&&(this.options=$.extend(this.options,e)),t=this.make_title(this.options),t.push('<object id="'+this.options.object_id+'" name="'+this.options.object_id+'" height="'+this.options.height+'" width="'+this.options.width+'" type="application/x-shockwave-flash" data="http://d1.scribdassets.com/ScribdViewer.swf" style="outline:none;" >\n<param name="movie" value="http://d1.scribdassets.com/ScribdViewer.swf"> \n<param name="wmode" value="opaque"> \n<param name="bgcolor" value="#ffffff"> \n<param name="allowFullScreen" value="true"> \n<param name="allowScriptAccess" value="always"> \n<param name="FlashVars" value="document_id='+this.options.doc_id+"&access_key="+this.options.access_key+"&page="+this.options.page+"&viewMode="+this.options.mode+'"> \n<embed id="'+this.options.object_id+'" name="'+this.options.object_id+'" src="http://d1.scribdassets.com/ScribdViewer.swf?document_id='+this.options.doc_id+"&access_key="+this.options.access_key+"&page="+this.options.page+"&viewMode="+this.options.mode+'" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" height="'+this.options.height+'" width="'+this.options.width+'" wmode="opaque" bgcolor="#ffffff"></embed> \n</object>'),t.join("").replace(/\n/g," ")},t}(e),Scribd.Embed.WordpressCodeGenerator=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.render=function(e){return e&&(this.options=$.extend(this.options,e)),"[scribd id="+this.options.doc_id+" key="+this.options.access_key+" mode="+this.options.mode+"]"},t}(e)}).call(this);


/* public/javascripts/doc_cell.jquery.coffee @ 1370554951 */
(function(){Scribd.DocumentCell=function(){function e(e){this.doc=e}return e.prototype.render=function(e){var t,n,r;return r=e.split("."),n=r[0],t=r[1],_.template(Scribd.DocumentCell.templates[n].template,this[n+"_template_data"](t))},e.prototype.collection_template_data=function(e){return{doc_id:this.doc.id,doc_title:this.doc.title,doc_url:this.doc.url,doc_page_count:this.doc.page_count,doc_description:_(this.doc.description).truncate(270),doc_thumbnail_url:this.doc.thumbnail_small_url,doc_views:this.doc.views,doc_created_on:this.doc.created_on,doc_category:this.doc.category&&this.doc.category.name&&'<li class="category">\n  <span class="metadata_label">Category:</span>\n  <a href="'+this.doc.category.url+'">'+this.doc.category.name+"</a>\n</li>",user_url:this.doc.user.url,user_login:this.doc.user.login,doc_price:this.doc.price&&'<li class="price">\n    <span class="price">'+this.doc.price+"</span>\n</li>",doc_readcasts:this.doc.readcasts,control:Scribd.DocumentCell.templates.collection.controls[e]||""}},e.prototype.collection_old_template_data=function(e){return{doc_id:this.doc.id,doc_title:this.doc.title,doc_url:this.doc.url,doc_page_count:this.doc.page_count,doc_description:_(this.doc.description).truncate(270),doc_thumbnail_url:this.doc.thumbnail_url,doc_views:this.doc.views,doc_created_on:this.doc.created_on,doc_category:this.doc.category&&this.doc.category.name&&'<li class="category">\n  <span class="metadata_label">Category:</span>\n  <a href="'+this.doc.category.url+'">'+this.doc.category.name+"</a>\n</li>",user_url:this.doc.user.url,user_login:this.doc.user.login,doc_price:this.doc.price&&'<li class="price">\n  <span class="price">'+this.doc.price+"</span>\n</li>",control:Scribd.DocumentCell.templates.collection_old.controls[e]||""}},e.templates={collection:{controls:{add_document:'<a href="#" class="add_document"></a>',remove_document:'<a href="#" class="subtle_close_button destroy"> </a>'},template:'<div class="document_mixed document_summary document_{{doc_id}}}">\n  <div class="document_thumbnail">\n    <div class="document_thumbnail_shadow gainlayout">\n      <a href="{{doc_url}}">\n        <div class="thumbnail">\n          <img src="{{doc_thumbnail_url}}">\n            <span class="no_of_pages">{{doc_page_count}} p.</span>\n        </div>\n      </a>\n    </div>\n  </div>\n  <div class="document_body">\n    <h4 class="document_title">\n      <a class="name_link" href="{{doc_url}}">{{doc_title}}</a>\n    </h4>\n    <p class="document_description">{{doc_description}}</p>\n    <p class="document_attrition">\n      <span>From: </span><a href="{{user_url}}" class="username">{{user_login}}</a>\n    </p>\n  </div>\n  <div class="right_toolbar">{{& control}}</div>\n  <ul class="document_meta pills">\n    <li class="meta_node top">\n      <label>Reads:</label><strong>{{doc_views}}</strong><div class="clearfix"></div>\n    </li>\n    <li class="meta_node">\n      <label>Readcasts:</label><strong>{{doc_readcasts}}</strong><div class="clearfix"></div>\n    </li>\n    <li class="meta_node bottom">\n      <label>Uploaded:</label><strong>{{doc_created_on}}</strong><div class="clearfix"></div>\n    </li>\n  </ul><div class="clearfix"></div>\n</div>'},collection_old:{controls:{add_document:'<a href="#" class="add_document"> </a>',remove_document:'<a href="#" class="close_button destroy"> </a>'},template:'<div class="document_summary document_{{doc_id}}">\n  <div class="clearfix">\n    <div class="right_toolbar">{{& control}}</div>\n    <input type="hidden" class="confirmation" name=document_ids[] value="{{doc_id}}" />\n    <div class="document_thumbnail_shadow">\n      <a href="{{doc_url}}"">\n        <div class="thumbnail">\n          <img src="{{doc_thumbnail_url}}">\n          <span class="no_of_pages">{{doc_page_count}} p.</span>\n        </div>\n      </a>\n    </div>\n    <div class="summary clearfix">\n      <h5>\n        <a href="{{doc_url}}">{{doc_title}}</a>\n      </h5>\n      <div class="description">{{doc_description}}</div>\n      <ul class="stats_bottom">\n        <div class="left_column">{{& doc_price}}\n          <li class="user">\n            <span class="metadata_label">From:</span>\n            <a class="username" href="{{user_url}}">{{user_login}}</a>\n          </li>\n          <li class="created_at">\n            <span class="metadata_label">Uploaded:</span>{{doc_created_on}}\n          </li>\n          <li class="views">\n            <span class="metadata_label">Reads:</span>{{doc_views}}\n          </li>\n          {{& doc_category}}\n        </div>\n      </ul>\n    </div>\n  </div>\n</div>'}},e}()}).call(this);


/* public/javascripts/document_collections_manager.jquery.coffee @ 1370554951 */
(function(){Scribd.DocumentCollectionsManager={docs_in_collections:{},docs:{},loadPageForDocument:function(e,t,n,r){var i;return n=$(n),r=$(r),r.show(),i=Scribd.DocumentCollectionsManager,i.docs_in_collections[e]||(i.docs_in_collections[e]={}),i.getCollectionsForDocument(e,t,{success:function(t){return i.storeCollections(e,t.collections),n.html(i.renderCollectionsIn(e,t)),i.attachEvents(e,$(n).find("li.document_collection"))},complete:function(){return r&&r.hide()},create:function(){return r&&r.show()}})},getCollectionsForDocument:function(e,t,n){var r;return r=[],new $.ajax("/my_document_collections.json",{data:{view:"add_document_to_collections",document_id:e,page:t},type:"get",complete:n.complete,failure:n.failure,success:function(e){return n.success(e)}})},storeCollections:function(e,t){var n;return n=Scribd.DocumentCollectionsManager,_.chain(t).filter(function(e){return e.selected==="1"}).each(function(t){return n.docs_in_collections[e][t.id]=!0})},attachEvents:function(e,t){var n;return n=Scribd.DocumentCollectionsManager,_.each(t,function(t){return n.attachEvent(e,t)})},attachEvent:function(e,t){var n,r,i,s;return n=Scribd.DocumentCollectionsManager,t=$(t),i=t.data("document_collection_id"),r=t.find("input:first"),s=t.find(".status_loader:first"),t.on("click",function(t){var o,u;return t.stopPropagation(),n.docs_in_collections[e][i]?(o="/remove_document",u="delete"):(o="/add_document",u="post"),$.ajax("/document_collections/"+i+o,{data:{document_id:e},type:u,complete:function(){return s.hide(),r.show()},success:function(t){var s;return s=t,s&&t.added?($(r).prop("checked",!0),n.docs_in_collections[e][i]=!0):($(r).prop("checked",!1),delete n.docs_in_collections[e][i])}})})},renderCollectionsIn:function(e,t){var n,r,i;return n=Scribd.DocumentCollectionsManager,i=_.map(t.collections,function(t){var r;return r=n.renderingCollectionAttributes(e,t),_.template(n.collection_template,r)}).join("\n"),t.total===0&&(r=n.docs[e]["private"]?"private ":"",i='<span class="no_collections">'+I18n.t("js.not_created_any_collections",{private_text:r})+"</span>"),_.template(n.collections_template,{collections_list:i,pagination_control:n.renderPagination(t.page,t.per_page,t.total),doc_id:e})},renderPagination:function(e,t,n,r){var i,s,o,u,a,f;a=Math.ceil(n/t);if(a<=1)return"";i=["<span>",e,"</span>"],r||(r=2),o=a,f=u=e,s=1;while(s<=r)f>1&&(f=e-s,i.unshift('<a href="#" data-page="',f,'">',f,"</a>")),u<o&&(u=e+s,i.push('<a href="#" data-page="',u,'">',u,"</a>")),s++;return f>2&&i.unshift('<span class="ellipsis">...</span>'),f>1&&i.unshift('<a href="#" data-page="',e-1,'">',"","</a>",'<a href="#" data-page="1">1</a>'),u<o-1&&i.push('<span class="ellipsis">...</span>'),u<o&&i.push('<a href="#" data-page="',o,'">',o,"</a>",'<a href="#" data-page="',e+1,'">',"","</a>"),'<div class="paginator ">'+i.join("")+"</div>"},renderingCollectionAttributes:function(e,t){var n;return n={id:t.id,name:_(t.name).truncate(80),doc_id:e,privacy_type:t.privacy_type,combined_privacy_type:t.combined_privacy_type},parseInt(t.selected)===1?n.checked='checked="checked"':n.checked="",n},addToCollectionsEventHandler:function(e,t){var n,r,i,s,o,u;return t.stopPropagation(),n=Scribd.DocumentCollectionsManager,r=$(t.target),s=$("#lightbox_document_collections").first(),s.filter(":visible").length&&Scribd.Lightbox.toggle("lightbox_document_collections",0),s.find(".private:first").hide(),o=s.find(".manage_collection:first"),i=o.find(".document_collections_container:first"),i.retrieve("document_id")!==e&&(i.store("document_id",e),n.renderDoc(e),i.html(""),u=o.find("img"),n.loadPageForDocument(e,1,i,u)),Scribd.Lightbox.toggle("lightbox_document_collections",75)},setupCollectionsLightbox:function(e,t){var n,r,i;e=$(e),t=t||Scribd.current_doc.id,r=e.find(".manage_collection"),n=r.find(".document_collections_container");if(n.data("document_id")!==t)return n.data("document_id",t),this.renderDoc(t),n.html(""),i=r.find("img:first"),this.loadPageForDocument(t,1,n,i)},addPaginationEvent:function(){var e,t,n,r;return e=Scribd.DocumentCollectionsManager,n=$("#lightbox_document_collections .manage_collection:first"),t=n.find(".document_collections_container:first"),r=n.find("img:first"),t.on("click",function(n){var i,s;i=$(n.target);if(i.data("page"))return n.stopPropagation(),s=t.data("document_id"),e.loadPageForDocument(s,i.data("page"),t,r)})},renderDoc:function(e){var t,n,r;t=Scribd.DocumentCollectionsManager,n=t.docs[e],r=$("#lightbox_document_collections .document_container").first();if(!n)return r.html(""),$.ajax("/documents/"+e+".json",{type:"get",success:function(n){if(n)return t.docs[e]=n,t.renderDoc(e)}});r.html((new Scribd.DocumentCell(n)).render("collection_old"));if(n["private"])return r.parent().find(".private").show()}},Scribd.DocumentCollectionsManager.Paginator=function(){function e(e){this.total=e.total,this.per_page=e.per_page||10,this.window_size=e.window_size,this.url=e.url,this.params=e.params}return e}(),Scribd.DocumentCollectionsManager.collections_template='<ul style="right: auto;" class="add_to_my_collections sub_menu">\n    {{& collections_list}}\n    {{& pagination_control}}\n</ul>',Scribd.DocumentCollectionsManager.collection_template='<li class="clearfix document_collection document_collection_{{id}}" data-document_collection_id="{{id}}">\n    <span>\n        <img src=`/images/loader_black_on_white.gif?1370554951` class="status_loader" alt="Loader_black_on_white" style="display:none;">\n        <input type="checkbox" value="{{id}}" name="document_collection_id" {{& checked}}/>\n    </span>\n    <label>{{name}}</label>\n    <span class="privacy {{& privacy_type}}"> {{& combined_privacy_type}} </span>\n</li>'}).call(this);


/* public/javascripts/jquery_global/popover.coffee @ 1370554951 */
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].slice;Scribd.Popover=function(){function n(t){var n=this;this.container=t,this.set_title=e(this.set_title,this),this.container=$(this.container),$("body").on("click",function(e){if(!$(e.target).closest(".floating_popover").length)return n.close()})}return n.prototype.offset_top=11,n.current_open=null,n.initialize=function(){var e=this;return $(function(){return e.popovers=$("#popovers"),$(document).keyup(function(t){if(e.current_open&&e.current_open.user_closable()&&t.keyCode===27)return e.close(),!1})})},n.close=function(){return $(".floating_popover").hide()},n.create=function(e,t){var r,i,s,o,u;return t==null&&(t={}),i=$("#"+e),i&&i.length&&i.remove(),t=$.extend({close:!1},t),s=new n($('<div class="floating_popover" id="'+e+'">\n  <div class="sprite popup_arrow"></div>\n  <div class="wrapper">\n    <div class="content"></div>\n  </div>\n</div>').hide()),o=s.container.find(".wrapper"),t.title&&$('<div class="title"></div>').text(t.title).prependTo(o),t.close&&(r=$('<div class="close_wrapper"><div class="sprite close"></div></div>').on("click",function(e){return s.close(),e.stopPropagation()}),o.prepend(r)),(u=this.popovers)!=null&&u.append(s.container),t.content&&s.container.find(".content").html(t.content),s},n.loading=function(e,t){var n;t==null&&(t={}),n=e.find(".newdoc_sprite:first");if(!n.hasClass("loading"))return n.data("old_class",n.attr("class")),n.attr("class","newdoc_sprite loading")},n.open=function(){var e,n,r,i,s;i=arguments[0],r=arguments[1],e=arguments[2],n=4<=arguments.length?t.call(arguments,3):[],e==null&&(e=Scribd.Popover),$(".floating_popover").hide(),s=r.find(".newdoc_sprite:first"),s.attr("class",s.data("old_class"));if(!i.container)throw"failed to find popover";return $(r).prev(".popover_hook").html(i.container),i.container.show(),i},n.open_from_object=function(e,t,r,i){var s;return i==null&&(i=null),s=n.create(e,$.extend({close:!0},r)),n.open(s,t,i)},n.remote_open=function(e,t,r,i,s){var o,u,a=this;return s==null&&(s={}),o=$("#"+e),o.remove(),u=s.success,this.loading(t),$.ajax({url:r,data:i,type:"POST",dataType:"html",success:function(r){var i;return $("#loading_popover").remove(),i=n.create(e,$.extend(s,{content:r})),n.open(i,t),typeof u=="function"?u(r):void 0}})},n.prototype.close=function(){return this.container.remove()},n.prototype.user_closable=function(){return this.container.find(".close_button").length>0},n.prototype.set_title=function(e){var t;return t=this.container.find(".title"),t.length||(t=this.container.find(".content").before('<div class="title"></div>').prev(".title")),t.text(e)},n.prototype.hide=function(){return this.container.hide()},n.prototype.show=function(e){return e==null&&(e=this.offset_top),Scribd.Popover.current_open&&Scribd.Popover.current_open.hide(),this.container.fadeIn("fast"),Scribd.Popover.current_open=this},n}()}).call(this);


/* public/javascripts/jquery_global/sticky.coffee @ 1370554951 */
(function(){$.fn.sticky_container=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m=this;return e==null&&(e={}),a=this.offset(),v=$(window),u=e.padding!=null?e.padding:0,c=e.sticky_class||"stuck",s=e.bottom_class||"bottomed",l=e.sticky_callback,f=e.static_callback,n=e.before_stick,i=e.before_unstick,t=e.before_bottom,r=e.before_unbottom,e.unstick_after&&(d=$(e.unstick_after)),h=!1,o=!1,p=function(){var e,p,g,y;return y=v.scrollTop(),g=y>a.top-u,d&&(g?(e=d.offset().top+d.height(),y+v.height()>e?(g=!1,o||(typeof t=="function"&&t(m),o=!0,s&&m.addClass(s))):o&&(typeof r=="function"&&r(m),o=!1,s&&m.removeClass(s))):o&&(typeof r=="function"&&r(m),o=!1,s&&m.removeClass(s))),p=!1,g?(h||(typeof n=="function"&&n(m),m.addClass(c),h=!0,p=!0),typeof l=="function"&&l(m,p)):(h&&(typeof i=="function"&&i(m),m.removeClass(c),h=!1,p=!0),typeof f=="function"&&f(m,p)),void 0},this.on("Scribd:update_root",function(){return a=m.offset()}),this.on("Scribd:restick",p),v.on("scroll resize",p),this}}).call(this);


/* public/javascripts/reading_progress.coffee @ 1370554951 */
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Scribd.ReadingProgress=function(){function t(t){t==null&&(t={}),t.scroll_watch===void 0&&(t.scroll_watch=!0),t.huge_jump=t.huge_jump||1,t.num_valid_scrolls_after_jump=t.num_valid_scrolls_after_jump||2,this.watch_scroll=t.scroll_watch,this.debounce_time=this.constructor.debounce_time,this.state_of_jump_huge_amount=!1,this.curr_times_scroll_after_big_jump=0,this.definition_of_huge_jump=t.huge_jump,this.num_times_to_scroll_after_big_jump=t.num_valid_scrolls_after_jump,this.watch_scroll&&(this.scroll_jump_watcher=new e(this),this.setup_listeners())}var e;return e=function(){function e(e){this.reading_progress=e,this.starting_jump_point=null,this.ending_jump_point=null,this.watch_interval_id=null}return e.prototype.watch=function(){var e=this;return this.starting_jump_point=this.reading_progress.current_top_position(),this.watch_interval_id=setInterval(function(){return e.ending_jump_point=e.reading_progress.current_top_position()},100)},e.prototype.running_watch=function(){return this.watch_interval_id!==null},e.prototype.stop_watching=function(){return clearInterval(this.watch_interval_id),this.watch_interval_id=null},e.prototype.distance_jumped=function(){return Math.abs(this.ending_jump_point-this.starting_jump_point)},e}(),t.url="/reading-history/public/update_progress",t.debounce_time=Scribd.ServerOptions.reading_history_scroll_timeout&&parseInt(Scribd.ServerOptions.reading_history_scroll_timeout),t.prototype.is_disabled=function(){var e;return((e=Scribd.current_doc)!=null?!e.reading_history:!void 0)||Scribd.named_current_user_sync().masked_admin||this.watch_scroll&&+this.debounce_time<=0},t.prototype.current_top_position=function(){var e;e=docManager.getVisibleBBox();if(!e.top)return;return e.top.toFixed(2)},t.prototype.ping_reading_progress=function(e){if(this.is_disabled())return;if(!e)return;if(e>1.1){if(e===this.last_pinged_progress)return;return this.last_pinged_progress=e,$.post(this.constructor.url,$.extend({},this.reading_history_ping_opts(),{reading_progress:e}))}return},t.prototype.reading_history_ping_opts=function(){return Scribd.current_doc.reading_history},t.prototype.update_progress=function(){return this.ping_reading_progress(this.current_top_position())},t.prototype.setup_listeners=function(){var e=this;return $(document).on("scroll",function(){return e.scroll_jump_watcher.running_watch()||e.scroll_jump_watcher.watch(),e.scroll_watch()})},t.prototype.scroll_watch=_.debounce(function(){var e;this.scroll_jump_watcher.stop_watching(),e=this.scroll_jump_watcher.distance_jumped()>this.definition_of_huge_jump,this.state_of_jump_huge_amount&&(this.curr_times_scroll_after_big_jump=e?0:this.curr_times_scroll_after_big_jump+1);if(!this.state_of_jump_huge_amount||this.curr_times_scroll_after_big_jump>=this.num_times_to_scroll_after_big_jump){this.state_of_jump_huge_amount=e;if(!this.state_of_jump_huge_amount)return this.curr_times_scroll_after_big_jump=0,this.update_progress()}},t.debounce_time),t}(),Scribd.MobileReadingProgress=function(e){function n(e){this.doc_info=e}return t(n,e),n.prototype.is_disabled=function(){return Scribd.named_current_user_sync().masked_admin},n.prototype.reading_history_ping_opts=function(){return this.doc_info},n}(Scribd.ReadingProgress),Scribd.SectionizedReflowReadingProgress=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.maxElement=null,this.prefix="buPe"}return t(n,e),n.prototype.get_top=function(e){var t;t=0;while(e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop))t+=e.offsetTop,e=e.offsetParent;return t},n.prototype.get_bottom=function(e){return this.add_bottom(e,this.get_top(e))},n.prototype.add_bottom=function(e,t){try{t+=e.offsetHeight}catch(n){}return t},n.prototype.get_max_element_index=function(){var e,t;if(this.maxElement===null){t=1024,e=0;while(t!==0){while(document.getElementById(this.prefix+(t+e))!==null)e+=t;t>>=1}this.maxElement=e}return this.maxElement},n.prototype.find_first_element_below=function(e){var t,n,r,i,s,o;o=0,s=this.get_max_element_index()+1,r=s>>1,i=s;while(r!==i)t=document.getElementById(this.prefix+r),n=this.get_top(t),n>e?s=r:o=r,i=r,r=o+s>>1;return[t,r]},n.prototype.find_first_element_above=function(e){var t,n,r,i,s,o;o=0,s=this.get_max_element_index()+1,r=s>>1,i=s;while(r!==i)t=document.getElementById(this.prefix+r),n=this.get_top(t),n<=e?o=r:s=r,i=r,r=o+s>>1;return[t,r]},n.prototype.derive_half_visible_ratio=function(e,t){var n,r,i;return r=this.get_top(e),i=this.get_bottom(e,r),n=(t-r)/(i-r),n<0&&(n=0),n>1&&(n=1),n},n.prototype.current_top_position=function(){var e,t,n,r;return n=$(window).scrollTop(),r=this.find_first_element_below(n),e=r[0],t=r[1],t+=this.derive_half_visible_ratio(e,n),t},n.prototype.store_rat_read=function(e,t){if(!window.$rat)return;return window.$rat("epub_read",[e,t])},n.prototype.update_progress=function(){var e,t,n,r,i,s,o,u;i=$(window).scrollTop(),s=i+window.innerHeight,o=this.find_first_element_below(i),e=o[0],n=o[1],u=this.find_first_element_above(s),t=u[0],r=u[1],n+=this.derive_half_visible_ratio(e,i),r+=this.derive_half_visible_ratio(t,s),this.store_rat_read(n,r),this.ping_reading_progress(n);if(this.debug)return e.style.backgroundColor="#00ff00",this.last_top!==null&&this.last_top!==e&&(last_top.style.backgroundColor="#ffffff"),this.last_top=e,t.style.backgroundColor="#ff8080",this.last_bottom!==null&&this.last_bottom!==t&&(this.last_bottom.style.backgroundColor="#ffffff"),this.last_bottom=t},n}(Scribd.ReadingProgress)}).call(this);


/* :files, 'public/javascripts/shared', ... @ (none) */


/* :files, 'app/views', ... @ (none) */


/* :files, 'app/views', ... @ 1370554908 */
/* app/views/shared/_passive_sharing_dialog.base.coffee @ 1370554908 */
(function(){var e,t,n;(t=window.Scribd)==null&&(window.Scribd={}),(n=Scribd.UI)==null&&(Scribd.UI={}),e=Scribd.UI.PassiveSharingDialog=function(){function e(t){var n=this;this.sent_preference=!1,this.lightbox=e._find_lightbox(t),this.lightbox.on("click",".enable_passive_share",function(){return n.sent_preference=!0,n.enable_passive_sharing(),n._close()}),this.lightbox.on("click",".disable_passive_share",function(){return n.sent_preference=!0,n.disable_passive_sharing(),n._close()}),e._on_lightbox_close(this.lightbox.id,function(){if(n.sent_preference)return;return n.close_passive_sharing()})}return e.prototype._close=function(){return Scribd.Lightbox.close(this.lightbox.id)},e._unimplemented=function(){throw new Error("This method should be replaced with a Prototype or jQuery implementation.")},e._send_post=function(e){return this._unimplemented()},e._find_lightbox=function(e){return this._unimplemented()},e._open_lightbox=function(e){return this._unimplemented()},e.prototype.enable_passive_sharing=function(){return trackEvent("PassiveSharing","Click","autoshare_enable"),this._set_sharing_preference(!0)},e.prototype.disable_passive_sharing=function(){return trackEvent("PassiveSharing","Click","autoshare_disable"),this._set_sharing_preference(!1)},e.prototype.close_passive_sharing=function(){return trackEvent("PassiveSharing","Click","autoshare_close"),this._set_sharing_preference(!1)},e.prototype._set_sharing_preference=function(t){var n,r;return n=t?"on":"off",r={_method:"put","options[has_seen_passive_sharing_dialog]":!0,"options[event_settings][reading][facebook]":n,"options[event_settings][reading][scribd]":n},e._send_post({url:"/sharing_preference",params:r})},e.open=function(t){var n,r=this;return t==null&&(t={}),n=Scribd.CSRF.get_csrf_params(),t.newhome&&(n["new"]=!0),e._send_post({url:"/accounts/passive_sharing_dialog",params:n,on_success:function(e){return Scribd.with_named_current_user(function(){return r._open_lightbox("passive_share_lb",e.lightbox)})}})},e}()}).call(this);


/* app/views/shared/_passive_sharing_dialog.jquery.coffee @ 1370554908 */
(function(){_.extend(Scribd.UI.PassiveSharingDialog,{_send_post:function(e){var t,n,r;return r=e.url,n=e.params,t=e.on_success,$.post(r,n,t)},_find_lightbox:function(e){return $("#"+e).closest(".lightbox")},_open_lightbox:function(e,t){return Scribd.Lightbox.open_from_object(e,t)},_on_lightbox_close:function(e,t){return $(document).on("lightbox:closed",function(n,r){return r.lightbox_id!==e?!1:t()})}})}).call(this);


/* app/views/read/download_document.coffee @ 1370554908 */
(function(){Scribd.toolbar_params=function(e){var t;return Scribd.current_doc&&(e=Scribd.current_doc),t={id:e.id,show_container:!0},e.secret_password&&(t.secret_password=e.secret_password),t},Scribd.download_actions={register_download_attempt:function(e,t,n,r){var i;return $.ajax("/document_downloads/register_download_attempt",{type:"post",data:{doc_id:r.id,next_screen:n,source:e}}),Scribd.content_discovery_version&&(i=$(window).scrollTop()>700?"BelowFoldDownloadSidebar":"AboveFoldDownloadSidebar",Scribd.track_event(Scribd.content_discovery_version,"Click",i,1)),Scribd.track_event("download","click",e,Scribd.logged_in?1:0),$rat("analytics.sidebar.document.download",{title:r.title})},download_attempt:function(e,t,n,r){var i,s,o,u,a=this;return i=!Scribd.logged_in&&!Scribd.anonymous_current_user_sync(),s=encodeURIComponent(JSON.stringify({context:r.signup_context,page:t,action:n,platform:"web",logged_in:!i})),r.show_archive_paywall?(o="doc="+r.id+"&metadata="+s,i?(this.register_download_attempt(t,n,"login_lightbox",r),Scribd.LoginLightbox.remote_open("archive_lb","/archive/login?"+o,Scribd.toolbar_params(r))):(u=function(){return a.register_download_attempt(t,n,"paywall",r),window.location="/archive/plans?"+o},Scribd.FacebookSession.attempt_facebook_upgrade(u))):i?(this.register_download_attempt(t,n,"login_lightbox",r),Scribd.with_login("Download",r.url+"#download")):(this.register_download_attempt(t,n,"download_lightbox",r),e(r))},download_dialog_lightbox:function(e){return Scribd.Lightbox.remote_open("download_dialog","/read/download_dialog",Scribd.toolbar_params(e))},download:function(e,t,n){var r;return r=this.download_dialog_lightbox,Scribd.current_doc?Scribd.download_actions.download_attempt(r,t,n,Scribd.current_doc):$.ajax("/document_downloads/request_document_for_download",{type:"post",data:{id:e},success:function(e){return Scribd.download_actions.download_attempt(r,t,n,e)}})}}}).call(this);


/* app/views/read/document_container.coffee @ 1370554908 */
(function(){var e;Scribd.DocumentContainer=e=function(){function e(e,t,n){this.container=e,this.template=t,this.max_size=n!=null?n:348,this.container=$(this.container),this.container_size=87,this.documents=[],this.max_size=this.max_size,this.page_num,this.template=this.template,this.animation_complete_callback=function(){}}return e.prototype.max_elements=function(){return Math.floor(this.max_size/this.container_size)},e.prototype.update=function(e){return e?(this.documents=e,this.goto_page(0)):this.goto_page(this.page_num||0)},e.prototype.draw=function(e){var t,n,r,i,s,o=this;n=[],r=this.page_num*this.max_elements()+1;for(i=0,s=e.length;i<s;i++)t=e[i],t.position=r,n.push(_.template(this.template,t)),r++;return this.container.fadeOut("fast",function(){return o.container.html(n.join("")),o.container.fadeIn(function(){return o.animation_complete_callback()})})},e.prototype.goto_page=function(e){var t;e=Math.max(0,Math.min(this.max_pages()-1,e)),t=e*this.max_elements();if(this.page_num!==e)return this.page_num=e,this.draw(this.documents.slice(t,t+this.max_elements()))},e.prototype.max_pages=function(){return Math.ceil(this.documents.length/this.max_elements())},e.prototype.prev=function(){return this.goto_page(this.page_num-1)},e.prototype.next=function(){return this.goto_page(this.page_num+1)},e}()}).call(this);


/* app/views/read/comments/_comments.coffee @ 1370554908 */
(function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(t){return e.tracker("Click","comments_"+t)},e.tracker=Scribd.make_tracker("newdoc"),Scribd.Backbone=(t=Scribd.Backbone)!=null?t:{},Scribd.Backbone.Comment=function(e){function t(){return this.mark_ham=n(this.mark_ham,this),this.mark_spam=n(this.mark_spam,this),this.mark=n(this.mark,this),this.viewable_children=n(this.viewable_children,this),this.is_viewable=n(this.is_viewable,this),this.user_owned=n(this.user_owned,this),this.has_annotation=n(this.has_annotation,this),this.is_root=n(this.is_root,this),this.urlRoot=n(this.urlRoot,this),t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.idAttribute="_id",t.prototype.defaults={deleted:!1,is_spam:!1},t.prototype.initialize=function(e){return this.set("depth",this.depth),this.set("time_str",moment(this.get("created_at")).fromNow()),this.set("user_owned",this.user_owned)},t.prototype.relations=[{type:Backbone.HasMany,key:"children",relatedModel:"Scribd.Backbone.Comment",collectionType:"Scribd.Backbone.CommentCollection"},{type:Backbone.HasOne,key:"parent",relatedModel:"Scribd.Backbone.Comment",collectionType:"Scribd.Backbone.CommentCollection"},{type:Backbone.HasOne,key:"word_user",relatedModel:"Scribd.Backbone.WordUser",includeInJSON:["login","comment_profile_picture","small_comment_profile_picture","_id","name"]}],t.prototype.urlRoot=function(){return"/documents/"+this.get("document_id")+"/comments/"},t.prototype.is_root=function(){return!this.get("parent")&&!this.get("parent_id")},t.prototype.has_annotation=function(){return!!this.get("annotation")||!!this.get("annotation_id")},t.prototype.user_owned=function(){return Scribd.Backbone.current_user?Scribd.Backbone.current_user.get("id")===this.get("word_user_id")||Scribd.current_doc.author_id===Scribd.Backbone.current_user.get("id"):!1},t.prototype.is_viewable=function(){return this.get("viewable")==="show"||this.get("word_user")===Scribd.Backbone.current_user&&!this.get("deleted")},t.prototype.viewable_children=function(){var e=this;return this.get("children").some(function(e){return e.is_viewable()})},t.prototype.mark=function(e){return $.ajax("/admin/documents/"+Scribd.current_doc.id+"/newcomments/"+this.get("_id")+"/mark_"+e,{type:"put"})},t.prototype.mark_spam=function(){return this.set("is_spam",!0),this.mark("spam"),this.set("viewable","hidden")},t.prototype.mark_ham=function(){return this.mark("ham")},t}(Backbone.RelationalModel),Scribd.Backbone.Comment.setup(),Scribd.Backbone.Document=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.urlRoot="/documents",t.prototype.defaults={next_page:1},t.prototype.initialize=function(){return this.set("_id",Scribd.current_doc.id)},t.prototype.relations=[{type:Backbone.HasMany,key:"comments",relatedModel:"Scribd.Backbone.Comment",collectionType:"Scribd.Backbone.CommentCollection",reverseRelation:{key:"document",includeInJSON:"_id"}},{type:Backbone.HasMany,key:"annotations",relatedModel:"Scribd.Backbone.Annotation",collectionType:"Scribd.Backbone.AnnotationCollection",reverseRelation:{key:"document",includeInJSON:"_id"}}],t}(Backbone.RelationalModel),Scribd.Backbone.Document.setup(),Scribd.Backbone.WordUser=function(e){function t(){return this.is_admin=n(this.is_admin,this),t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.initialize=function(){if(!this.get("name"))return this.set("name",this.get("login"))},t.prototype.is_admin=function(){},t}(Backbone.RelationalModel),Scribd.Backbone.WordUser.setup(),Scribd.Backbone.CommentCollection=function(e){function t(){return this.url=n(this.url,this),this.next_page=n(this.next_page,this),this.fetch=n(this.fetch,this),this.page_info=n(this.page_info,this),this.parse=n(this.parse,this),this.comparator=n(this.comparator,this),t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.model=Scribd.Backbone.Comment,t.prototype.initialize=function(){return this.page=1,this.per_page=10,this.document_id=Scribd.current_doc.id},t.prototype.comparator=function(e){return-1*moment(e.get("_id"))},t.prototype.parse=function(e){return this.page=e.page,this.per_page=e.per_page,this.total=e.total,e.comments},t.prototype.page_info=function(){var e,t;return e={total:this.total,page:this.page,per_page:this.per_page,pages:Math.ceil(this.total/this.per_page),prev:!1,next:!1},t=Math.min(this.total,this.page*this.per_page),e.range=[this.page-1*this.per_page+1,t],this.page>1&&(e.prev=this.page-1),this.page<e.pages&&(e.next=this.page+1),e},t.prototype.fetch=function(e){var n,r,i=this;return e==null&&(e={}),r=function(){i.trigger("loaded");if(!i.page_info().next)return i.trigger("all_loaded")},e.success?(n=e.success,e.success=function(){return n(),r}):e.success=r,t.__super__.fetch.call(this,e)},t.prototype.next_page=function(){return this.page_info().next?(this.page+=1,this.fetch({add:!0,silent:!1})):!1},t.prototype.url=function(){var e;return e=$.param({page:this.page,per_page:this.per_page}),"/documents/"+this.document_id+"/comments?"+e},t}(Backbone.Collection),Scribd.Backbone.RootComments=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.sieve=function(e){return e.is_root()},t}(Backbone.Subset),Scribd.Backbone.DocumentCommentsView=function(t){function r(){return this.render=n(this.render,this),this.load_more_comments=n(this.load_more_comments,this),this.loaded=n(this.loaded,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.initialize=function(){var e,t;return this.render(),t=$(this.el).find(".document_comment_form:first"),Scribd.Backbone.current_user.get("blocked")&&t.hide(),e=$(this.el).find(".document_comments_collection:first"),this.comment_form=new Scribd.Backbone.CommentFormView({model:this.model,el:t,parent_view:this}),this.collection_view=new Scribd.Backbone.CommentCollectionView({collection:new Scribd.Backbone.RootComments(null,{parent:this.model.get("comments")}),el:e,parent_view:this}),this.model.get("comments").on("loaded",this.loaded)},r.prototype.events={"click .load_more":"load_more_comments"},r.prototype.loaded=function(){return this.$el.find(".load_more").removeClass("loading")},r.prototype.load_more_comments=function(){return e("more_comments_button"),this.$el.find(".load_more").addClass("loading"),this.model.get("comments").next_page()},r.prototype.render=function(){return this.$el.find(".load_more").hide(),this},r}(Backbone.View),Scribd.Backbone.CommentFormView=function(t){function r(){return this.submit_new_comment=n(this.submit_new_comment,this),this.require_login=n(this.require_login,this),this.template=n(this.template,this),this.enable_form=n(this.enable_form,this),this.filter_enter=n(this.filter_enter,this),this.input_changed=n(this.input_changed,this),this.show_error_message=n(this.show_error_message,this),this.disable_form=n(this.disable_form,this),this.render=n(this.render,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.initialize=function(){return this.render()},r.prototype.render=function(){return $(this.el).html(_.template(this.template())),this.$el.length&&this.$(".comment_text:first").val()&&this.$(".comment_text:first").val().length||this.$(".submit_button:first").addClass("disabled"),this},r.prototype.disable_form=function(){return this.$(".comment_text:first").attr("disabled",!0),this.$(".submit_button:first").addClass("disabled"),this.$(".loading:first").show(),this.disabled=!0},r.prototype.show_error_message=function(){return $("#comment_errors").text("There was an error submitting your comment. Please try again.")},r.prototype.input_changed=function(e){if(!this.$el)return;return this.$(".comment_text:first").val()&&this.$(".comment_text:first").val().length?this.$(".submit_button:first").removeClass("disabled"):$(".submit_button:first").addClass("disabled")},r.prototype.filter_enter=function(e){return e.keyCode===13?(e.preventDefault(),this.submit_new_comment(e),!1):!0},r.prototype.enable_form=function(){return this.disabled=!1,this.$(".comment_text:first").attr("value",""),this.$(".comment_text:first").attr("disabled",!1),this.$(".submit_button:first").removeClass("disabled"),this.$(".loading:first").hide()},r.prototype.template=function(){return this._template||(this._template=$(".comment_form_template").html())},r.prototype.events={"click .submit_button":"submit_new_comment","change .comment_text":"input_changed","keyup .comment_text":"input_changed","keydown .comment_text":"filter_enter","click .comment_text":"require_login","focus .comment_text":"require_login"},r.prototype.require_login=function(e){var t,n=this;if(!Scribd.logged_in)return typeof (t=$(e.target)).blur=="function"&&t.blur(),Scribd.with_login("Add Note",function(){})},r.prototype.submit_new_comment=function(t){var n=this;if(_(this.$(".comment_text:first").val()||"").chain().trim().isBlank().value())return;return e("submit_comment"),Scribd.with_login(function(){var e,t;if(!n.disabled){t={text:n.$(".comment_text:first").val()};if(n.model instanceof Scribd.Backbone.Document)e="document_id";else{if(!(n.model instanceof Scribd.Backbone.Annotation))throw"model must be an annotation or a document to be commented on.";e="annotation_id",t.document_id=n.model.get("document").get("_id")}return t[e]=n.model.get("_id"),n.model.get("comments").create(t,{wait:!0,error:n.show_error_message,complete:function(){return n.enable_form()}}),n.disable_form()}})},r}(Backbone.View),Scribd.Backbone.AnnotationCommentFormView=function(t){function r(){return this.submit_new_comment=n(this.submit_new_comment,this),this.template=n(this.template,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=function(){return this._template||(this._template=$(".annotation_comment_form_template").html())},r.prototype.submit_new_comment=function(t){var n=this;trackEvent("newdoc","Click","annotation_submit_reply",Scribd.logged_in?1:0);if(_(this.$(".comment_text:first").val()||"").chain().trim().isBlank().value())return;return e("submit_comment"),Scribd.with_login(function(){var e,t;if(!n.disabled){t={text:n.$(".comment_text:first").val()};if(n.model instanceof Scribd.Backbone.Document)e="document_id";else{if(!(n.model instanceof Scribd.Backbone.Annotation))throw"model must be an annotation or a document to be commented on.";e="annotation_id",t.document_id=n.model.get("document").get("_id")}return t[e]=n.model.get("_id"),t.parent_id=n.model.get("comments").first().get("_id"),n.model.get("comments").first().get("children").create(t,{wait:!0,error:n.show_error_message,complete:function(){return n.enable_form()}}),n.disable_form()}})},r}(Scribd.Backbone.CommentFormView),Scribd.Backbone.CommentReplyFormView=function(t){function r(){return this.submit_new_reply=n(this.submit_new_reply,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.events={"click .submit_button":"submit_new_reply","change .comment_text":"input_changed","keyup .comment_text":"input_changed","click .comment_text":"require_login","focus .comment_text":"require_login"},r.prototype.submit_new_reply=function(t){var n=this;if(!this.disabledthis)return e("submit_reply"),Scribd.Backbone.document.get("comments").trigger("change"),this.model.get("children").create({text:this.$(".comment_text:first").val(),document_id:this.model.get("document_id"),parent_id:this.model.get("_id")},{wait:!0,success:function(){return n.$el.hide()},error:this.show_error_message,complete:this.enable_form}),this.disable_form()},r}(Scribd.Backbone.CommentFormView),Scribd.Backbone.CommentView=function(t){function r(){return this.toggle_reply_form=n(this.toggle_reply_form,this),this.toggle_children=n(this.toggle_children,this),this.destroy_comment=n(this.destroy_comment,this),this.mark_spam=n(this.mark_spam,this),this.mark_ham=n(this.mark_ham,this),this.render=n(this.render,this),this.scroll_to_annotation=n(this.scroll_to_annotation,this),this.template=n(this.template,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.initialize=function(e){return this.render(),this.parent_view=e.parent_view,this.collection_view=new Scribd.Backbone.CommentCollectionView({collection:this.model.get("children"),el:$(this.el).find(".child_collection:first")}),this.comment_form=new Scribd.Backbone.CommentReplyFormView({model:this.model,el:$(this.el).find(".reply_form.nested:first").hide()}),this.model.on("change",this.render)},r.prototype.events={"click .children_toggle":"toggle_children","click .delete":"destroy_comment","click .reply":"toggle_reply_form","click .goto_annotation":"scroll_to_annotation","click .mark_spam":"mark_spam","click .mark_ham":"mark_ham"},r.prototype.template=function(){return this._template||(this._template=$(".comment_template").html())},r.prototype.scroll_to_annotation=function(){return $(".annotation").removeClass("on"),$.scrollTo($("#annotation_view_"+this.model.get("annotation").get("_id")).addClass("on")),$.scrollTo("-=60px")},r.prototype.render=function(){var e;if(this.model.isNew())return;return e=!!$(this.el).children().length,e||$(this.el).html(_.template(this.template(),this.model.toJSON())),this.model.viewable_children()||$(this.el).find(".children_toggle:first").remove(),this.model.is_viewable()?$(this.el).find(".comment_text:first").html(this.model.get("text")):$(this.el).remove(),this},r.prototype.mark_ham=function(e){if(this.$el.find(".mark_ham:first")===$(e.currentTarget))return this.model.mark_ham(),this.$el.children().flash()},r.prototype.mark_spam=function(e){if(this.$el.find(".mark_spam:first")[0]===e.currentTarget)return this.model.mark_spam()},r.prototype.destroy_comment=function(t){var n=this;return e("delete_button"),Scribd.with_login(function(){if(n.$(t.target).is(n.$(".delete:first")))return n.model.destroy({silent:!1,success:function(){}})})},r.prototype.toggle_children=function(t){e("toggle_children");if(this.$(t.target).is(this.$(".children_toggle:first")))return this.$(".children_toggle:first").toggleClass("closed"),this.$(".triangle").toggle(),this.collection_view.$el.slideToggle("fast")},r.prototype.toggle_reply_form=function(t){var n=this;if(this.model.get("deleted"))return;return e("reply_button"),Scribd.with_login(function(){if(n.$(t.target).is(n.$(".reply:first")))return n.comment_form.$el.toggle()})},r}(Backbone.View),Scribd.Backbone.CommentCollectionView=function(e){function t(){return this.render=n(this.render,this),this.template=n(this.template,this),this.remove_comment_view=n(this.remove_comment_view,this),this.add_comment_view=n(this.add_comment_view,this),t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.initialize=function(){var e,t,n,r;this.comment_views={},this.render(),r=this.collection.models;for(t=0,n=r.length;t<n;t++)e=r[t],this.add_comment_view(e);return this.collection.on("add",this.add_comment_view),this.collection.on("remove",this.remove_comment_view)},t.prototype.in_annotation_view=function(){return this._in_annotation_view||(this._in_annotation_view=this.$el.parents(".annotation").length>0)},t.prototype.add_comment_view=function(e){var t,n,r,i,s,o;if(this.comment_views[parseInt(e.get("_id"))])return;return this.in_annotation_view()?(t=parseInt((o=this.$el.find(".comment:first").attr("id"))!=null?o.replace(/\D/g,""):void 0),e.get("_id")<t?r=this.$el.find(".comments_list").prepend("<div></div>").find("div:first"):r=this.$el.find(".comments_list:first").append("<div></div>").find("div:last")):(i=parseInt((s=this.$el.find(".comment:first").attr("id"))!=null?s.replace(/\D/g,""):void 0),!e.get("_id")||e.get("_id")>i?r=this.$el.find(".comments_list").prepend("<div></div>").find("div:first"):r=this.$el.find(".comments_list:first").append("<div></div>").find("div:last")),n=new Scribd.Backbone.CommentView({model:e,el:r,parent_view:this}),this.comment_views[parseInt(e.get("_id"))]=n},t.prototype.remove_comment_view=function(e){var t,n;t=parseInt(e.get("_id")),n=this.comment_views[t];if(n.remove())return delete this.comment_views[t]},t.prototype.template=function(){return this._template||(this._template=$(".comment_collection_template").html())},t.prototype.render=function(){return this._rendered||(this._rendered=!0,$(this.el).html(this.template())),this},t}(Backbone.View),Scribd.Backbone.DocumentCommentCollectionView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return i(t,e),t}(Scribd.Backbone.CommentCollectionView)}).call(this);


/* app/views/read/_wide_downloads_format.coffee @ 1370554908 */
(function(){$(function(){var e,t=this;return $(".formats li").click(function(){return $(this).find("input.extension").attr("checked","true")}),e=function(){var e,t;return e=$(".document_formats_box input.extension").filter(":checked:visible").first().val(),t=Scribd.current_doc.download_url+"?extension="+e,Scribd.current_doc.secret_password&&(t+="&secret_password="+Scribd.current_doc.secret_password),window.location.href=t,Scribd.Lightbox.close(),Scribd.track_event(Scribd.content_discovery_version,"Click","WideDownloadButton",1)},$(".document_formats_box .formats_download_button").click(function(){return Scribd.download_actions.download_attempt(e,"read","download_promo",Scribd.current_doc)})})}).call(this);


/* :class_inlines, 'app/views', ... @ 1370554908 */
/* app/views/shared/dialogs/download_dialog.coffee @ 1370554908 */
(function(){Scribd.UI||(Scribd.UI={}),Scribd.UI.dispatch=function(e,t,n,r,i){var s,o,u;for(u in t){if(!t.hasOwnProperty(u))continue;s=$(e.target).parents().andSelf().filter("."+u);if(s.size()>0)return i||(e.stopPropagation(),e.preventDefault()),s.hasClass("disabled")?!0:(o=r?r+"_"+u:u,trackEvent("newdoc","Click",o,Scribd.logged_in?1:0),t[u].call(n,s,e),!0)}return!1},Scribd.UI.DownloadDialog=function(){function e(e,t){_.bindAll(this),this.options=_.extend({secret_password:"",extension_sizes:{},show_premium:!1},t||{}),this.container=$(e),this.radios=this.container.find(".download_types"),this.sizes_node=$("#document_sizes"),this.extensions_node=$("#document_extensions"),this.download_icon=this.container.find(".big_download_icon"),this.download_button=this.container.find(".download_button"),this.current_extension=this.getCurrentExtension(),this.document=this.options.document,this.download_query={secret_password:this.options.secret_password,source:this.options.source},this.autodown_query={secret_password:this.options.secret_password,source:this.options.source},this.updateExtension(this.current_extension),this.setupEvents()}return e.prototype.actions={download_button:function(){},try_again:function(){return Scribd.download_actions.download_dialog_lightbox(this.document)}},e.prototype.getCurrentExtension=function(){return this.radios.find("input:checked").val()},e.prototype.setupEvents=function(){var e,t=this;return this.actions_classes=function(){var t,n,r,i;r=_.keys(this.actions),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push("."+e);return i}.call(this).join(", "),this.radios.find("input").on("click",function(e){return t.updateExtension($(e.target).val())}),this.actions.download_button=this.options.show_premium?this.premiumDownloadHandler:this.downloadHandler,this.container.click(this.actions_classes,function(e){Scribd.UI.dispatch(e,t.actions,t,"download_dialog")})},e.prototype.downloadHandler=function(e){return window.location.href=this.downloadUrl(),this.container.addClass("download_started")},e.prototype.premiumDownloadHandler=function(){var e;return e=$.param.querystring("http://www.scribd.com/archive/plans",{doc:this.options.document_id}),window.location=e},e.prototype.updateExtension=function(e){var t;return this.current_extension=e,t=function(t,n){return n=$(n),n.data("ext")===e?n.show():n.hide()},this.extensions_node.find("span").each(t),this.sizes_node.find("span").each(t),this.download_icon.find(".icon_text").html(e),this.download_query.extension=e,this.autodown_query.autodown=e,this.download_button.find(".button_text").html("Download "+e)},e.prototype.downloadUrl=function(){return $.param.querystring(this.options.base_url,this.download_query)},e.prototype.autodownUrl=function(){return $.param.querystring(this.options.autodown_base_url,this.autodown_query)},e}()}).call(this);


/* app/views/readcast/dialog.coffee @ 1370554908 */
(function(){var e,t,n,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Scribd.UI=Scribd.UI||{},Scribd.TwitterAccount=function(){function e(e){this.name=e!=null?e:null}return e.link=function(e){return this.account||(this.account=new Scribd.TwitterAccount),this.account.link(e)},e.prototype.link_url="/twitter_link/new.js",e.prototype.test_url="/twitter_link.js",e.prototype.params="location=0,status=0,width=800,height=400",e.prototype.test_link=function(e){return $.ajax(this.test_url,{success:function(){return typeof e=="function"?e("linked"):void 0},error:function(){return typeof e=="function"?e("not-linked"):void 0}})},e.prototype.link=function(e){var t,n,r,i=this;return n=window.open(this.link_url,"twitterWindow",this.params),t=function(){clearInterval(r);if(!n.closed)return n.close()},r=setInterval(function(){var r;if(n.closed)return t();r=function(){try{return n.location.href||null}catch(e){}}();if(r!=null?r.match(/denied/):void 0)return t(),typeof e=="function"?e("not-linked"):void 0;if(r!=null?r.match(/oauth_token/):void 0)return t(),i.test_link(e)},200)},e}(),t=function(){function t(t){this.service_name=t;switch(this.service_name){case"facebook":return new e(this.service_name);case"twitter":return new n(this.service_name)}}return t.prototype.event_type="read",t.prototype.url_base="/readcast/",t.prototype.link_network=function(){throw"Don't know how to link network: "+this.service_name},t.prototype.submit=function(e,t){var n,r;return r=this.url_base+this.service_name+"/"+this.event_type,n=function(){switch(e.object_type){case"document":return{document_id:e.id};case"document_collection":return{document_collection_id:e.id};case"scribble":return{scribble_text:e.text}}}(),$.post(r,n,function(e){return typeof t=="function"?t(e):void 0})},t}(),n=function(e){function t(e){this.service_name=e}return a(t,e),t.prototype.link_network=function(e){return Scribd.TwitterAccount.link(e)},t}(t),e=function(e){function n(e){this.service_name=e}return a(n,e),n.prototype.actions={share:"{* actor *} shared this"},n.prototype.link_network=function(e){var t=this;return Scribd.facebook.login_and_link(function(t){return typeof e=="function"?e(t?"linked":"not-linked"):void 0})},n.prototype.url_for_facebook=function(e,t){return t==null&&(t="facebook"),e.split("#")[0]+("#source:"+t)},n.prototype.submit=function(e,n){var r=this;return Scribd.facebook.with_account(function(){return Scribd.facebook.with_permission("publish_stream",function(){return FB.api(r.api_path(e),"post",function(i){return t.prototype.submit.call(r,e,n)})})})},n.prototype.api_path=function(e){return"/me/"+Scribd.facebook.namespace+":"+"read"+"?"+e.object_type+"="+this.url_for_facebook(e.url)},n}(t);if(!Scribd.Readcasters){Scribd.Readcasters={},o=["scribd","twitter","facebook"];for(i=0,s=o.length;i<s;i++)r=o[i],Scribd.Readcasters[r]=new t(r)}Scribd.UI.ReadcastDialog=function(){function e(e,t){var n,r=this;this.object=t,this.container=$("#"+e),this.buttons=this.container.find(".link_unit"),this.container.on("click",".link_unit",function(e){return r.toggle_button($(e.currentTarget)),!1}),n=this,this.container.on("click",".submit_readcast",function(e){var t;return t=!1,r.buttons.each(function(){var e;e=$(this);if(e.hasClass("active"))return t=!0,n.mark_sent(e),n.send_to_network(e.data("network"))}),t?r.container.find(".actions").addClass("sent").find(".submit_message").css("opacity",0).fadeTo("slow",1):alert("Please pick a network to share to")})}return e.prototype.initiate_link=function(e){var t=this;return Scribd.Readcasters[e].link_network(function(n){if(n==="linked")return t.toggle_button(t.container.find("[data-network='"+e+"']").addClass("linked"),!0)})},e.prototype.send_to_network=function(e){var t;return(t=Scribd.Readcasters[e])!=null?t.submit(this.object):void 0},e.prototype.toggle_button=function(e,t){var n=this;return t==null&&(t=void 0),e.hasClass("linked")?(e.toggleClass("active",t),_.defer(function(){return e.find("input").attr("checked",e.hasClass("active"))})):this.initiate_link(e.data("network"))},e.prototype.mark_sent=function(e){return e.addClass("sent").find(".flag").css("opacity",0).fadeTo("fast",1)},e}()}).call(this);


/* app/views/shared/dialogs/collections_dialog.coffee @ 1370554908 */
(function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice;Scribd.Backbone=(e=Scribd.Backbone)!=null?e:{},Scribd.Backbone.DocumentCollectionsDialog=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.make_list=function(e){return new Scribd.Backbone.DocumentCollectionList([],e)},t.create_or_replace=function(e,t){var n,i,s,o,u=this;t==null&&(t={}),this.instance&&(this.instance.remove(),this.instance.undelegateEvents()),i=this.make_list(t),o={el:$(e),collection:i};for(n in t)s=t[n],o[n]=s;return this.instance=new this(o),i.fetch({silent:!1,success:function(){return i.trigger.apply(i,["fetch"].concat(r.call(arguments)))}}),this.instance},t.prototype.initialize=function(){return _.bindAll(this,"render"),this.list_view=new Scribd.Backbone.DocumentCollectionListView({el:this.$el.find(".list_view:first"),collection:this.collection}),this.collection.on("change",this.render),this.collection.on("add",this.render),this.render()},t.prototype.render=function(){return this.list_view.render()},t}(Backbone.View),Scribd.Backbone.PickCollectionDialog=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click .list_item":function(e){return $(e.target).addClass("selected"),this.$el.trigger("scribd:collection_picked",$(e.currentTarget).data("model").toJSON()),Scribd.Lightbox.close()}},t}(Scribd.Backbone.DocumentCollectionsDialog),Scribd.Backbone.AddToCollectionDialog=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click .save":function(e){if(!this.form_visible)return this.collection.save(),Scribd.Lightbox.close();if(this.form_view.save())return this.show_listing()},"click .cancel":function(e){return this.form_visible&&this.collection.length>0?(this.show_listing(),this.form_view.$el.find("textarea, input").val("")):Scribd.Lightbox.close()},"click .new_collection":function(e){return this.show_form()}},t.prototype.render=function(){return this.list_view.render(),this.form_view.render(),this.show_listing()},t.prototype.initialize=function(){return _.bindAll(this,"show_form","show_listing"),this.form_view=new Scribd.Backbone.DocumentCollectionFormView({el:this.$el.find(".form_view:first"),collection:this.collection}),t.__super__.initialize.apply(this,arguments)},t.prototype.show_form=function(){return this.$el.find(".title").text("Create a New Collection"),this.list_view.$el.hide(),this.form_view.$el.show(),this.form_visible=!0},t.prototype.show_listing=function(){return this.$el.find(".title").text("Add Documents to Your Collections"),this.list_view.$el.show(),this.form_view.$el.hide(),this.form_visible=!1},t}(Scribd.Backbone.DocumentCollectionsDialog),Scribd.Backbone.DocumentCollectionFormView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click .show_privacy":"show_privacy_options","focus #collection_name_input, #collection_description_input ":"clear_default","blur #collection_name_input, #collection_description_input ":"show_default"},t.prototype.initialize=function(){return _.bindAll(this,"show_privacy_options","save"),this.show_default({target:$("#collection_description_input")}),this.show_default({target:$("#collection_name_input")})},t.prototype.render=function(){return this.$el.find(".privacy_option").not(".default").hide(),this.$el.find(".privacy_option.default").show()},t.prototype.show_privacy_options=function(){return this.$el.find(".privacy_option").not(".default").show(),this.$el.find(".privacy_option.default").hide()},t.prototype.clear_default=function(e){var t;t=$(e.target);if(t.val()===t.data("default"))return t.removeClass("default"),t.val("")},t.prototype.show_default=function(e){var t;t=$(e.target);if(t.val()==="")return t.addClass("default"),t.val(t.data("default"))},t.prototype.is_valid=function(){var e;return e=this.$el.find("#collection_name_input").val(),!/^\s*$/.test(e)},t.prototype.save=function(){var e;return!this.is_valid()||this.$el.find("#collection_name_input").hasClass("default")?(this.$el.find(".new_collection_name .label").addClass("error"),this.$el.find(".action.error.hidden").removeClass("hidden"),!1):($(".new_collection_name .label").removeClass("error"),this.$el.find(".action.error").addClass("hidden"),Scribd.Backbone.new_collection=e=this.collection.create({combined_privacy_type:this.$el.find(".privacy_option input:radio:checked").val(),html_description:this.$el.find("#collection_description_input").val(),name:this.$el.find("#collection_name_input").val()},{wait:!0}),e.set("selected","1"),e.set("word_documents","1"),e.set("word_documents","1"),this.collection.add(e),e.isNew=function(){return!1},this.$el.find("input, textarea").empty())},t}(Backbone.View),Scribd.Backbone.DocumentCollectionView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click input[type=checkbox]":function(e){return this.model.set("selected",$(e.target).is(":checked"))}},t.prototype.initialize=function(){var e=this;return _.bindAll(this,"render","template"),this.render(),this.model.on("hide",function(){return e.$el.hide()}),this.model.on("show",function(){return e.$el.show()})},t.prototype.template=function(){return this._template||(this._template=_.template($(".collection_template").html()))},t.prototype.render=function(){return this.$el.html(this.template()(this.model.toJSON())),this.$el.find(".select_collection:first").prop("checked",parseInt(this.model.get("selected"),10)===1),this.model.original_selected&&this.$el.find(".inner_container:first").addClass("selected"),this.model.get("privacy_type")!=="private"&&this.$el.find(".private:first").hide(),this.$el.find(".list_item, input").val(this.model.id).data("model",this.model),this},t}(Backbone.View),Scribd.Backbone.DocumentCollectionListView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click .next_page":function(){return this.collection.next_page()},"click .prev_page":function(){return this.collection.prev_page()}},t.prototype.initialize=function(){return _.bindAll(this,"render","add_document_collection_view","remove_document_collection_view","clear_document_collection_views","paginator"),this.doc_collection_views={},this.collection.on("add",this.add_document_collection_view),this.collection.on("remove",this.remove_document_collection_view),this.collection.on("reset",this.clear_document_collection_views),this.collection.on("page_changed",this.paginator),this.render()},t.prototype.template=function(){return this._template||(this._template=$(".paginator_template").html())},t.prototype.render=function(){return this.collection.each(function(e){return e.render}),this.paginator()},t.prototype.paginator=function(){var e;if(this.collection.length>0)return $(this.el).find(".paginator").html(_.template(this.template(),this.collection.toJSON())),e=this.collection.page_info(),this.$el.toggleClass("hide_paginator",!e.next&&!e.prev),e.next?$(this.el).find(".paginator .next_page").removeClass("disabled"):$(this.el).find(".paginator .next_page").addClass("disabled"),e.prev?$(this.el).find(".paginator .prev_page").removeClass("disabled"):$(this.el).find(".paginator .prev_page").addClass("disabled");return},t.prototype.add_document_collection_view=function(e,t){var n;return this.doc_collection_views[e]=n=new Scribd.Backbone.DocumentCollectionView({model:e}),this.$el.find(".list_container").append(n.el),this.paginator()},t.prototype.remove_document_collection_view=function(e,t){var n;return n=this.doc_collection_views[e],n.$el.remove(),this.paginator()},t.prototype.clear_document_collection_views=function(){return this.$el.find(".list_container").empty(),this.paginator()},t}(Backbone.View),Scribd.Backbone.DocumentCollection=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.initialize=function(){return this.original_selected=!!parseInt(this.get("selected"),10),this.set("visible",!0),this.set("name",_.str.truncate(this.get("name"),30))},t.prototype.save=function(e,t){return this.isNew()?this.save_new(t.collection.document_id):this.get("selected")&&this.get("selected")!=="0"?this.add_document_to_collection(e):this.remove_document_from_collection(e)},t.prototype.add_document_to_collection=function(e){if(this.original_selected)return;return $.ajax(""+this.add_remove_url()+"/add_document",{type:"post",data:{document_id:e}})},t.prototype.remove_document_from_collection=function(e){if(!this.original_selected)return;return $.ajax(""+this.add_remove_url()+"/remove_document",{type:"delete",data:{document_id:e}})},t.prototype.save_new=function(e){if(!this.isNew())return;return $.ajax(this.save_url(),{type:"post",data:{"document_collection[combined_privacy_type]":this.get("combined_privacy_type"),"document_collection[html_description]":this.get("html_description"),"document_collection[name]":this.get("name"),format:"json",document_id:e},success:this.parse})},t.prototype.parse=function(e){return e.collections?e:e},t.prototype.save_url=function(){var e;return e=Scribd.named_current_user_sync().login,"/users/"+e+"/document_collections"},t.prototype.add_remove_url=function(){return"/document_collections/"+this.get("id")},t}(Backbone.Model),Scribd.Backbone.DocumentCollectionList=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.model=Scribd.Backbone.DocumentCollection,t.prototype.initialize=function(e,n){return _.bindAll(this,"page_changed"),this.view=n.view_mode||"add_document_to_collections",this.page=n.page||1,this.per_page=n.per_page||10,this.document_id=n.document_id,t.__super__.initialize.apply(this,arguments)},t.prototype.fetch=function(e){var t,n=this;return e=_.extend({add:!0},e),e.reset&&this.reset(),t=Backbone.Collection.prototype.fetch.call(this,e),t.done(function(){if(!e.silent)return n.trigger("fetch",n,e)}),t},t.prototype.page_info=function(){var e;return this.info!=null?this.info:(this.info={total:this.total,page:this.page,per_page:this.per_page,pages:Math.ceil(this.total/this.per_page),prev:!1,next:!1},e=Math.min(this.total,this.page*this.per_page),this.info.range=[(this.page-1)*this.per_page+1,e],this.start=this.info.range[0],this.end=this.info.range[1],this.page>1&&(this.info.prev=this.page-1),this.page<this.info.pages&&(this.info.next=this.page+1),this.last_page=this.page,this.info)},t.prototype.next_page=function(){return this.page_info().next?(this.page+=1,this.info=null,this.fetch({silent:!1,success:this.page_changed})):!1},t.prototype.prev_page=function(){return this.page_info().prev?(this.page-=1,this.info=null,this.fetch({silent:!1,success:this.page_changed})):!1},t.prototype.page_changed=function(){var e,t,n=this;return t=this.filter(function(e){return e.get("page")===n.page}),e=this.filter(function(e){return e.get("page")!==n.page}),_.each(t,function(e){return e.trigger("show")}),_.each(e,function(e){return e.trigger("hide")}),this.trigger("page_changed")},t.prototype.url_params=function(){var e;return e={view:this.view,page:this.page,per_page:this.per_page},this.document_id&&(e.document_id=this.document_id),e},t.prototype.toJSON=function(){return this.page_info(),{start:this.start,end:this.end,page:this.page,per_page:this.per_page,total:this.total}},t.prototype.save=function(){var e=this;return this.each(function(t){return t.save(e.document_id)})},t.prototype.url=function(){return"/my_document_collections.json?"+$.param(this.url_params())},t.prototype.parse=function(e){var t=this;return this.page=e.page,this.per_page=e.per_page,this.total=e.total,_.each(e.collections,function(e){return e.page=t.page}),e.collections},t}(Backbone.Collection)}).call(this);


/* app/views/read/ad_free_ad.coffee @ 1370554908 */
(function(){$(document).ready(function(){return $("#Doc_AdFree_300x250_container").parent().css({display:"block"}),$("#Doc_AdFree_300x250_pinned_container").parent().css({width:"300px",display:"block","margin-top":"25px"}),$("#rightcolumn_ad_gam").height()===0&&$("#rightcolumn_ad_gam .ad_free_ad_container").hide(),$("#leaderboard_ad_main").height()===0&&$("#leaderboard_ad_main .ad_free_ad_container").hide(),$("#pinned_ad_container").height()===0&&$("#pinned_ad_container .ad_free_ad_container").hide(),$(".ad_free_ad_container").on("click",".ad_free_ad",function(){return $(this).find("a.ad_free_link")[0].click()}),$(".ad_free_ad_container").on("click",".ad_close_button",function(){return $(this).removeClass("ad_close_button").addClass("ad_free_close_button"),$(this).siblings(".ad_free_ad").show(),$(this).closest(".ad_container").children(".hidden_on_ads_disabled").hide()}),$(".ad_free_ad_container").on("click",".ad_free_close_button",function(){return $(this).closest("#rightcolumn_ad_gam").remove(),$(this).closest("#leaderboard_ad_main").remove(),$(this).closest("#pinned_ad_container").remove()})})}).call(this);


/* app/views/read/_ads_below_sideboard.coffee @ 1370554908 */
(function(){Scribd.SetSidebarPromoStickiness=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;c=$("#sticky_sidebar"),o=$("#pinned_ad"),t=$("#pinned_ad_container"),s=$(".outer_page_container")[0],s||(s=$("#document_column"));if(!o||!t||!s)return;a=function(){return $("#download_formats").find(".new_formats_box").hide(),$("#download_formats").find(".mini_formats_box").hide(),$("#download_formats").find(".large_formats_box").show(),$("#download_formats").find(".feature_list").hide()},f=function(){return $("#download_formats").find(".new_formats_box").hide(),$("#download_formats").find(".mini_formats_box").show(),$("#download_formats").find(".large_formats_box").hide(),$("#download_formats").find(".feature_list").hide()},u=function(){return $("#download_formats").find(".new_formats_box").hide(),$("#download_formats").find(".mini_formats_box").hide(),$("#download_formats").find(".large_formats_box").show(),$("#download_formats").find(".feature_list").show()},l=function(){return Scribd.Ads.isVisible("Doc_Sideboard_HalfPage_Pinned_300x600")?a():u()},i=function(e){var t;return e==="full"?u():e==="med"&&a(),t=$("#download_formats").height(),l(),t},n=function(){return l()},e=null;try{e=Scribd.Ads.size("Doc_Sideboard_HalfPage_Pinned_300x600")}catch(p){e=0}h=null,r=null,e+i("full")<window.innerHeight?r=u:e+i("med")<window.innerHeight?r=a:r=f;if(c.length>0&&!c.hasClass("ab_test"))return Scribd.EasyStickyElement("sticky_sidebar",h,r,n)},$(document).ready(Scribd.SetSidebarPromoStickiness),$(document).on("scribd:ad_size_changed",Scribd.SetSidebarPromoStickiness)}).call(this);


/* app/views/read/annotation_dialog.coffee @ 1370554908 */
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Scribd.UI.AnnotationDialog=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){var t=this;return e==null&&(e={}),n.__super__.initialize.apply(this,arguments),this.$el.closest(".wrapper").css({margin:15}),this.$el.closest(".wrapper").find(".close_wrapper").hide(),Scribd.UI.annotation_first_time&&this.$el.addClass("first_time"),_.defer(function(){return t.input_changed()})},n.prototype.events={"click .comment_text":"require_login","click .tool.select_region":"select_region","change .comment_text":"input_changed","keyup .comment_text":"input_changed","click .submit_button":"submit_comment","click  .goto_comments":"goto_comments","click .reset_form":"reset_form"},n.prototype.input_changed=function(){var e;return e=this.$(".comment_text:first").val(),e&&e.length?this.$(".submit_button:first").removeClass("disabled"):this.$(".submit_button:first").addClass("disabled")},n.prototype.select_region=function(){var e=this;return trackEvent("newdoc","Click","annotation_select_region",Scribd.logged_in?1:0),Scribd.with_login("Add Note",function(){return e.$el.find(".tool.select_region").toggleClass("active"),Scribd.Popover.close(),Scribd.UI.Annotations.selector.enable(e.$el.find(".comment_text:first").val())})},n.prototype.require_login=function(){var e=this;return Scribd.with_login("Add Note",function(){})},n.prototype.goto_comments=function(){return trackEvent("newdoc","Click","annotation_see_all",Scribd.logged_in?1:0),$.scrollTo($("#comments_container")),Scribd.Popover.close()},n.prototype.reset_form=function(){return this.$(".comment_text:first").val(""),this.$el.removeClass("minimized success error first_time")},n.prototype.submit_comment=function(){var e,t,n;if(!this.$el.find(".comment_text:first").val().length)return;return trackEvent("newdoc","Click","annotation_post_note",Scribd.logged_in?1:0),n=Scribd.UI.Annotations.selector.selection(),Scribd.UI.Annotations.selector.disable(),t={text:this.$el.find(".comment_text:first").val(),word_user:Scribd.Backbone.current_user,document:Scribd.Backbone.document,document_id:Scribd.Backbone.document.get("_id")},n?(n=_.extend(n,{word_user:Scribd.Backbone.current_user,document:Scribd.Backbone.document,comments:[t]}),e=Scribd.Backbone.Annotation.build(n),e.save({wait:!0})):(t=Scribd.Backbone.Comment.build(t),t.save({wait:!0}),this.$el.addClass("minimized success"),_.delay(Scribd.Popover.close,5e3)),!0},n}(Backbone.View)}).call(this);


/* app/views/read/comments/annotations.coffee @ 1370554908 */
(function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=function(e,t){return function(){return e.apply(t,arguments)}};(e=Scribd.UI).Annotations||(e.Annotations={}),Scribd.UI.Annotations.Selector=function(){function e(e,t){this.container=$(e),this.form=$(t),this.prepare_document(),this.outer_page=$(".outer_page_container"),this.selection_el=null,this.selecting=!1,this.start_position=null,this.end_position=null}return e.prototype.prepare_document=function(){return $(".outer_page").each(function(e,t){var n;return n=$(t),n.data("page_num",n.prop("id").replace(/[A-Za-z-_]/g,""))})},e.prototype.fit_container=function(){return this.container.css({width:this.outer_page.width(),height:this.outer_page.height()})},e.prototype.selection=function(){var e,t;if(!this.start_position||!this.end_position)return;if(this.start_position.page&&this.end_position.page){if(Math.abs(this.end_position.page-this.start_position.page)>1)return;return t=$("#outer_page_"+this.start_position.page),e=$("#outer_page_"+this.end_position.page),{start_position:{page:this.start_position.page,page_width:t.width(),page_height:t.height(),x:this.start_position.x-t.position().left,y:this.start_position.y-t.position().top},end_position:{page:this.end_position.page,page_width:e.width(),page_height:e.height(),x:this.end_position.x-e.position().left,y:this.end_position.y-e.position().top}}}},e.prototype.disable=function(){var e;return $(".outer_page_container").removeClass("unselectable"),this.enabled=!1,this.container.removeClass("active"),this.container.off(),(e=this.selection_el)!=null&&e.remove(),this.selecting=!1,this.start_position=null,this.end_position=null},e.prototype.enable=function(e){var t=this;return $(".annotation.on").removeClass("on"),this.container.addClass("active"),$(".outer_page_container").addClass("unselectable"),this.default_comment_text=e,this.enabled=!0,this.fit_container(),this.outer_page.before(this.container),$(document).mousedown(function(e){return $(e.target).closest(t.selection_el).length||t.disable(),!0}),$(document).keydown(function(e){if(e.which===27&&t.enabled)return t.disable()}),$(document).mouseup(function(e){return t.selecting&&(t.selecting=!1,t.end_position=t.mouse_position(e),t.selection_el.untransify(),t.selection_el.width()>10&&t.selection_el.height()>10&&t.end_position.page-t.start_position.page<=1?(t.show_comment_form(),t.selection_el.transify()):t.selection_el.remove()),!0}),this.container.mousedown(function(e){var n;return $(e.target).closest(".comments_container").length?!0:(t.end_position=null,t.start_position=t.mouse_position(e),(n=t.selection_el)!=null&&n.remove(),t.selecting||(t.selection_el=$('<div class="selection_el selecting"></div>'),t.selecting=!0,t.selection_el.css({position:"absolute",left:t.start_position.x,top:t.start_position.y}),t.container.append(t.selection_el)),!1)}),this.container.mousemove(function(e){return t.selecting?(t.current_position=t.mouse_position(e),t.selection_el.untransify(),t.selection_el.css({width:Math.abs(t.current_position.x-t.start_position.x),height:Math.abs(t.current_position.y-t.start_position.y),left:Math.min(t.start_position.x,t.current_position.x),top:Math.min(t.start_position.y,t.current_position.y)}),t.selection_el.transify()):!0})},e.prototype.toggle=function(){return this.enabled?this.disable():this.enable()},e.prototype.show_comment_form=function(){if(!(this.selection_el.width()<10||this.selection_el.height()<10))return this.selection_el.html("<div class='comments_container'></div>"),this.comment_form=new Scribd.Backbone.AnnotationFormView({model:Scribd.Backbone.document,selection:this.selection(),selector:this,el:this.selection_el.children().first()}),this.selection_el.find(".comments_container:first").prepend($("<div class='read_sprite indicator'></div>")),this.selection_el.find(".comments_container").css("left",this.outer_page.width()-this.selection_el.position().left),this.selection_el.find(".comments_container").css("top",-4),this.selection_el.find(".comment_text:first").val(this.default_comment_text)},e.prototype.hide_comment_form=function(){if(this.comment_form)return this.comment_form.remove()},e.prototype.mouse_position=function(e){var t,n;return n={x:e.pageX-this.container.offset().left,y:e.pageY-this.container.offset().top},t=$.nearest(n,".outer_page").first(),t.length&&(n.page=parseInt(t.data("page_num")),n.page_width=t.width(),n.page_height=t.height()),n},e}(),Scribd.Backbone.Annotation=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.idAttribute="_id",t.prototype.urlRoot=function(){var e;return"/documents/"+((e=this.get("document"))!=null?e.get("_id"):void 0)+"/annotations/"},t.prototype.relations=[{type:Backbone.HasMany,key:"comments",relatedModel:"Scribd.Backbone.Comment",collectionType:"Scribd.Backbone.CommentCollection",reverseRelation:{key:"annotation"}},{type:Backbone.HasOne,key:"word_user",relatedModel:"Scribd.Backbone.WordUser"}],t}(Backbone.RelationalModel),Scribd.Backbone.Annotation.setup(),Scribd.Backbone.AnnotationCollection=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.model=Scribd.Backbone.Annotation,t.prototype.url=function(){var e;return"/documents/"+((e=this.document)!=null?e.get("_id"):void 0)+"/annotations/"},t.prototype.comparator=function(e){return e.get("start_position").y/e.get("start_position").page_height},t}(Backbone.Collection),Scribd.Backbone.AnnotationFormView=function(e){function t(){return this.submit_new_comment=r(this.submit_new_comment,this),this.toggle_privacy=r(this.toggle_privacy,this),t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click .submit_button":"submit_new_comment","change .comment_text":"input_changed","keyup .comment_text":"input_changed","click .comment_text":"require_login","click .toggle_privacy":"toggle_privacy","focus .comment_text":"require_login"},t.prototype.initialize=function(e){return e==null&&(e={}),this.selection=e.selection,this.selector=e.selector,this.privacy_setting="public",t.__super__.initialize.apply(this,arguments)},t.prototype.toggle_privacy=function(e){this.$(".setting").toggle();switch(this.privacy_setting){case"private":return this.privacy_setting="public";case"public":return this.privacy_setting="private"}},t.prototype.submit_new_comment=function(e){var t=this;trackEvent("newdoc","Click","annotation_post_note",Scribd.logged_in?1:0);if(_(this.$(".comment_text:first").val()||"").chain().trim().isBlank().value())return;return Scribd.with_login(function(){var e,n,r;if(!t.disabled){n={text:t.$el.find(".comment_text:first").val(),word_user:Scribd.Backbone.current_user,document:Scribd.Backbone.document,document_id:Scribd.Backbone.document.get("_id")};if(t.selection)return r=_.extend(t.selection,{word_user:Scribd.Backbone.current_user,privacy_setting:t.privacy_setting,document:Scribd.Backbone.document,comments:[n]}),e=Scribd.Backbone.Annotation.build(r),e.save(null,{wait:!0,silent:!1,add:!0,success:function(e){return Scribd.Backbone.document.get("annotations").add(e,{silent:!1}),Scribd.Backbone.document.get("comments").add(e.get("comments").first()),$(".annotation").removeClass("on"),$("#annotation_view_"+e.id).addClass("on"),t.selector.disable()}})}})},t}(Scribd.Backbone.CommentFormView),Scribd.Backbone.AnnotationView=function(e){function t(){return this.render=r(this.render,this),this.added=r(this.added,this),t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.events={"click .show_all":"show_all_comments","click .marker .indicator":"toggle_on","keydown .comment_text":"set_on","click .comments_container .show_form":"toggle_form","click .view_all_notes:first":"goto_comments"},t.COMMENT_CUTOFF=3,t.prototype.toggle_on=function(){return window.trackEvent("newdoc","Click","annotation_toggle_on",Scribd.logged_in?1:0),$(".annotation").not(this.$el).removeClass("on"),this.$el.toggleClass("on"),!1},t.prototype.set_on=function(){return $(".annotation").not(this.$el).removeClass("on"),this.$el.addClass("on"),!0},t.prototype.toggle_form=function(){return this.$el.find(".comments_container:first").toggleClass("form_visible"),!1},t.prototype.goto_comments=function(){return $.scrollTo($("#comments_container")),!1},t.prototype.show_all_comments=function(){return this.$el.find(".show_all").hide(),this.collection_view.show_all_comments(),!1},t.prototype.initialize=function(){return docManager.addEvent("zoomed",this.render),$(document).on("scribd:dom_height_changed",this.render),this.model.on("remove:comments",this.render),this.model.on("add:comments",this.added),this.model.on("change:comments",this.render),this.render(),this.delegateEvents(this.events)},t.prototype.added=function(){return this.model.get("comments").length>Scribd.Backbone.AnnotationView.COMMENT_CUTOFF?this.$el.find(".show_all").show():this.$el.find("show_all").hide(),this.render(),this.$el.find(".comments_container:first").removeClass("form_visible")},t.prototype.render=function(){var e,t,n,r,i=this;return this.model.isNew()?this:(t=this.model.get("comments").every(function(e){return!e.is_viewable()}),t?(this.$el.empty(),this._rendered=!1,this):(this._rendered||(this._rendered=!0,this.$el.html("<div class='selection'>\n</div>\n<div class='marker'>\n  <div class='read_sprite indicator' />\n  <div class='comments_container'>\n    <div class='comments_collection'></div>\n    <div class='root_form'></div>\n    <div class='bottom_tools'>\n      <a class='view_all_notes'>View all notes</span>\n      <a class='show_all' style='display: none'>Show all</span>\n    </div>\n  </div>\n</div>"),this.collection_view=new Scribd.Backbone.AnnotationCommentCollectionView({collection:new Scribd.Backbone.RootComments(null,{parent:this.model.get("comments")}),el:this.$el.find(".comments_collection:first"),parent_view:this}),this.comment_form=new Scribd.Backbone.AnnotationCommentFormView({model:this.model,el:this.$el.find(".root_form:last"),parent_view:this}),Scribd.Backbone.current_user||this.comment_form.hide(),r=function(){return i.$el.addClass("hover_on"),!0},n=function(){return _.delay(function(){return i.$el.removeClass("hover_on")},200),!0},this.$el.find(".marker:first").hover(r,n),this.model.get("comments").length>Scribd.Backbone.AnnotationView.COMMENT_CUTOFF&&this.$el.find(".show_all").show(),this.$el.attr("id","annotation_view_"+this.model.id),this.model.get("word_user")===Scribd.Backbone.current_user&&this.$el.addClass("mine"),this.model.get("privacy_setting")==="private"&&this.$el.addClass("private")),this.$el.css({top:this.model.get("start_position").y/(this.model.get("start_position").page_height/this.$el.parent().height())}),e=$("#outer_page_"+this.model.get("end_position").page).offset().top-$("#outer_page_"+this.model.get("start_position").page).offset().top,this.$el.find(".selection:first").css({left:this.model.get("start_position").x/(this.model.get("start_position").page_width/this.$el.parent().width()),width:Math.abs(this.model.get("end_position").x-this.model.get("start_position").x)/(this.model.get("start_position").page_width/this.$el.parent().width()),height:Math.abs(this.model.get("end_position").y-this.model.get("start_position").y)/(this.model.get("start_position").page_height/this.$el.parent().height()),top:e}),this.$el.find(".marker").css({left:$(".outer_page_container").width()-3}),this))},t}(Backbone.View),Scribd.Backbone.AnnotationCommentCollectionView=function(e){function t(){return this.add_comment_view=r(this.add_comment_view,this),t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.all_shown=!1},t.prototype.show_all_comments=function(){var e,t,n;n=this.comment_views;for(e in n)t=n[e],t.$el.show();return this.all_shown=!!this.comment_views.length},t.prototype.add_comment_view=function(e,n){var r;t.__super__.add_comment_view.apply(this,arguments);if(_.keys(this.comment_views).length>Scribd.Backbone.AnnotationView.COMMENT_CUTOFF&&!this.all_shown)return(r=this.comment_views[parseInt(e.get("_id"))])!=null?r.$el.hide():void 0},t}(Scribd.Backbone.CommentCollectionView),Scribd.Backbone.AnnotationCollectionView=function(e){function t(){return this.render=r(this.render,this),this.add_view=r(this.add_view,this),t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.initialize=function(){var e,t,n,r;this.annotation_views={},this.render(),r=this.collection.models;for(t=0,n=r.length;t<n;t++)e=r[t],this.add_view(e);return this.collection.on("add",this.add_view)},t.prototype.outer_page_container=function(){var e;if((e=this._outer_page_container)!=null?!e.length:!void 0)this._outer_page_container=this.$el.siblings(".outer_page_container");return this._outer_page_container},t.prototype.add_view=function(e,t){var n,r,i;if(parseInt(e.get("_id"))&&this.annotation_views[parseInt(e.get("_id"))])return;i=this.outer_page_container().children("#outer_page_"+e.get("start_position").page),i.append($('<div class="annotation"></div>')),r=i.find("div.annotation:last"),n=new Scribd.Backbone.AnnotationView({model:e,parent_view:this,el:r}),Scribd.UI.annotation_views?Scribd.UI.annotation_views<<n:Scribd.UI.annotation_views=[n];if(parseInt(e.get("_id")))return this.annotation_views[parseInt(e.get("_id"))]=n},t.prototype.render=function(){return this},t}(Backbone.View)}).call(this);


/* app/views/read/copy_link_dialog.coffee @ 1370554908 */
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Scribd.UI.CopyLinkDialog=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el=".follow_buttons",n.prototype.events={"click .toggle":"toggle_inputs","click .link_input":"select_input"},n.prototype.toggle_inputs=function(){return this.$el.find(".toggle, .hideable").toggle(200)},n.prototype.select_input=function(e){var t;return t=$(e.target),t.select(),!1},n}(Backbone.View)}).call(this);


/* app/views/read/_document_collection.coffee @ 1370554908 */
(function(){Scribd.UI.DocumentListPager=function(){function e(e){var t=this;this.container=e;if(!this.container)return;this.per_page=3,this.container.click(function(e){var n,r;r=[];for(n in t.actions)t.actions.hasOwnProperty(n)&&$(e.target).hasClass(n)?(t.actions[n].call(t,e),r.push(!1)):r.push(void 0);return r}),this.container.click(function(e){Scribd.UI.dispatch(e,t.tracking,t,null,!0)}),this.paginate()}return e.prototype.actions={next_page:function(){return this.goto_page(this.current_page+1)},prev_page:function(){return this.goto_page(this.current_page-1)}},e.prototype.tracking={scrolling_user_doc:function(){return trackEvent("newdoc","Scrolling","scrolling_user_doc",1)},scrolling_related_doc:function(){return trackEvent("newdoc","Scrolling","scrolling_related_doc",1)}},e.prototype.remove=function(){var e,t,n;e=this.container.parents(".sidebar_collections"),t=this.container.parents("div[data-name]"),n=t.data("name"),e.find(".tabs .tab[data-name='"+n+"']").remove(),t.remove();if(e.find(".tabs .tab").length===0)return e.remove()},e.prototype.paginate=function(){var e,t,n,r=this;return e=this.container.find(".pub_featured_doc"),e.length===0?this.remove():(n=1,t=Math.ceil(e.length/this.per_page),this.pages=[],_(e).each_slice(this.per_page,function(e){var i,s,o,u,a;o=$("<div class=related_page></div>");for(u=0,a=e.length;u<a;u++)i=e[u],o.append(i);return s=$("<div class='page_footer'></div>)"),n>1&&s.append($("<span class='prev_page pseudoLink'></span>").text("Prev")),n<t&&(s.is(":empty")||s.append(" &middot; "),s.append($("<span class='next_page pseudoLink'></span>").text("Next"))),s.is(":empty")||o.append(s),n++,o,r.pages.push(o)}),_(this.pages).each(function(e){return r.container.append(e)}),this.goto_page(1))},e.prototype.goto_page=function(e){var t,n,r,i,s,o;e=Math.max(1,Math.min(this.pages.length,e)),t=0;while(t<this.pages.length){r=this.pages[t];if(t+1===e){r.show(),o=r.find("img");for(i=0,s=o.length;i<s;i++)n=o[i],force_lzld(n)}else r.hide();t++}return this.current_page=e},e}()}).call(this);


/* app/views/read/_document_info.coffee @ 1370554908 */
(function(){Scribd.UI=Scribd.UI||{},Scribd.UI.enable_rating=_.once(function(){var e=this;if(!Scribd.current_doc.rating_url)return;return $("#document_starbox").starbox({autoUpdateAverage:!0,average:Scribd.current_doc.rating/5}).bind("starbox-value-changed",function(e,t){return Scribd.with_login("Please Log In to Rate this Document",Scribd.current_doc.url,function(){return $.ajax(Scribd.current_doc.rating_url,{type:"post",data:{rated:t*5}})})})})}).call(this);


/* app/views/read/_document_suggestions.coffee @ 1370554908 */
(function(){var e;e=function(){function e(t,n){var r,i=this;this.container=t,this.documents=n,this.container=$(this.container),this.auxiliary_docs,Scribd.content_discovery_version==="experiment_content_discovery_v3"||Scribd.content_discovery_version==="experiment_content_discovery_v4"?(this.auxiliary_docs=new Scribd.DocumentContainer(this.container.find("ul.dss_auxiliary_docs"),e.auxiliary_document_template_v2),this.auxiliary_docs.container_size=115):Scribd.content_discovery_version==="experiment_content_discovery_v6"||Scribd.content_discovery_version==="experiment_content_discovery_v5"?(this.auxiliary_docs=new Scribd.DocumentContainer(this.container.find("ul.dss_auxiliary_docs"),e.auxiliary_document_template_v3),this.auxiliary_docs.container_size=151):this.auxiliary_docs=new Scribd.DocumentContainer(this.container.find("ul.dss_auxiliary_docs"),e.auxiliary_document_template),this.initialized=!1,this.auxiliary_docs.animation_complete_callback=function(){return this.initialized||($("#sticky_sidebar").sticky_container({padding:40}),$("#sticky_sidebar").trigger("Scribd:update_root"),this.initialized=!0),r.auxiliary_docs.page_num===0?$(".dss_prev").addClass("disabled"):$(".dss_prev").removeClass("disabled")},this.auxiliary_docs_compact_height=120,this.auxiliary_docs_expanded_height,$(".dss_prev").click(function(){return i.auxiliary_docs.prev()}),$(".dss_next").click(function(){return i.auxiliary_docs.next()}),this.expanded_by_user,this.expanded=!0,r=this,$("#dss_toggle").click(function(){return r.expanded?r.compact():(this.expanded_by_user=!0,r.expand())}),this.update(),this.setup_analytics()}return e.prototype.setup_analytics=function(){var e,t,n;return t=0,n=0,e=0,_.each(this.documents,function(r){return r.type==="recommended"?t+=1:r.type==="user"?n+=1:e+=1}),t>0&&Scribd.track_event(Scribd.content_discovery_version,"Metrics","has_recommendations",1,!1),n>0&&Scribd.track_event(Scribd.content_discovery_version,"Metrics","has_user_docs",1,!1),e>0&&Scribd.track_event(Scribd.content_discovery_version,"Metrics","has_featured",1,!1),$("ul.dss_auxiliary_docs li").live("click",function(){$(this).attr("type")==="recommended"&&$(this).attr("score")&&$rat("recommended_document_click",$(this).attr("score")),Scribd.track_event(Scribd.content_discovery_version,"Click","auxiliary_docs",1),Scribd.track_event(Scribd.content_discovery_version,"Click","auxiliary_docs_position_"+$(this).attr("position"),1),Scribd.track_event(Scribd.content_discovery_version,"Click","auxiliary_docs_type_"+$(this).attr("type"),1),$(this).attr("score")&&Scribd.track_event(Scribd.content_discovery_version,"Click","auxiliary_docs_score",$(this).attr("score"));if($(window).scrollTop()>700)return Scribd.track_event(Scribd.content_discovery_version,"Click","below_fold_auxiliary_docs",1),Scribd.track_event(Scribd.content_discovery_version,"Click","below_fold_auxiliary_docs_position_"+$(this).attr("position"),1),$(this).attr("score")&&Scribd.track_event(Scribd.content_discovery_version,"Click","below_fold_auxiliary_docs_score",$(this).attr("score")),Scribd.track_event(Scribd.content_discovery_version,"Click","below_fold_auxiliary_docs_type_"+$(this).attr("type"),1)})},e.prototype.max_column_height=function(){var e,t,n;return n=Math.max($(window).height()-80,600),t=Scribd.UI.SearchSuggestions?250:0,e=$(".new_formats_box:visible").height(),Scribd.content_discovery_version==="experiment_content_discovery_v6"?n-180-t-(e?100:0):Scribd.content_discovery_version==="experiment_content_discovery_v4"?n-t-e:600-e},e.prototype.compact=function(){if(!this.expanded)return;return this.auxiliary_docs_expanded_height=this.auxiliary_docs.container.height(),this.auxiliary_docs.container.animate({height:this.auxiliary_docs_compact_height}),this.expanded=!1,$("#dss_toggle a").show(),$("#dss_pagination").hide()},e.prototype.expand=function(){if(this.expanded)return;return this.expanded=!0,this.auxiliary_docs.container.animate({height:this.auxiliary_docs_expanded_height}),$("#dss_toggle a").hide(),$("#dss_pagination").show()},e.prototype.update=function(e){return e==null&&(e=this.documents),this.documents=e,this.auxiliary_docs.max_size=this.max_column_height(),this.auxiliary_docs.update(e)},e}(),e.auxiliary_document_template='\n<div class="item"><a href= "/doc/{{ document.id }}">\n  <li position="{{position}}" score="{{ extra_information.score }}" type="{{type}}">\n    <img src="{{ document.image_url}}"/>\n    <div> \n      <p class="dss_title">{{ document.title }}</p>\n      <p class="dss_publisher">{{ document.word_user_name }}</p>\n    </div>\n  </li>\n</a></div>',e.auxiliary_document_template_v2='\n<div class="item"><a href= "/doc/{{ document.id }}">\n  <li position="{{position}}" score="{{ extra_information.score }}" type="{{type}}">\n    <img class="content_discovery_v2" src="{{ document.medium_image_url}}"/>\n    <div class="content_discovery_v2"> \n      <p class="dss_title">{{ document.title }}</p>\n      <p class="dss_publisher">{{ document.word_user_name }}</p>\n    </div>\n  </li>\n</a></div>',e.auxiliary_document_template_v3='\n<div class="item"><a href= "/doc/{{ document.id }}">\n  <li position="{{position}}" score="{{ extra_information.score }}" type="{{type}}">\n    <img class="content_discovery_v3" src="{{ document.large_image_url}}"/>\n    <div class="content_discovery_v3"> \n      <p class="dss_title">{{ document.title }}</p>\n      <p class="dss_publisher">{{ document.word_user_name }}</p>\n      <p class="dss_description">{{ document.description}}</p>\n    </div>\n  </li>\n</a></div>',Scribd.InitializeDocumentSuggestions=function(){var t,n,r,i;if(!Scribd.content_discovery_version)return;return n=[],r=JSON.parse($("#recommended_documents_blob").html()),t=JSON.parse($("#featured_documents_blob").html()),i=JSON.parse($("#user_documents_blob").html()),_.each(r,function(e){return e.type="recommended",n.push(e)}),_.each(i,function(e){var t;return e.type="user",(t=e.extra_information).score||(t.score=""),n.push(e)}),_.each(t,function(e){var t;return e.type="featured",(t=e.extra_information).score||(t.score=""),n.push(e)}),Scribd.UI||(Scribd.UI={}),Scribd.UI.DocumentSuggestions=new e($(".document_suggestions"),n)}}).call(this);


/* app/views/read/embed_dialog.coffee @ 1370554908 */
(function(){Scribd.UI||(Scribd.UI={}),Scribd.UI.CustomSize=function(){function e(e,t,n){var r=this;_.bindAll(this),this.embed_ui=e,this.container=$(t),this.book_mode=!1,this.options=_.extend({min_width:400,min_height:300,aspect_ratio:.75},n||{}),this.lock_aspect_ratio=!0,this.width_input=this.container.find(".custom_width"),this.height_input=this.container.find(".custom_height"),this.update_from_width=this.updater_for("width"),this.update_from_height=this.updater_for("height"),this.width_input.on("change",this.update_from_width),this.height_input.on("change",this.update_from_height),this.lock_button=this.container.find(".lock_button"),this.lock_button.on("click",function(){r.lock_button.toggleClass("unlocked"),r.lock_aspect_ratio=!r.lock_aspect_ratio;if(r.lock_aspect_ratio&&!r.width_input.val().length===0)return r.update_from_width()})}return e.prototype.values=function(){return[parseInt(this.width_input.val(),10),parseInt(this.height_input.val(),10)]},e.prototype.has_values=function(){return!this.width_input.val().length===0&&!this.height_input.val().length===0},e.prototype.updater_for=function(e){var t,n,r,i,s,o,u=this;return i=e==="width"?"height":"width",t=this.options.aspect_ratio,e==="height"&&(t=1/t),n=this[e+"_input"],s=this[i+"_input"],r="min_"+e,o="min_"+i,function(){var a,f;if(n.val().length===0)return;return u.book_mode&&(t=1/t),f=parseInt(n.val(),10),f<u.options[r]&&(f=u.options[r],n.val(f)),a=void 0,u.lock_aspect_ratio||s.val().length===0?(a=Math.max(Math.floor(f/t),u.options[o]),s.val(a)):a=u.embed_ui.custom_options[i],e==="width"?u.embed_ui.set_size(f,a):u.embed_ui.set_size(a,f)}},e}(),Scribd.UI.EmbedDialog=function(){function e(e,t,n){var r,i,s,o,u=this;_.bindAll(this),this.options=_.extend({num_pages:t.page_count,aspect_ratio:t.aspect_ratio,doc_url:t.url,title:t.title,user_url:(s=t.sharing_data.author)!=null?s.url:void 0,user_title:(o=t.sharing_data.author)!=null?o.name:void 0,doc_id:t.id,access_key:t.access_key,secret_password:t.secret_password},n||{}),this.aspect_ratio=t.aspect_ratio||.75,this.lock_aspect_ratio=!0,this.container=$(e),this.input=this.container.find(".code_input"),this.preview_container=this.container.find(".doc_preview"),this.custom_options={},this.generators={html:new Scribd.Embed.HTML5CodeGenerator({doc_url:this.options.doc_url,title:this.options.title,user_url:this.options.user_url,user_title:this.options.user_title,doc_id:this.options.doc_id,access_key:this.options.access_key,aspect_ratio:this.options.aspect_ratio}),wordpress:new Scribd.Embed.WordpressCodeGenerator({doc_id:this.options.doc_id,access_key:this.options.access_key})},this.container.find(".content").css("padding",0),this.view_style=$("#view_style"),this.include_document_link=$("#include_document_link"),this.include_recommendations=$("#include_recommendations"),this.starting_page=this.container.find(".misc_options .starting_page"),r=this.container.find(".custom_size input").add(this.starting_page),r.each(Scribd.restrict_input_to_numbers),this.custom_size=new Scribd.UI.CustomSize(this,this.container.find(".custom_size")),this.starting_page.on("change",function(e){var t,n;return n=u.starting_page.val().length===0?1:parseInt(u.starting_page.val(),10),t=u.options.num_pages,t!==null&&t!==0&&n>t&&(n=t,u.starting_page.val(n)),u.custom_options.page=n,u.update_code()}),this.view_style.on("change",function(e){var t;return t=u.view_style.val(),u.custom_options.mode=t,u.update_code(),!1}),this.input.on("focus",function(e){var t=this;return $(this).select(),this.onmouseup=function(){return t.onmouseup=null,!1},!1}),this.include_document_link.on("click",function(e){return u.custom_options.show_title=u.include_document_link.prop("checked"),u.update_code(),!0}),this.include_recommendations.on("click",function(e){return u.custom_options.show_recommendations=u.include_recommendations.prop("checked"),u.update_code(),!0}),this.container.on("click",".close",function(){return Scribd.Lightbox.close()}),this.container.on("click","#embed_format",function(e){var t;t=$(e.target);if(t.hasClass("inactive"))return t.removeClass("inactive"),u.container.find(".option.active").removeClass("active").addClass("inactive"),t.addClass("active"),u.update_format(t.data("format"))}),i=this.container.find(".size_picker"),i.find("li").on("click",function(e){var t,n,r,s,o;return n=$(e.target).parent("li").andSelf().filter("li"),n&&(i.find("li").removeClass("active"),n.addClass("active"),s=n.data("size"),s?(o=null,t=null,r=s.match(/(\d+)x(\d+)/),r&&(o=r[1],t=r[2]),u.set_size(o,t)):u.custom_size.has_values()&&u.set_size.apply(u,u.custom_size.values())),!1}),this.update_format("html")}return e.prototype.set_size=function(e,t){if(e===this.custom_options.width&&t===this.custom_options.height)return;return this.custom_options.width=e,this.custom_options.height=t,this.custom_options.auto_width=!e,this.custom_options.auto_height=!t,this.update_code()},e.prototype.update_format=function(e){return this.current_format=e,this.update_code()},e.prototype.update_code=function(e){var t,n=this;this.custom_options.mode==="book"?this.showing_book||(this.showing_book=!0,this.custom_size.book_mode=!0,this.toggle_sizes()):this.showing_book&&(this.showing_book=!1,this.custom_size.book_mode=!1,this.toggle_sizes()),this.input.val(this.generators[this.current_format].render(this.custom_options)),t=this.generators.html.render(),this.preview_container.show().html(t),_.defer(function(){var e;if(n.custom_options.auto_height&&n.custom_options.auto_width)return e={width:n.preview_container.width(),height:n.preview_container.height()},n.preview_container.find(".scribd_iframe_embed").css(e)});if(!e)return this.flash()},e.prototype.toggle_sizes=function(){return $(".size_picker:first").children().toggleClass("hidden"),$(".custom_size:first").removeClass("hidden")},e.prototype.flash=function(){var e;return e=this.container.find(".tab_bodies input").flash()},e}()}).call(this);


/* app/views/read/_follow_button.coffee @ 1370554908 */
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Scribd.UI.FollowButton=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el=".follow_buttons",n.prototype.events={"click .action":"submit"},n.prototype.initialize=function(){return this.submitting=!1},n.prototype.submit=function(e){var t=this;return e.preventDefault(),Scribd.with_login(function(){var e,n,r,i;t.submitting||t.$el.find(".home_btn").parent().toggle();if(t.submitting)return;return t.$el.find(".follow:visible").length?(e="delete",i="/"+Scribd.current_doc.author_id):(e="post",i=""),t.submitting=!0,n={"followship[publisher_id]":Scribd.current_doc.author_id,"followship[source]":"document_page",_method:e},r="/friends"+i+"?"+jQuery.param(n),n.authenticity_token=t.$el.find("[name=authenticity_token]").val(),$.ajax({url:r,type:"post",data:n,complete:function(){return t.submitting=!1}})})},n}(Backbone.View)}).call(this);


/* app/views/read/_mobile_signup_base.coffee @ 1370554908 */
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Scribd.UI.MobileSignup=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){var t=this;return e==null&&(e={}),n.__super__.initialize.apply(this,arguments),e.timeout_seconds||(e.timeout_seconds=10),this.$el.closest(".wrapper").css({margin:15}),this.type=e.type,Scribd.track_event("mobile_signup",this.type,"show_popover"),this.timeout=setTimeout(function(){if(t.$el.closest(".floating_popover").is(":visible"))return t.$el.closest(".floating_popover").hide(),Scribd.track_event("mobile_signup",t.type,"popover_timedout")},1e3*e.timeout_seconds)},n.prototype.events={"change .text_me_number":"input_changed","keyup .text_me_number":"input_changed","click .text_me_button":"submit_text","click a.send_email":"send_email","click a.sent_email":"send_email","mouseenter .mobile_signup":"cancel_timeout"},n.prototype.cancel_timeout=function(){return clearTimeout(this.timeout)},n.prototype.input_changed=function(){var e;return clearTimeout(this.timeout),e=this.$(".text_me_number").val(),e&&e.length?this.$(".text_me_button").removeClass("blocked"):this.$(".text_me_button").addClass("blocked")},n.prototype.submit_text=function(){var e,t,n=this;clearTimeout(this.timeout);if(this.$(".text_me_button").hasClass("blocked"))return;return this.$(".text_me_button").addClass("blocked"),t=this.$(".text_me_number").val(),e={phone_number:t,doc_id:Scribd.current_doc.id},$.post("/read/text_signup",e,function(e){return n.$(".text_me_button").removeClass("blocked"),Scribd.track_event("mobile_signup_sms_"+n.type,"click","success:"+e.valid),e.valid?(n.$("p.send_sms").show(),n.$("p.error_sms").hide(),n.$("p.send_sms").removeClass("send_sms").addClass("sent_sms"),n.$(".sent_sms.phone_number").text(n.$(".text_me_number").val())):(n.$("p.send_sms").hide(),n.$("p.error_sms").show())})},n.prototype.send_email=function(){var e=this;clearTimeout(this.timeout);if(this.$("p.send_email").hasClass("disabled"))return;return this.$("p.send_email").addClass("disabled"),$.post("/read/email_signup",function(t){Scribd.track_event("mobile_signup_email_"+e.type,"click","success:"+t.valid),e.$("p.send_email").removeClass("disabled");if(t.valid)return e.$("p.send_email").removeClass("send_email").addClass("sent_email")})},n}(Backbone.View)}).call(this);


/* app/views/read/_paginated_document_collection.coffee @ 1370554908 */
(function(){Scribd.UI.PaginatedDocumentCollection=function(){function e(e){var t=this;this.container=$(e),this.prev_page_button=this.container.find(".prev_page"),this.next_page_button=this.container.find(".next_page"),this.per_page=$("body.small_page_width").length?3:4,this.container.delegate_tracking("click","newdoc"),this.container.on("click",function(e){Scribd.UI.dispatch(e,t.actions,t)}),this.paginate()}return e.prototype.actions={next_collection_page:function(){return this.goto_page(this.current_page+1)},prev_collection_page:function(){return this.goto_page(this.current_page-1)}},e.prototype.paginate=function(){var e,t,n,r=this;e=this.container.find(".paginated_featured_doc");if(e.length===0){this.container.hide();return}return n=1,t=Math.ceil(e.length/this.per_page),this.pages=[],_(e).each_slice(this.per_page,function(e){var i,s,o,u;return o=$("<div class='related_page'></div>"),_(e).each(function(e){return o.append($(e))}),i=$("<div class='page_footer'></div>"),u=null,s=null,t>1&&(n>1&&(u=$("<span class='prev_collection_page pseudoLink'></span>").html(I18n.t("js.previous")),i.append(u)),n<t&&(u&&i.append(" | "),s=$("<span class='next_collection_page pseudoLink'></span>").html(I18n.t("js.next")),i.append(s))),o.append(i),n++,r.pages.push(o)}),_(this.pages).each(function(e){return r.container.append(e)}),this.goto_page(1)},e.prototype.goto_page=function(e){var t,n,r,i,s,o;e=Math.max(1,Math.min(this.pages.length,e)),n=0;while(n<this.pages.length){r=this.pages[n];if(n+1===e){r.show(),o=r.find("img");for(i=0,s=o.length;i<s;i++)t=o[i],force_lzld(t)}else r.hide();n++}return this.current_page=e},e}()}).call(this);


/* app/views/read/ppp/_action_badge.coffee @ 1370554908 */
(function(){Scribd.UI.ActionBadge=function(){function e(e,t){var n=this;$(e).on("click",function(){return Scribd.track_event("action_button",Scribd.current_doc.id,Scribd.named_current_user_sync().id),dataLayer.push({event:"other_buy_button"}),window.location=t})}return e}()}).call(this);


/* app/views/read/ppp/_multi_buy.coffee @ 1370554908 */
(function(){$(document).ready(function(){return $(".autogen_class_views_read_ppp_multi_buy .buttons a").click(function(e){var t,n;return t=$(this),n=t.data("store")||t.parents("[data-store]").data("store"),trackEvent("PPP multibuy click",Scribd.current_doc.author_id,n),dataLayer.push({event:""+n+"_buy_button"})})})}).call(this);


/* app/views/read/readcast_history_dialog.coffee @ 1370554908 */
(function(){var e,t,n,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};(i=window.Scribd)==null&&(window.Scribd={}),(s=Scribd.UI)==null&&(Scribd.UI={}),r={delete_readcast:function(e){var t;return t=Scribd.CSRF.with_token({_method:"delete"}),$.post("/readcast/"+e,t)},fetch_readcasts:function(e){return $.get("/readcast/all",{page:e})}},n=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return u(i,n),i.prototype.initialize=function(){var n=this;return _.bindAll(this),this.paginator=new t({page_size:10,item_count:this.options.readcast_count}),this.footer=new e({el:this.$(".footer"),paginator:this.paginator}),this.paginator.on("change:page",function(e){return n.update_page()}),this.paginator.on("change:item_count",function(e,t){return n.update_page(t)}),this.update_page(!1)},i.prototype.update_page=function(e){return e==null&&(e=!0),this.paginator.item_count===0?this.render_no_items():e?this.load_page().then(this.footer.update):this.footer.update()},i.prototype.events={"click .next_page":"next_page","click .prev_page":"prev_page","click .delete_button":"confirm_delete","click .cancel_button, .done_button":function(e){return Scribd.Lightbox.close()}},i.prototype.render_no_items=function(){var e;return e=Scribd.template("readcast_history_no_items")(),this.$(".items").replaceWith(e),this.footer.remove()},i.prototype.next_page=function(e){return e.preventDefault(),this.paginator.next()},i.prototype.prev_page=function(e){return e.preventDefault(),this.paginator.prev()},i.prototype.load_page=function(){var e=this;return r.fetch_readcasts(this.paginator.page).then(function(t){return e.$(".items").html(t)})},i.prototype.confirm_delete=function(e){var t,n,r;e.preventDefault(),t=$(e.currentTarget).closest(".item"),r=t.find(".item_title").text(),n='Are you sure you want to delete the readcasts for "'+r+'"?';if(confirm(n))return this.delete_item(t)},i.prototype.delete_item=function(e){var t,n;return r.delete_readcast(e.data("id")),e.addClass("deleted"),n=e.find(".item_title"),n.replaceWith("<span class='item_title'>"+n.text()+"</span>"),t=e.find(".item_date"),t.replaceWith("<span class='status'>Deleted</span>"),this.paginator.set_item_count(this.paginator.item_count-1),e.delay(2e3).slideUp(150)},i}(Backbone.View),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.initialize=function(){return _.bindAll(this),this.paginator=this.options.paginator,this.update()},t.prototype.update=function(){return this.update_status(),this.update_nav_buttons()},t.prototype.update_nav_buttons=function(){var e,t,n,r;return r=!this.paginator.at_first(),n=!this.paginator.at_last(),t=[[".prev_page",r],[".divider",r&&n],[".next_page",n]],e=this.$(".paginator"),_.each(t,function(t){var n,r,i;return r=t[0],i=t[1],n=e.find(r),i?n.show():n.hide()})},t.prototype.update_status=function(){var e,t,n,r,i,s;return s=this.paginator,n=s.page,r=s.page_size,t=s.item_count,i=Scribd.template("readcast_history_footer_status"),e=i({start:(n-1)*r+1,end:Math.min(n*r,t),count:t}),this.$(".footer_status").html(e)},t}(Backbone.View),t=function(){function e(e){var t;_.bindAll(this),this.item_count=e.item_count,this.page_size=e.page_size,this.page=e.page,(t=this.page)==null&&(this.page=1)}return _.extend(e.prototype,Scribd.Events),e.prototype.next=function(){if(this.at_last())throw new Error("Already on the last page");return this.trigger("change:page",++this.page)},e.prototype.prev=function(){if(this.at_first())throw new Error("Already on the first page");return this.trigger("change:page",--this.page)},e.prototype.at_first=function(){return this.page===1},e.prototype.at_last=function(){return this.page===this.max_page()},e.prototype.max_page=function(){return Math.ceil(this.item_count/this.page_size)},e.prototype.set_item_count=function(e){var t,n;if(e>=0)return this.item_count=e,n=this.page,this.page=Math.min(this.page,this.max_page()),t=this.page!==n,this.trigger("change:item_count",e,t);throw new Error("Item count must be at least 0")},e}(),Scribd.UI.ReadcastHistoryDialog=n}).call(this);


/* app/views/read/search/_base.coffee @ 1370554908 */
(function(){var e,t,n,r,i,s,o,u=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=Scribd.make_tracker("newdoc"),s=function(e){var t,n;return t=Scribd.current_doc.inline_search_auth.allowed_pages,t?(t=function(){var e,r,i,s;i=t.split(","),s=[];for(e=0,r=i.length;e<r;e++)n=i[e],s.push(parseInt(n,10));return s}(),u.call(t,e)>=0):!0},t=function(){function e(){var t,n,r,i;t=Scribd.current_doc.id,i=Scribd.current_doc.word_upload_id,n=Scribd.current_doc.secret_password,r=_.bind(this.track_rat_event,this),this.cache=new e.Cache(function(s,o){var u=this;return e.remote_search({query:s,doc_id:t,upload_id:i,secret_password:n,success:function(e){return e?(u.set(s,e),o(e),r("result.success",e.length)):(u.set(s,null),r("result.null"))},failure:function(e){return u.set(s,!1),o(!1),r("result.failed")}})}),this.query_history=[],this.query_history_index=0}return e.prototype.search=function(e,t){return this.query_history.push(e),this.query_history_index=this.query_history.length-1,this.track_rat_event("submit"),this.cache.fetch(e,t)},e.prototype.track_rat_event=function(e,t){var n,r;if(r=this.query_history[this.query_history_index])return n=[this.query_history_index,r],t!=null&&n.push(t),$rat("fourgen.toolbar.search."+e,n)},e}(),t.BASE_URL="/search-4gen",t.remote_search=function(e){var n;return n=$.extend({query:e.query,wordUploadId:e.upload_id,wordDocumentId:e.doc_id},Scribd.current_doc.inline_search_auth),e.secret_password!=null&&(n.secretPassword=e.secret_password),$.ajax(t.BASE_URL,{data:n,method:"post",dataType:"json",success:e.success,failure:e.failure})},t.Cache=function(){function e(e){this.cache={},this.miss_handler=_.bind(e,this)}return e.prototype.fetch=function(e,t){var n;return n=this.get(e),n!=null?t(n):this.miss_handler(e,t)},e.prototype.get=function(e){return this.cache[this._normalized_key(e)]},e.prototype.set=function(e,t){return this.cache[this._normalized_key(e)]=t},e.prototype._normalized_key=function(e){return e!=null?e.toUpperCase():void 0},e}(),e={highlight_class:"fourgen_highlight",highlight_text:function(e,t){var n,r,i,s=this;return i=RegExp(RegExp.escape(t),"i"),r=0,n=function(e){var o,u,a,f,l,c,h;l=0;if(e.nodeType===3)f=e.data.search(i),f>=0&&(c=$("<span>"),c.addClass(s.highlight_class),o=e.splitText(f),o.splitText(t.length),u=$(o).clone(),c.append(u),$(o).replaceWith(c),l=1,r++);else if(e.nodeType===1&&e.childNodes&&!/(script|style)/i.test(e.tagName))if(((h=e.className)!=null?h.indexOf(s.highlight_class):void 0)<0||e.className==null){a=0;while(a<e.childNodes.length)a+=n(e.childNodes[a]),++a}else r++;return l},n(e),r},remove_highlights:function(){var e,t,n,r,i,s;i=$("."+this.highlight_class),s=[];for(n=0,r=i.length;n<r;n++)e=i[n],t=e.parentNode,t.replaceChild(e.firstChild,e),s.push(t.normalize());return s}},n=function(){function e(e,t,n){var r;this.container=e,this.controller=t,this.event_name=n,this.input=this.container.find(".query").first(),this.form=this.container.find("form").first(),r=_.bind(this.search_submit,this),this.form.submit(r),this.form.find(".search_submit").click(r)}return e.prototype.val=function(e){return e!=null?this.input.val(e):this.input.val()},e.prototype.disable=function(){return this.form.addClass("disabled"),this.input.prop("disabled",!0)},e.prototype.enable=function(){return this.form.removeClass("disabled"),this.input.prop("disabled",!1)},e.prototype.search_submit=function(e){return o("Submit",this.event_name),this.controller.search(this.val()),!1},e}(),Scribd.UI.DocumentSearch=function(){function e(e){var s,u=this;this.container=e,this.searcher=new t,this.controller=new r(this.searcher,{on_clear:function(){return u.form.val(""),u.results.hide()}}),this.results=new i($("#document_search_results"),this),this.form=new n(this.container.find(".sidebar_search").first(),this.controller,"sidebar_search"),s=navigator.platform.match(/Mac/),s&&this.container.addClass("osx"),(Scribd.BrowserDetect.browser!=="Explorer"||Scribd.BrowserDetect.version>=9)&&this.container.addClass("hotkey_enabled"),$(document).keydown(function(e){if(e.keyCode===70&&(s&&e.metaKey||!s&&e.ctrlKey))return o("Hotkey","present_search"),u.results.present_for_search(),!1;if(u.results.visible){switch(e.keyCode){case 27:u.controller.reset_and_clear(),u.results.hide();break;case 38:u.controller.goto_prev_result();break;case 40:u.controller.goto_next_result();break;default:return}return!1}})}return e}(),i=function(){function e(e,t){var r=this;this.container=e,this.controller=t.controller,this.search_history=[],this.list_elm=this.container.find(".results_list").first(),this.form=new n(this.container.find(".popup_search").first(),this.controller,"popup_search"),this.controller.on("on_search",function(e,t){return r.show_loading(),t||r.search_history.push(e),r.render_search_history(),r.form.val(e),r.container.find(".last_query").text(e),r.form.disable()}),this.controller.on("on_results",function(e){var t,n,i,s;if(!r.visible)return;r.form.enable(),e.length===0?r.container.find(".scroller,.current_info").hide():r.container.find(".scroller,.current_info").show(),r.list_elm.empty();for(t=i=0,s=e.length;i<s;t=++i)n=e[t],r.list_elm.append(r.new_result_element(n.snippet,n.pageNum,t));return r.container.find(".num_results").text(e.length),e.length===1?(r.container.find(".plural").hide(),r.container.find(".non_plural").show()):(r.container.find(".plural").show(),r.container.find(".non_plural").hide()),r.done_loading()}),this.controller.on("on_select_result",function(e){var t,n,i,s,o,u,a,f,l;r.container.find(".current_result_num").text(e+1),o=r.list_elm.find("li.current_result").first(),o!=null&&o.removeClass("current_result"),i=r.list_elm.find("li").eq(e).addClass("current_result"),a=r.container.find(".scroller").first(),s=i.outerHeight(),u=a.innerHeight(),f=e*s,l=a.scrollTop();if(f<l)return a.scrollTop(f);n=l+u,t=f+s;if(t>n)return a.scrollTop(t-u)}),this.container.click(function(e){var t,n;if(Scribd.UI.dispatch(e,r.actions,r,"search"))return;t=$(e.target).closest("li");if((n=t.data("result_id"))!=null)return r.controller.goto_nth_result(n)}),this.controller.on("on_clear",function(){return r.form.val("")}),_.defer(_.bind(this.attach,this))}return e.prototype.padding=16,e.prototype.visible=!1,e.prototype.actions={next_result:function(){return this.controller.goto_next_result()},prev_result:function(){return this.controller.goto_prev_result()},close_button:function(){return this.controller.reset_and_clear(),this.hide()},history_result:function(e){var t;t=e.data("query");if(t===this.controller.query)return;return this.controller.search(t,!0)}},e.prototype.new_result_element=function(e,t,n){var r;return r=this.container.find(".result_template li").first().clone(),r.find(".inner_num").text(t),e?r.find(".snippet").html(this.highlight_snippet(e)):(e=r.find(".snippet"),e.text(I18n.t("js.newdoc.result_not_available_in_this_preview")),e.addClass("unavailable")),r.data("result_id",n),r},e.prototype.render_search_history=function(){var e,t,n,r,i,s,o,u,a,f;r=this.container.find(".history_list").first(),r.empty(),s=this.search_history.slice(-6).reverse();if(s.length<=1){this.container.find(".search_history").hide();return}this.container.find(".search_history").show(),o="  ",n=s.length-1,f=[];for(t=u=0,a=s.length;u<a;t=++u)i=s[t],e=$("<div>").text(i.substr(0,25)).addClass("history_result"),this.controller.query===i&&e.addClass("current"),e.data("query",i),r.append(e),t!==n?f.push(r.append($("<span>").text(o))):f.push(void 0);return f},e.prototype.show_loading=function(){return this.show(),this.container.addClass("loading"),this.container.removeClass("fresh_search"),this.container.removeClass("not_loading"),$(document).trigger("scribd:dom_height_changed")},e.prototype.done_loading=function(){return this.container.removeClass("loading"),this.container.addClass("not_loading"),$(document).trigger("scribd:dom_height_changed")},e.prototype.present_for_search=function(){return this.visible||this.container.addClass("fresh_search"),this.show(),this.render_search_history(),this.form.val(""),this.form.input.focus()},e.prototype.show=function(){return this.visible=!0,this.container.addClass("show_results"),this.form.enable()},e.prototype.hide=function(){return this.visible=!1,this.container.removeClass("show_results")},e.prototype.highlight_snippet=function(e,t){var n;return t==null&&(t=this.controller.query),n=new RegExp(RegExp.escape(t),"i"),_.escape(e).replace(n,'<span class="found">$&</span>')},e.prototype.attach=function(){var e,t=this;return e=$("#viewer"),Scribd.StickyElement(this.container,function(e){return e.css({position:"fixed",top:"auto",bottom:t.padding+"px"})},function(n){var r,i,s;return s=e.offset(),i=e.height(),r=t.container.height(),n.css({position:"absolute",bottom:"auto",top:s.top+i-t.padding-r+"px"})},function(t){var n,r,i,s;return n=$(window).height(),r=$(window).scrollTop(),s=e.offset(),i=e.height(),r+n<s.top+i},function(e){var t,n,r,i,s,o;return t=$("#document_column"),o=t.offset().left,s=t.width(),i=$(window).width(),r=e.width(),n=void 0,s>i?n=Math.floor((i-r)/2):n=Math.floor(o+s/2-r/2),e.css("left",n+"px")})},e}(),r=function(){function t(e,t){this.searcher=e,this.events=t!=null?t:{},this.reset(),docManager.addEvent("pageLoaded",_.bind(this.handle_page_loaded,this)),docManager.addEvent("expectedFirstPageChanged",_.bind(this.handle_page_changed,this))}return t.prototype.selected_classname=""+e.highlight_class+"_selected",t.prototype.on=function(e,t){return t._next_listener=this.events[e],this.events[e]=t},t.prototype.trigger=function(e,t){var n,r;n=this.events[e],r=void 0;while(n)r=n.apply(this,t||[]),n=n._next_listener;return r},t.prototype.search=function(e,t){if(e!=null)return this.reset(),this.query=e,this.trigger("on_search",[e,t]),this.searcher.search(this.query,_.bind(this.render_results,this))},t.prototype.reset=function(){return this.query=null,this.query_results=null,this.current_result=0,this.results_on_page={},this.highlighted_pages={},e.remove_highlights()},t.prototype.reset_and_clear=function(){return this.trigger("on_clear"),this.reset()},t.prototype.render_results=function(e){var t,n,r,i,s,o,u;if(this.query==null)return;e!=null&&e.length>0?(this.query_results=e,_.defer(_.bind(this.goto_current,this))):this.query_results=[],o=this.query_results;for(r=0,i=o.length;r<i;r++)t=o[r],(u=(n=this.results_on_page)[s=t.pageNum])==null&&(n[s]=[]),this.results_on_page[t.pageNum].push(t);return this.trigger("on_results",[this.query_results])},t.prototype.goto_current=function(){var e;return e=this.query_results[this.current_result],e.snippet&&this.goto_result(e),this.trigger("on_select_result",[this.current_result,e])},t.prototype.goto_nth_result=function(e){return this.current_result=Math.max(0,Math.min(e,this.query_results.length)),this.goto_current()},t.prototype.goto_next_result=function(){if(this.query_results===null)return;return this.current_result=(this.current_result+1)%this.query_results.length,this.goto_current(),this.trigger("next_result")},t.prototype.goto_prev_result=function(){if(this.query_results===null)return;return this.current_result--,this.current_result<0&&(this.current_result=this.query_results.length-1),this.goto_current(),this.trigger("prev_result")},t.prototype.goto_result=function(e){var t,n=this;t=e.pageNum;if(!s(t))return;return t!==docManager.currentPageNum()&&docManager.gotoPage(t),this.highlight_page(t,function(e){var r,i,s,o,u,a,f,l;s=0,i=n.current_result-1;while(i>=0&&n.query_results[i--].pageNum===t)s++;if(s<e.length)return r=$(e[s]),(l=n.last_highlight)!=null&&l.removeClass(n.selected_classname),r.addClass(n.selected_classname),n.last_highlight=r,o=$(r[0]).offset(),f=$(".sticky_bar .sticky_container.fixed").height(),a=10,u=o.top-f-a,window.scrollTo(o.left,u)})},t.prototype.handle_page_loaded=function(e){var t;return t=e.id.match(/^outer_page_(\d+)$/)[1],this.highlight_page(t)},t.prototype.handle_page_changed=function(e){return this.highlight_page(e)},t.prototype.highlight_page=function(t,n,r){var i,o,u,a,f,l,c=this;r==null&&(r=!0);if(!this.query||!s(t))return;l=function(){if(r){typeof n=="function"&&n($("#outer_page_"+t+" ."+e.highlight_class)),t!==1&&c.highlight_page(t-1,null,!1);if(t!==docManager.pageCount())return c.highlight_page(t+1,null,!1)}};if(this.has_highlighted_page(t))return l();this.set_highlighted_page(t),o=this.results_on_page[t];if(o!=null)return u=$("#outer_page_"+t),i=!1,a=this.query,f=function(n){var r,s,o;n==null&&(n=9);if(a!==c.query)return;return n>0&&!c.has_loaded_page(t)?setTimeout(function(){return f(n-1)},500):(s=0,o=new RegExp(RegExp.escape(a),"i"),r=e.highlight_text(u[0],a),i=!0)},f(),i?l():this.set_highlighted_page(t,!1)},t.prototype.has_loaded_page=function(e){return!!docManager.pages[e].innerPageElem},t.prototype.has_highlighted_page=function(e){return this.highlighted_pages["p"+e]===!0},t.prototype.set_highlighted_page=function(e,t){return t==null&&(t=!0),this.highlighted_pages["p"+e]=t},t}()}).call(this);


/* app/views/read/_search_suggestions.coffee @ 1370554908 */
(function(){var e;e=function(){function e(t,n){var r;this.container=t,this.documents=n,this.container=$(this.container),this.search_results=new Scribd.DocumentContainer(this.container.find("ul.dss_results"),e.search_result_document_template),this.search_results.animation_complete_callback=function(){return r.container.show(),$("#sticky_sidebar").sticky_container({padding:40}),$("#sticky_sidebar").trigger("Scribd:update_root")},this.search_element=$(".dss_search"),this.search_element.find("form").submit(function(){var e;return e=r.search_element.find("input.dss_search_input").val(),location.href="/search?query="+e,!1}),this.expanded=!0,r=this,this.update(),this.setup_analytics()}return e.prototype.setup_analytics=function(){return Scribd.track_event(Scribd.content_discovery_version,"Metrics","shown_results",this.search_results.max_elements(),!1),this.documents.search_documents&&Scribd.track_event(Scribd.content_discovery_version,"Metrics","showed_search_results",1,!1),$("ul.dss_results li").live("click",function(){return Scribd.track_event(Scribd.content_discovery_version,"Click","search_result_position",$(this).attr("position"))})},e.prototype.max_column_height=function(){return 280},e.prototype.update=function(e){e==null&&(e=this.documents),this.documents=e;if(e.search_documents)return this.search_results.max_size=this.max_column_height(),this.search_element.fadeIn(),this.search_results.update(e.search_documents),this.container.find("input").attr("placeholder",'"'+e.search_query+'"'),this.container.find("a.dss_view_more").attr("href","/search?query="+e.search_query)},e}(),e.search_result_document_template='\n<div class="item"><a href= "/doc/{{ document.id }}">\n  <li position="{{position}}">\n    <img src="{{ document.image_url}}"/>\n    <div> \n      <p class="dss_title">{{ document.title }}</h3>\n      <p class="dss_publisher">{{ document.word_user_name}}</h4>\n      <p class="dss_description">{{& extra_information.highlighted_search_description}}</p>\n    </div>\n  </li>\n</a></div>',e,$(function(){var t,n,r;return n=[],r={document:{title:"Another title",word_user_name:"Kobayashi Satoru",image_url:"http://upload.wikimedia.org/wikipedia/en/a/af/Go_Board%2C_Hoge_Rielen%2C_BelgiumEdit_Fcb981.jpg",id:128762067},extra_information:{highlighted_search_description:"pepe <strong>carlos</strong> javier"}},t={document:{title:"Hikaru no go",word_user_name:"Umezawa",image_url:"http://upload.wikimedia.org/wikipedia/en/a/af/Go_Board%2C_Hoge_Rielen%2C_BelgiumEdit_Fcb981.jpg",id:128762067},extra_information:{highlighted_search_description:"pepe <strong>carlos</strong> javier"}},n.push(r),n.push(t),n.push(r),n.push(t),n.push(r),Scribd.UI.read_referrer=function(){var t,r,i,s,o;s=document.referrer;if(window.location.hash==="#searchquery"||window.location.hash==="#searchquerymockdata")s="http://www.google.com.ar/url?sa=t&rct=j&q=maddie%20on%20things&souon-Things&ei=-s5lUZ2vN4f89gSu0YHgDA&usg=AFQjCNHwiLy92P_fiXuLn0rdcYCnnPKLtA";i=/[?&][pq]=([^&]+)/i,r=s.match(i);if(r)return t=r[1],o="/search?q="+t+"&from_read_page=1&format=json",$.get(o,function(r){var i,s;window.location.hash!=="#searchquerymockdata"&&(n=r);if(n.length!==0)return s={search_query:decodeURI(t),search_documents:n},Scribd.UI||(Scribd.UI={}),Scribd.UI.SearchSuggestions=new e($("#search_suggestions_container"),s),i=Scribd.UI.SearchSuggestions})},Scribd.UI.read_referrer()})}).call(this);


/* app/views/read/_section_list.coffee @ 1370554908 */
(function(){Scribd.UI.setup_section_list=function(e){return $(e).on("click","[data-first-page]",function(e){var t,n;return n=$(this),t=n.data("first-page"),document.location.hash="#page="+t,docManager.gotoPage(t),trackEvent("newdoc","Sectionized","TOC_NavClick"),!1})}}).call(this);


/* app/views/read/_sharer.coffee @ 1370554908 */
(function(){Scribd.UI.Sharer=function(){function e(e,t,n,r){this.container=$(e),this.options=r||[],this.autoshare=n,this.margin_left=this.options.margin_left||4,this.margin_top=this.options.margin_top||4,this.document_column=$(t),this.span_text=this.container.find("#sharing_status"),this.current_state=this.states.not_ready,this.autoshare_enabled()?(this.setup_events(),_.chain(this.attach).bind(this).defer(),this.set_state("ready")):this.container.addClass("hidden")}return e.prototype.setup_events=function(){var e=this;return this.container.on("mouseover",function(){if(e.current_state===e.states.ready)return e.span_text.text("Unshare")}),this.container.on("mouseout",function(){return e.span_text.text(e.current_state.text)}),this.container.on("click",function(){return e.current_state.click_action(e)}),_(this.autoshare.events).chain().pairs().each(function(t){var n,r;return n=t[1],r=t[0],$(document).on(n,function(){return e.set_state(r)})},this)},e.prototype.autoshare_enabled=function(){return Scribd.current_doc.auto_share.facebook},e.prototype.states={not_ready:{text:"...",click_action:function(){}},ready:{text:"Sharing...",click_action:function(e){return e.autoshare.stop(),e.set_state("stopped"),trackEvent("newdoc","Click","sharer_cancel",1)}},submitted:{text:"Shared",click_action:function(){}},stopped:{text:"Not Shared",click_action:function(){}}},e.prototype.current_action=function(){var e=this;return function(){return e.current_state.click_action}()},e.prototype.set_state=function(e){if(this.states[e]){this.current_state=this.states[e],this.reset_css(),this.container.addClass(e),trackEvent("newdoc","Share","share_state_"+e),this.span_text.text(this.current_state.text);if(e==="submitted"||e==="stopped")return this.container.hide(5)}},e.prototype.reset_css=function(){return _(this.states).chain().pairs().each(function(e){var t;return t=e[0],this.container.removeClass(t)},this)},e.prototype.attach=function(){var e,t,n,r,i;return t=function(e,t){var n,r;return n=i.document_column.position(),r=n.left+i.margin_left,r+"px"},i=this,n=this.container.height(),r=this.container.width(),e=!0,Scribd.StickyElement(this.container,function(e){var n;if(i.locked){i.set_locked_position();return}return n=i.document_column.offset(),e.css({position:"fixed",top:i.margin_top+"px",left:t(n.left,"fixed")})},function(r){var s,o,u;if(i.locked){i.set_locked_position();return}return o=i.document_column.offset(),u=void 0,e?u=o.top+i.margin_top:(s=i.document_column.height(),u=o.top+s-n-i.margin_top),r.css({position:"absolute",top:u+"px",left:t(o.left,"absolute")})},function(){var t,r,s;return i.options.fixed?!1:(s={top:$(window).scrollTop(),left:$(window).scrollLeft()},r=i.document_column.offset(),t=i.document_column.height(),s.top<=r.top?(e=!0,!1):r.top+t-s.top<n+i.margin_top?(e=!1,!1):!0)},function(){})},e.prototype.lock_position=function(){return this.locked=!0,this.locked_position=this.container.viewportOffset()},e.prototype.unlock_position=function(){return this.locked=!1,$(document).trigger("scribd:dom_height_changed")},e.prototype.set_locked_position=function(){return this.container.css({position:"fixed",top:this.locked_position.top+"px",left:this.locked_position.left+"px"})},e}()}).call(this);


/* app/views/read/show.coffee @ 1370554908 */
(function(){var e;this.Scribd||(this.Scribd={}),Scribd.UI||(Scribd.UI={}),this.read_quick_ajax_show_success=function(e){var t;if(e.disable_sale)return t=[],$("div.instant_access .description").hide(),$("div.buy_button_row").hide(),$("div.download_button_border").hide(),$("div.download_btn").hide(),$("div.missing_page_buy_button").hide(),$("div.group.main.animate a").hide(),$("div.instant_access span.country_name").html(e.country),$("div.unable_to_sell").show()},Scribd.alert_highjack=function(e,t){var n;return n=Scribd.Alerts.render,Scribd.Alerts.render=function(){return Scribd.Lightbox.current().id===e?t.apply(null,arguments_):n.apply(this,arguments_)}},Scribd.UI.dispatch=function(e,t,n,r,i){var s,o,u;for(u in t){if(!t.hasOwnProperty(u))continue;s=$(e.target).parents().andSelf().filter("."+u);if(s.size()>0)return i||(e.stopPropagation(),e.preventDefault()),s.hasClass("disabled")?!0:(o=r?r+"_"+u:u,trackEvent("newdoc","Click",o,Scribd.logged_in?1:0),t[u].call(n,s,e),!0)}return!1},Scribd.restrict_to_numbers=function(e){var t,n;n=void 0,e.keyCode?n=e.keyCode:e.which&&(n=e.which),t=String.fromCharCode(n);if(n===27)return this.blur(),!1;if(!e.ctrlKey&&n!==9&&n!==8&&n!==36&&n!==37&&n!==38&&n!==39&&n!==40&&n!==46)return t.match(/[0-9]/g)?!0:e.stopPropagation()},Scribd.restrict_input_to_numbers=function(e){return e=$(e),e.on("keypress",Scribd.restrict_to_numbers),e.on("change",Scribd.restrict_to_numbers)},Scribd.UI.setup_doc=function(e){var t,n,r,i,s,o,u;n=e.layout_format,u=e.scroll_to_page,o=e.reflow_quality_good,i=e.pmp_read,_gaq.push(["_setCustomVar",1,"newdoc_layout_format",n||"web"]),Scribd.trackSessionLength("newdoc","Metrics","SessionLengthSec"),i&&typeof $rat=="function"&&$rat("pmp_read",i),t=function(){var e,n,r;return $perf&&$perf.recordPerceivedLoadTime((new Date).getTime()),o&&$rat&&$rat("reflow",!0),o&&(window.performance&&window.performance.timing&&(e=(new Date).getTime()-window.performance.timing.fetchStart,r="perceived_load_time:"+(Scribd.logged_in?"logged_in":"logged_out"),trackEvent("reflow","plain",r,e,!1)),n=new Date,$(window).on("unload",function(){return trackEvent("reflow","plain","time_on_site2",parseInt((new Date-n)/1e3),!1)})),docManager.removeEvent("pageView",t),Scribd.Ads.load(),Scribd.setup_reading_history()},n==="reflow"?t():docManager.addEvent("pageView",t),docManager.addEvent("hideExtras",function(){return $("#sidebar").hide()}),docManager.addEvent("showExtras",function(){return $("#sidebar").show()}),r=$("#leaderboard_ad_main"),s=$("#profile_branding_banner"),s&&s.find("img").on("load",function(){return $(document).trigger("scribd:dom_height_changed")}),_.defer(function(){var e,t,n,r,i;e=window.location.hash.match(/^#(\w+)$/);if(e){e=e[1];switch(e){case"download":Scribd.sidebar_actions.download_button();break;case"collections":Scribd.social_actions.collections_button();break;case"fullscreen":case"full":_.defer(function(){return Scribd.UI.sticky_bar.action("zoom_full")})}}t=((n=window.location.hash.match(/\bpage=(\d+)/))!=null?n[1]:void 0)||((r=Scribd.current_doc)!=null?(i=r.reading_progress)!=null?i[0]:void 0:void 0)||u;if(t&&+t>1)return docManager.gotoPage(+t)}),Scribd.logged_in&&Scribd.current_doc.auto_share&&(new Scribd.Readcast.Event.AutoShare({doc:Scribd.current_doc.sharing_data,auto_submit:Scribd.current_doc.auto_share.twitter,service_type:"twitter",event_type:"read"})).start(),$("#admin_show_link, #admin_hidden_link").on("observe click",function(){return $("#admin_show").toggle(),$("#admin_hidden").toggle(),$(document).trigger("scribd:move_ads")}),(docManager&&docManager.pages?!$("#between_page_ads_3").length:!void 0)&&$(".sidebar").addClass("sticky_flush"),trackEvent("newdoc","Metrics","view",1,!1);if(Scribd.current_doc.signup_context!=null)return trackEvent("payments","newdoc",""+Scribd.current_doc.signup_context+":view")},$(document).on("scribd:docinfo_ready",function(){var e,t,n,r;if(Scribd.current_doc.show_age_gate&&typeof Scribd.BrowserDetect.is_bot=="undefined"){e=new Scribd.JSONCookie("session_metadata"),r=e.get("adult_ok"),t=(new Date).getTime()-r;if(!r||t>36e5)return window.stop?window.stop():document.execCommand&&document.execCommand("stop"),n=window.location.protocol+"//"+window.location.host+"/doc/protected/"+Scribd.current_doc.id,typeof Scribd.current_doc.section_id!="undefined"&&(n+="/"+Scribd.current_doc.section_id),window.location.href=n}}),Scribd.setup_reading_history=function(){if(window.docManager instanceof Scribd.ReflowDocManager)return;return new Scribd.ReadingProgress},Scribd.onAdFilled=function(e,t,n,r,i){var s,o,u;return s=void 0,o=void 0,u=0,i=i||2e4,r=r||1e3,s=e.height(),o=setInterval(function(){u+=1,u*r>i&&clearInterval(o);if(e.height()!==s&&e.height()>10)return n||clearInterval(o),t(e)},r)},Scribd.toggle_pagination=function(){var e,t;return Scribd.current_doc.is_owner&&new $.ajax("/newdoc/toggle_pagination_test",{type:"post",data:{id:Scribd.current_doc.id},success:function(){return window.location.reload()}}),t=Scribd.UI.is_paginated?"pagination":"not_paginated",trackEvent("newdoc","Pagination","revert_"+t,Scribd.logged_in?1:0),Scribd.logged_in?(e=new Scribd.JSONCookie("session_metadata"),e.get("pagination_disabled")?(e.unset("pagination_disabled"),Scribd.log("pagination enabled")):(e.set("pagination_disabled",!0),Scribd.log("pagination disabled")),e.save(),window.location.reload()):Scribd.login.open({context:"view_mode",callback:"Scribd.logged_in = true, Scribd.toggle_pagination()"})},Scribd.UI.scroll_to_top=function(){return $("#viewer").scrollTo()},Scribd.UI.prompt_login=function(e,t){return t=t||"#"+e,Scribd.login.open({context:e,next_url:Scribd.current_doc.url+t})},Scribd.UI.ensure_login=function(e,t,n){if(!Scribd.logged_in){Scribd.UI.prompt_login(t,n);return}return e()},Scribd.checkForOverrideLanguage=function(){var e,t,n,r;e=void 0,t=void 0,r=function(){var n,r,i;if(Scribd.current_doc.language_id===1)return!1;i=void 0;for(r in Scribd.I18n.languages)if(Scribd.current_doc.language_id===Scribd.I18n.languages[r].id){i=!0,e=Scribd.I18n.languages[r].prefix,t=Scribd.I18n.languages[r].lcid;break}return i?(n=document.cookie.match("lang=(.*?)(;|$)"),n?!1:document.referrer.indexOf("scribd.com")!==-1?!1:!0):!1};if(r())return n="/language?destination=http%3A%2F%2F"+e+".scribd.com"+encodeURIComponent(document.location.pathname)+"&id="+t,document.location=n},e=function(e){return Scribd.absolutizeAndPad(e),$(document).trigger("scribd:dom_height_changed")},jQuery.browser.webkit&&$(document).ready(function(){var t,n,r,i;if(Scribd.Ads.enabled){r=["leaderboard_ad_gam","rightcolumn_ad_gam"],i=[];for(n in Scribd.Ads.queuedForDisplay)Scribd.Ads.queuedForDisplay.hasOwnProperty(n)?(t=$("#"+n),t?i.push(Scribd.onAdFilled(t,e)):i.push(void 0)):i.push(void 0);return i}}),$(window).width()<1180&&(window.defaultViewWidth=691,$(document).ready(function(){return $("body").addClass("small_page_width")}))}).call(this);


/* app/views/read/show/base.coffee @ 1370554908 */
(function(){var e;e=function(){function e(e){this.buy_url=e}return e.prototype.setup_buy_buttons=function(e){var t,n=this;return t=$(document),t.ready(function(){var r;return Scribd.ServerOptions&&Scribd.ServerOptions.payments_store_disabled===!0?$(".missing_page_buy_button").hide():(Scribd.current_doc.is_pmp||Scribd.current_doc.can_purchase||Scribd.current_doc.show_archive_paywall?$(".missing_page_buy_link .btn_inner").text(e):$(".missing_page_buy_button").hide(),r=function(){if(Scribd.current_doc.is_pmp)return n.get_premium_callback("missing_page_signup");if(Scribd.current_doc.can_purchase)return n.get_buy_callback("button:click");if(Scribd.current_doc.view_restricted)return n.get_premium_callback("missing_page_signup")},t.click(function(e){return!Scribd.UI.dispatch(e,{missing_page_buy_button:r()},null,"paid")}))})},e.prototype.track_event=Scribd.make_tracker("payments"),e.prototype.get_buy_callback=function(e){var t=this;return function(){var n;return n=function(){return t.track_event("newdoc/store","buy_now"+e),window.location.href=t.buy_url},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(n):n(),!1}},e.prototype.get_premium_callback=function(e){var t=this;return function(){var n,r,i;return n={context:Scribd.current_doc.signup_context,page:"read",action:e,platform:"web",logged_in:!!Scribd.logged_in||!!Scribd.anonymous_current_user_sync()},n=encodeURIComponent(JSON.stringify(n)),r="doc="+Scribd.current_doc.id+"&metadata="+n,i=function(){return t.track_event("newdoc",""+Scribd.current_doc.signup_context+":missing_page_button:click"),window.location.href="/archive/plans?"+r},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(i):Scribd.anonymous_current_user_sync()?i():Scribd.LoginLightbox.remote_open("archive_lb","/archive/login?"+r,Scribd.toolbar_params()),!1}},e}(),Scribd.UI.BuyDocManager=e}).call(this);


/* app/views/read/show/reflow.coffee @ 1370554908 */
(function(){var e;e=function(){function e(){var e,t,n,r,i;this.currentPageNum=this.pageCount=function(){return 1},this.viewMode=function(){return"reflow"},t=["fireEvent","removeEvent","addEvent","gotoNextPage","gotoPreviousPage","gotoPage","zoom","enterFullScreen","exitFullScreen"],e=function(){};for(r=0,i=t.length;r<i;r++)n=t[r],this[n]=e}return e}(),Scribd.ReflowDocManager=e,Scribd.UI.setup_reflow=function(){var e;Scribd.UI.is_reflowed=!0,e=+(new Date),trackEvent("reflow","plain","hit",Scribd.logged_in?1:0),Scribd.trackSessionLength("reflow","plain","time_on_site");if($rat)return $rat("reflow",!0)}}).call(this);


/* app/views/read/show/sectionized_reflow.coffee @ 1370554908 */
(function(){var e,t,n,r,i,s,o;n="buPe",e=function(){return document.getElementById(n+0)!==null},i=function(e,t){var r,i,s,o,u,a;if(!t)return;i=Math.floor(t),s=document.getElementById(n+i);if(!s)return;return r=t-i,u=e.get_top(s),a=e.add_bottom(s,u),o=u+(a-u)*r,$.scrollTo?$.scrollTo(o,{duration:600}):scrollTo(0,o)},r=function(e,t){var n;return n=setTimeout(function(){return i(e,t)},1500),$(document).on("scroll",function(){return n&&clearTimeout(n),n=void 0})},window.epub={},window.epub.scroll_to_paragraph=i,$(document).ready(function(){var t,n,i,s;if(e())return n=new Scribd.SectionizedReflowReadingProgress({huge_jump:10}),t=typeof Scribd!="undefined"&&Scribd!==null?(i=Scribd.current_doc)!=null?(s=i.reading_progress)!=null?s[0]:void 0:void 0:void 0,window.epub.initial_reading_position=t,r(n,t),check_fontface_fonts()}),((o=Scribd.current_doc)!=null?o.document_type:void 0)==="epub_reflow"&&(s=38,t=7,$(document).ready(function(){var e,n;n=$("#chunk"),n.outerHeight()||n.height(821);if(e=window.location.hash){e=$(""+e+",[name="+e.substring(1)+"]");if(e.length&&e.css("top")==="auto")return $(document).scrollTop($(document).scrollTop()-(s+t))}}))}).call(this);


/* app/views/read/_sidebar.coffee @ 1370554908 */
(function(){Scribd.sidebar_actions={download_button:function(){return Scribd.download_actions.download(Scribd.current_doc.id,"read","sidebar_download")},formats_download_button:function(){var e;return e=function(){var e,t;return e=$("#sidebar input.extension").filter(":checked:visible").first().val(),t=Scribd.current_doc.download_url+"?extension="+e,Scribd.current_doc.secret_password&&(t+="&secret_password="+Scribd.current_doc.secret_password),window.location.href=t,Scribd.Lightbox.close()},Scribd.download_actions.download_attempt(e,"read","download_promo",Scribd.current_doc)},delete_document_button:function(){var e,t;t=void 0;if(!Scribd.current_doc.is_deletable)return t=I18n.t("js.this_document_could_not_be_deleted"),alert(t);e=$("#delete_form"),t=$("#delete_form_message").html();if(confirm(t))return e.submit()},request_putback_button:function(){if(Scribd.current_doc.is_owner)return $("#request_putback_spinner").show(),$.ajax("/doc/request_putback/"+Scribd.current_doc.id,{success:function(e){return $("#request_putback_dialog").hide(),$("#request_putback_spinner").hide(),$("#request_putback_requested").show()},failure:function(e){return $("#request_putback_spinner").hide(),$("#request_putback_error").show()}})},flag_button:function(){var e=this;return Scribd.with_login("Flag Document",Scribd.current_doc.url,function(){return Scribd.Lightbox.remote_open("lightbox_flag_document","/read/flag_dialog",Scribd.toolbar_params())})},add_to_collection_btn:function(){var e=this;return Scribd.with_login("Add to Collection",Scribd.current_doc.url,function(){return Scribd.Lightbox.remote_open("lightbox_document_collections","/read/collections_dialog",Scribd.toolbar_params())})}},Scribd.UI.Sidebar=function(){function e(e){var t,n=this;this.container=$(e),t=function(e){var t;return t=n.container.find(".privacy_indicator:first"),e?t.show():t.hide(),$(document).trigger("scribd:move_ads")},this.container.find(".privacy_control input").on("change",function(e){var n,r=this;return n=$(e.target).val(),t(n==="private"),$.ajax("/documents/make_"+n,{type:"post",data:Scribd.CSRF.with_token({document_ids:Scribd.current_doc.id}),dataType:"json",failure:function(e){return t(n!=="private")}})}),this.container.has_expandable_text(),this.container.on("click",function(e){Scribd.UI.dispatch(e,Scribd.sidebar_actions,this.container)}),Scribd.UI.enable_rating(),$("#download_formats").length&&this.setup_download_formats_box(),this.setup_print_handler()}return e.prototype.setup_print_handler=function(){var e,t,n,r,i;if(!Scribd.current_doc.downloadable_for_premium_users)return;return e=!1,t=3e3,n=function(n){if(!e)return e=!0,Scribd.track_event("newdoc","print","handle:"+n),Scribd.Lightbox.remote_open("print_dialog","/read/print_dialog",Scribd.toolbar_params()),window.setTimeout(function(){return e=!1},t)},typeof window.matchMedia=="function"&&window.matchMedia("print").addListener(function(){return n("match_media")}),i=window.onbeforeprint,window.onbeforeprint=function(){return n("on_before_print"),typeof i=="function"&&i(),!1},r=navigator.platform.match(/Mac/),$(document).keydown(function(e){if(e.keyCode==="P".charCodeAt(0)&&(r&&e.metaKey||!r&&e.ctrlKey))return n("keydown"),!1})},e.prototype.setup_download_formats_box=function(){return Scribd.Ads.load(function(){return Scribd.Ads.RefreshUnit.all.Doc_Sideboard_HalfPage_Pinned_300x600&&$("#download_formats").length?$("#download_formats").find(".feature_list").hide():$("#pinned_ad_container").remove()})},e}()}).call(this);


/* app/views/read/sidebar/_admin.coffee @ 1370554908 */
(function(){$(document).ready(function(){var e,t;return $("a#toggle_admin").click(function(){return $("#admin_show").is(".open")?$("#admin_show").removeClass("open"):$("#admin_show").addClass("open"),!1}),$("a#admin_delete_document").click(function(){return confirm("WARNING! Are you sure you want to delete this document?")&&$("#admin_delete_document_form").submit(),!1}),t=!0,$("a#admin_feature_document").click(function(){var e=this;return t&&(t=!1,$(this).addClass("disabled"),$("form#admin_feature_document_form").ajaxSubmit({success:function(){var n,r,i;return i=$("form#admin_feature_document_form input[name=featured]"),r=JSON.parse(i.val()),i.val(JSON.stringify(!r)),n=r?"Unf":"F",$(e).text("[ "+n+"eature ]"),t=!0,$(e).removeClass("disabled")},failure:function(){return alert("failed to feature the document"),t=!0,$(this).removeClass("disabled")}})),!1}),e=!0,$("a#admin_bless_document").click(function(){var t=this;return e&&(e=!1,$(this).addClass("disabled"),$("form#admin_bless_document_form").ajaxSubmit({success:function(){var n,r,i;return i=$("form#admin_bless_document_form input[name=enabled]"),r=i.val()==="1",i.val(r?"0":"1"),n=r?"Unb":"B",$(t).text("[ "+n+"less ]"),e=!0,$(t).removeClass("disabled")},failure:function(){return alert("failed to bless the document"),e=!0,$(this).removeClass("disabled")}})),!1})})}).call(this);


/* app/views/read/_sticky_bar.coffee @ 1370554908 */
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].slice;Scribd.UI.StickyBar=function(){function n(t,n,r,i){this.update_page_from_input=e(this.update_page_from_input,this),this.update_dimensions=e(this.update_dimensions,this),this.on_update_page_num=e(this.on_update_page_num,this),this.update_page_num=e(this.update_page_num,this),this.get_highest_page=e(this.get_highest_page,this),this.goto_page=e(this.goto_page,this),this.update_zoom_out_clickability=e(this.update_zoom_out_clickability,this),this.zoom_changed=e(this.zoom_changed,this),this.set_group_width=e(this.set_group_width,this),this.set_absolute_position=e(this.set_absolute_position,this),this.set_fixed_position=e(this.set_fixed_position,this),this.attach=e(this.attach,this),this.setup_page_picker=e(this.setup_page_picker,this),this.resize_epub_font=e(this.resize_epub_font,this),this.show_off_tooltips=e(this.show_off_tooltips,this),this.setup_events=e(this.setup_events,this),this.setup_readcast_popup=e(this.setup_readcast_popup,this),this.spacer=$(t),this.document_column=$(n),this.sidebar=$(r),this.container=this.spacer.find(".sticky_container"),this.main_group=this.container.find(".main:first"),this.zoom_group=this.container.find(".zoom:first"),this.paging_group=this.container.find(".paging:first"),this.social_group=this.container.find(".social:first"),this.actions_container=this.container.find(".actions_container:first"),this.page_input=this.container.find(".page_input:first"),this.readcast_indicator=this.container.find(".readcast:first"),this.cookie_jar=new CookieJar({path:"/",expires:31104e4}),this.spacer_padding=parseInt(this.spacer.css("padding-top"),10),this.options=i||[],this.fixed=!1,this.scroll_effects=0,this.font_size=1,this.hovering=!1,_.defer(this.attach),this.setup_readcast_popup(),this.set_absolute_position(),this.setup_events(),this.update_zoom_out_clickability(),this.show_off_tooltips()}return n.prototype.transition_time=.2,n.prototype.action=function(){var e,n,r;return n=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],(r=this.actions[n])!=null?r.call.apply(r,[this].concat(t.call(e))):void 0},n.prototype.actions={comment:function(){return Scribd.Popover.remote_open("annotation_dialog",this.container.find(".action.comment"),"/read/annotation_dialog",Scribd.toolbar_params(),{close:!0})},download_btn:function(){return Scribd.download_actions.download(Scribd.current_doc.id,"read","stickybar_download")},buy_btn:function(){var e,t;return e=this.container.find(".action.buy_btn").attr("href"),t=function(){return window.location.href=e},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(t):t(),!1},pmp_signup_btn:function(){var e,t,n;return e={context:Scribd.current_doc.signup_context,page:"read",action:"stickybar_download",platform:"web",logged_in:!!Scribd.logged_in||!!Scribd.anonymous_current_user_sync()},e=encodeURIComponent(JSON.stringify(e)),t="doc="+Scribd.current_doc.id+"&metadata="+e,n=function(){return window.location="/archive/plans?"+t},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(n):Scribd.anonymous_current_user_sync()?n():Scribd.LoginLightbox.remote_open("archive_lb","/archive/login?"+t,Scribd.toolbar_params()),!1},embed:function(){return Scribd.Lightbox.remote_open("embed_dialog","/read/embed_dialog",Scribd.toolbar_params()),$rat("sharebox.viewbar.more_share_options")},link:function(){return Scribd.Popover.remote_open("copy_link_dialog",this.container.find(".action.link"),"/read/copy_link_dialog",Scribd.toolbar_params(),{close:!0})},bookmark:function(e){var t,n,r=this;return Scribd.logged_in?(t=e.parents(".actions_container"),n={},n.document_id=t.data("docid"),Scribd.track_event("bookmark","newdoc","save",null,!0),e.addClass("disabled"),new $.ajax("/document_bookmarks/create",{type:"post",data:n,dataType:"json",success:function(e){}},e.addClass("bookmarked"),e.removeClass("disabled"),e.removeClass("bookmark"),e.children().first().addClass("bookmarked"),e.children().first().removeClass("bookmark"),e.children().last().html(I18n.t("js.saved")),Scribd.Popover.remote_open("bookmark_show_mobile_dialog",this.container.find(".action.bookmark,.action.bookmarked"),"/read/bookmark_show_mobile_dialog",Scribd.toolbar_params()))):Scribd.SignIn.open("login")},bookmarked:function(e){var t;return t=e.parents(".actions_container"),e.addClass("disabled"),Scribd.track_event("bookmark","newdoc","delete",null,!0),new $.ajax("/document_bookmarks/delete",{type:"post",data:{document_id:t.data("docid")},success:function(t){return e.removeClass("bookmarked"),e.removeClass("disabled"),e.addClass("bookmark"),e.children().first().removeClass("bookmarked"),e.children().first().addClass("bookmark"),e.children().last().html(I18n.t("js.save"))}})},zoom_in:function(){return docManager.zoom(1.25),this.zoom_changed()},zoom_out:function(){return docManager.zoom(.8),this.zoom_changed()},zoom_full:function(){return docManager._currentViewManager.isFullscreen?docManager.exitFullscreen():docManager.enterFullscreen(),this.zoom_changed(),$(document).trigger("scribd:dom_height_changed")},zoom_full_reflow:function(){var e,t;return e="fullscreen_reflow",t=window.location.href,t.indexOf("?")>-1?t+="&"+e+"=1":t+="?"+e+"=1",window.location.href=t},font_smaller:function(){return this.font_size=.75*this.font_size,this.resize_epub_font()},font_larger:function(){return this.font_size=1.25*this.font_size,this.resize_epub_font()},next_page:function(){return this.goto_page(this.current_page_num+1)},prev_page:function(){return this.goto_page(this.current_page_num-1)},readcast:function(){var e,t;return e="Please Log In to Readcast",t=Scribd.current_doc.url,Scribd.with_login(e,t,this.readcast_popup.manual_readcast)}},n.prototype.setup_readcast_popup=function(){var e=this;return this.readcast_popup=new Scribd.UI.StickyBarReadcaster({container:this.container.find(".sticky_bar_readcaster:first"),button:this.container.find(".readcast:first")}),Scribd.with_named_current_user(function(){var t,n;t=Scribd.named_current_user();if(!t)return;if(t.masked_admin)return;if(Scribd.current_doc["private"])return;if((n=Scribd.current_doc.auto_share)!=null?!n.scribd:!void 0)return;return _.delay(e.readcast_popup.passive_readcast,8e3)})},n.prototype.setup_events=function(){var e=this;return this.container.on("click",function(t){Scribd.UI.dispatch(t,e.actions,e,"sticky_bar")}),docManager.addEvent("expectedFirstPageChanged",function(t){return e.on_update_page_num(t)}),this.page_input&&this.setup_page_picker(),$(document).on("Scribd:Readcast:AutoShare:submitted",function(){if(e.readcast_indicator)return e.readcast_indicator.removeClass("readcast"),e.readcast_indicator.addClass("checkmark")}),this.container.mouseenter(function(){return e.hovering=!0}),this.container.mouseleave(function(){e.hovering=!1;if(e.deferred_set_group_width)return e.set_group_width()})},n.prototype.show_off_tooltips=function(){var e=this;return _.defer(function(){var t;e.container.find(".action.button.comment:visible").length&&!e.cookie_jar.get("annotations_seen_once")&&(Scribd.UI.annotation_first_time=!0,e.cookie_jar.put("annotations_seen_once",!0),e.container.find(".action.button.comment").addClass("highlight"),Scribd.Popover.remote_open("annotation_dialog",e.container.find(".action.comment"),"/read/annotation_dialog",Scribd.toolbar_params(),{close:!0,success:function(){return $("#annotation_dialog").find(".autogen_class_views_read_annotation_dialog").addClass("minimized first_time").click(function(){return e.container.find(".action.button.comment").removeClass("highlight"),Scribd.Popover.close()})}}));if(!e.cookie_jar.get("mobile_signup_seen_once"))return t=Scribd.UI.annotation_first_time?7e3:0,setTimeout(function(){var t;return e.cookie_jar.put("mobile_signup_seen_once",!0),t=Scribd.toolbar_params(),t.tooltip=!0,Scribd.Popover.remote_open("bookmark_show_mobile_dialog",e.container.find(".action.bookmark,.action.bookmarked"),"/read/bookmark_show_mobile_dialog",t)},t)})},n.prototype.resize_epub_font=function(){return $("#chunk").css("font-size",""+this.font_size+"em")},n.prototype.setup_page_picker=function(){var e=this;return _.defer(this.update_page_num),Scribd.restrict_input_to_numbers(this.page_input),this.max_page=this.get_highest_page(),this.container.find(".max_page:first").html(this.max_page),this.page_input.on("click",function(){return e.page_input.select()}),this.page_input.on("focus",function(){return e.container.addClass("input_focused")}),this.page_input.on("blur",function(){return e.container.removeClass("input_focused")}),this.page_input.on("keypress",function(t){if(t.keyCode===13)return e.update_page_from_input()}),this.page_input.on("keydown",function(t){var n;if(docManager.isScrolling)return!1;n=void 0;switch(t.keyCode){case 38:e.actions.prev_page.call(e),n="pager_prev_page";break;case 40:e.actions.next_page.call(e),n="pager_next_page";break;default:return}return Scribd.track_event("newdoc","Hotkey",n,Scribd.logged_in?1:0),e.page_input.select(),!1})},n.prototype.attach=function(){var e=this;return Scribd.StickyElement(this.container,this.set_fixed_position,this.set_absolute_position,function(){return e.options.fixed?!1:$(window).scrollTop()>e.spacer_top+e.spacer_padding},function(){})},n.prototype.set_fixed_position=function(e,t){return this.update_dimensions(),this.fixed=!0,this.container.addClass("fixed"),this.container.css({position:"fixed",top:"0px",left:"0px",width:$(window).width()+"px"},this.set_group_width())},n.prototype.set_absolute_position=function(e,t){var n;return this.update_dimensions(),this.fixed=!1,this.container.removeClass("fixed"),this.bar_width>0&&this.container.css({position:"",width:this.bar_width+"px"}),this.shrinking&&this.hovering?((n=this.shrinking_margin)==null&&(this.shrinking_margin=0),this.shrinking_margin-=Math.round((this.last_width-this.bar_width)/2),this.main_group.removeClass("animate"),this.main_group.css("margin-left",""+this.shrinking_margin+"px"),this.actions_container.addClass("hide_overflow")):this.shrinking_margin=null,this.set_group_width()},n.prototype.set_group_width=function(){var e,t=this;if(this.hovering){this.deferred_set_group_width=!0;return}this.deferred_set_group_width=!1,e=this.bar_width-(4+this.social_group.width()+this.main_group.width()+this.zoom_group.width())-37,e>0&&this.paging_group.css("width",e+"px"),this.main_group.addClass("animate"),this.main_group.css("margin-left","");if(this.shrinking)return _.delay(function(){return t.actions_container.removeClass("hide_overflow")},this.transition_time*1e3)},n.prototype.zoom_changed=function(){return Scribd.Popover.close(),this.update_zoom_out_clickability()},n.prototype.update_zoom_out_clickability=function(){var e,t,n;e=this.container.find(".zoom_out");if(e){t=docManager._currentViewManager;if(t)return n=t._currentZoomMultiplier,n<=1&&!t.isFullscreen||n<=.5?e.addClass("disabled"):e.removeClass("disabled")}},n.prototype.goto_page=function(e){var t,n;return t=e>this.current_page_num?1:-1,n=docManager.getClosestPageNumber(e,t),docManager.gotoPage(n,{direction:t})},n.prototype.get_highest_page=function(){var e,t;e=Scribd.current_doc.page_count;if(!e){e=0;for(t in docManager.pages)e=Math.max(e,t)}return e},n.prototype.update_page_num=function(){if(docManager.firstVisiblePage)return this.on_update_page_num(docManager.firstVisiblePage.pageNum)},n.prototype.on_update_page_num=function(e){return docManager.isScrolling||(this.current_page_num=e),this.page_input.val(this.current_page_num)},n.prototype.update_dimensions=function(){var e;this.spacer_top=this.spacer.offset().top,this.doc_width=this.document_column.width(),e=this.sidebar.width(),this.last_width=this.bar_width||0,this.bar_width=this.doc_width-2;if(!docManager._currentViewManager||!docManager._currentViewManager.isFullscreen)this.bar_width+=e;return this.shrinking=this.last_width>this.bar_width},n.prototype.update_page_from_input=function(){var e;e=parseInt(this.page_input.val(),10);if(!isNaN(e))return docManager.gotoPage(Math.min(e,this.max_page))},n}(),Scribd.UI.CommentsButton=function(){function t(t){this.scroll_to_pos=e(this.scroll_to_pos,this),this.click=e(this.click,this),this.listen_scroll=e(this.listen_scroll,this),this.container=$(t),this.container.on("click",this.click),this.saved_position=null}return t.prototype.listen_scroll=function(){var e=this;if(this.scroll_callback)return;return this.scroll_callback=function(){var t;t=$("#comments_container");if(t.viewportOffset().top>$(window).height())return $(window).off("scroll",e.scroll_callback),e.scroll_callback=!1,e.saved_position=null,e.container.removeClass("at_bottom")},$(window).on("scroll",this.scroll_callback)},t.prototype.click=function(){var e;return Scribd.track_event("newdoc","Click","sticky_bar_comment",Scribd.logged_in?1:0),this.saved_position!==null?(this.scroll_to_pos(this.saved_position),this.saved_position=null,this.container.removeClass("at_bottom")):(e=$("#comments_container"),e.viewportOffset().top>$(window).height()&&(this.saved_position=$(window).scrollTop(),this.container.addClass("at_bottom"),this.listen_scroll()),$.scrollTo(e))},t.prototype.scroll_to_pos=function(e){return $.scrollTo(e)},t}()}).call(this);


/* app/views/read/_sticky_bar_readcaster.coffee @ 1370554908 */
(function(){var e,t,n,r,i=[].slice;Scribd.UI||(Scribd.UI={}),r=function(){var e;return(e=Scribd.current_doc.auto_share)!=null?e.facebook:void 0},Scribd.UI.StickyBarReadcaster=function(){function n(e){_.bindAll(this),this.view=new t(this,e),this.submitted_readcast=!1,this.submitted_comment=!1,this._check_facebook()}return n.prototype._check_facebook=function(){var e;if((e=Scribd.named_current_user_sync())!=null?!e.is_facebook_user:!void 0)return;return this.needs_facebook=Scribd.facebook_login_status.then(function(){return Scribd.facebook.check_permission("publish_stream")})},n.prototype._track_click=function(e){return Scribd.track_event("Readcast","Click",e,+Scribd.logged_in)},n.prototype.manual_readcast=function(){var e=this;if(this.view.is_open()||!Scribd.current_doc.can_readcast)return;return this._track_click("read_submit_on_doc"),_.delay(this.view.loading,1e3),this.view.update(),this.submitted_readcast?(this.view.open(),this.view.stop_loading()):this._submit_readcast("manual",function(t){return e.view.open("comment_state"),e.view.stop_loading()})},n.prototype.passive_readcast=function(){var e=this;if(this.view.is_open()||!Scribd.current_doc.can_readcast||this.submitted_readcast)return;return this.view.update(),this._submit_readcast("auto",function(){return e.view.open("comment_state"),e.view.delayed_close()})},n.prototype._submit_readcast=function(t,n){var r,i=this;if(this.submitted_readcast){typeof n=="function"&&n(!0);return}return r=function(){return e.submit_readcast(t).then(function(e){if(!e)return;return Scribd.current_doc.can_readcast&&i.view.show_comment(),i.view.after_submit_readcast(e.total_readcasts),typeof n=="function"&&n(!Scribd.current_doc.can_readcast),i.submitted_readcast=e.job},function(){return i._error("There was a problem submitting the Readcast.")})},this.needs_facebook?this.needs_facebook.then(r,function(){return Scribd.facebook.login(function(e){return e?(i._update_facebook_token(),r()):i.view.close()})}):r()},n.prototype._update_facebook_token=function(){return $.post("/facebook_session",Scribd.CSRF.with_token({_method:"put"})),Scribd.facebook.cookie.set("active_facebook_session","true"),Scribd.facebook.cookie.save()},n.prototype._error=function(e){return Scribd.Alerts.error("flashes_placeholder",e,{auto_fade:!0,delay:3})},n.prototype._passive_state=function(){return this.view.current_state==="passive_readcasting_state"},n.prototype.on_focus=function(){if(!this._passive_state())return this.view.stop_delayed_close()},n.prototype.on_blur=function(){if(!this._passive_state())return this.view.delayed_close()},n.prototype.on_click_outside=function(){if(!this._passive_state())return this.view.fade_close()},n.prototype.on_cancel_comment=function(){return this._track_click("sticky_bar_popup_cancel_comment"),this.view.fade_close()},n.prototype.on_submit_comment=function(){var t,n=this;return this._track_click("sticky_bar_popup_submit_comment"),t=this.view.comment_text(),e.submit_comment(t).then(function(e){return n.submitted_comment=!0,n.refresh_comments()},function(){return n._error("There was a problem submitting the comment.")}),this.view.show_comment_preview(),this.view.delayed_close()},n.prototype.refresh_comments=function(){return Scribd.Backbone.document.get("comments").fetch()},n.prototype.on_toggle_readcasting=function(){return e.toggle_readcasting(),this.view.update_toggle_readcasting_link()},n.prototype.on_undo=function(){return this.view.stop_all(),$.post("/read/cancel_readcast",this.submitted_readcast),this.view.transition("cancelled_readcasting_state",{fade:!1})},n}(),e={submit_readcast:function(e){return $.post("/read/readcast/"+Scribd.current_doc.id,{type:e})},submit_comment:function(e,t){var n,r;return r={type:"post",dataType:"json",data:Scribd.CSRF.with_token({text:e})},_.extend(r.data,t),n=Scribd.current_doc.id,$.ajax("/documents/"+n+"/comments",r)},toggle_readcasting:function(){var e,t,n;return e=Scribd.current_doc.auto_share,n={_method:"put"},t=function(e){return"options[event_settings][reading]["+e+"]"},e.scribd=!e.scribd,n[t("scribd")]=e.scribd?"on":"off",r()!=null&&(e.facebook=e.scribd,n[t("facebook")]=n[t("scribd")]),$.post("/sharing_preference",n)}},n=function(e,t){var n;return n=null,function(){var r,s,o=this;return r=1<=arguments.length?i.call(arguments,0):[],s=function(){return n=null,e.apply(o,r)},clearTimeout(n),n=_.delay(s,t)}},t=function(){function e(e,t){this.presenter=e,this.container=t.container,this.button=t.button,_.bindAll(this),this.current_state=null,this._first_close=!0,this._first_comment_focus=!0,this.close_timeout=null,this.loading_timeout=null,this.transition_timeout=null,Scribd.current_doc.auto_share!=null&&this.update(),this._setup_events()}return e.prototype.on=function(){var e,t;return e=1<=arguments.length?i.call(arguments,0):[],(t=this.container).on.apply(t,e)},e.prototype.$=function(e){return this.container.find(e)},e.prototype.update=function(){var e;r()==null&&this.$(".facebook_logo").remove(),this.update_toggle_readcasting_link(),$(".tooltip_container").length||Scribd.hook_tooltips($("body"));if(!Scribd.current_doc.can_readcast)return e=$(".readcast.action.button"),e.addClass("disabled").attr("data-tooltip","You Readcasted this").trigger("scribd:update_tooltip")},e.prototype._setup_events=function(){var e,t,n,r,i,s,o,u=this;e=this.$(".comment_body > input"),e.addClass("inactive"),n="Add a comment",e.placeholder_text(n),t=this.$(".submit_comment"),e.on("focus",function(e){return t.removeClass("grey disabled").addClass("brown").prop("disabled",!1)}),e.on("blur",function(r){if(e.val()!==n)return;return t.addClass("grey disabled").removeClass("brown").prop("disabled",!0)}),o=[this.container,this.button];for(i=0,s=o.length;i<s;i++)r=o[i],r.on("mouseenter",function(e){return u.presenter.on_focus()}),r.on("mouseleave",function(e){return u.presenter.on_blur()});return this.on("click",function(e){return u.presenter.on_focus()}),$("body").on("click",function(e){var t;t=u.container.prop("id");if($(e.target).closest("#"+t).length)return;return u.presenter.on_click_outside()}),this.on("click",".cancel_comment",function(e){return e.preventDefault(),u.presenter.on_cancel_comment()}),this.on("click",".submit_comment",function(e){return e.preventDefault(),u.presenter.on_submit_comment()}),this.on("click",".toggle_readcasting",function(e){return e.preventDefault(),u.presenter.on_toggle_readcasting()}),this.on("click",".history",function(e){return e.preventDefault(),u.load_history()}),this.on("click",".undo",function(e){return e.preventDefault(),u.presenter.on_undo()})},e.prototype.load_history=function(){return Scribd.Lightbox.remote_open("readcast_history_dialog","/read/readcast_history_dialog")},e.prototype.after_submit_readcast=function(e){return this._add_tooltip(),this._update_total_readcasts(e)},e.prototype._add_tooltip=function(){var e;return e=I18n.t("js.newdoc.you_readcasted_this"),this.button.data("tooltip",e)},e.prototype.update_toggle_readcasting_link=function(){var e,t;return t=Scribd.current_doc.auto_share.scribd,e=this.$(".toggle_readcasting"),e.toggleClass("on",t),e.find(".on_or_off").text(t?"On":"Off")},e.prototype._update_total_readcasts=function(e){var t;return t=this._total_readcasts_message(e),this.$(".readcast_total > .text").html(t)},e.prototype._total_readcasts_message=function(e){var t;return t=function(){switch(e){case 0:case 1:return I18n.t("js.newdoc.you_readcasted_this");case 2:return I18n.t("js.newdoc.you_and_one_other_readcasted_this");default:return isNaN(e)?I18n.t("js.newdoc.you_readcasted_this"):I18n.t("js.newdoc.you_and_x_others_readcasted_this",{count:e-1})}}(),t+"."},e.prototype.loading=function(e){if(this.presenter.submitted_readcast)return;this.button.addClass("loading");if(e!=null)return this.loading_timeout=_.delay(this.stop_loading,e)},e.prototype.stop_loading=function(){return this.button.removeClass("loading"),clearTimeout(this.loading_timeout)},e.prototype.is_open=function(){return this.container.hasClass("open")},e.prototype.open=function(e){return this.is_open()?!1:(e&&e!==this.current_state&&(this.current_state=e),this.container.fadeIn(100).addClass("open"),this.$("."+this.current_state).addClass("active"),!0)},e.prototype.delayed_close=function(){return this._first_close?this.long_close():this.short_close()},e.prototype.stop_delayed_close=function(){if(this.close_timeout!=null)return clearTimeout(this.close_timeout)},e.prototype._execute_close_fn=function(e){if(this.$(".comment_body > input")===document.activeElement)return;return this.stop_delayed_close(),this.close_timeout=e()},e.prototype.short_close=function(){var e=this;return this._execute_close_fn(function(){return e._short_close_fn()})},e.prototype._short_close_fn=n(function(){return this.fade_close()},3e3),e.prototype.long_close=function(){var e=this;return this._execute_close_fn(function(){return e._long_close_fn()})},e.prototype._long_close_fn=n(function(){return this.fade_close()},15e3),e.prototype.fade_close=function(){return this.container.fadeOut(200,this.close)},e.prototype.close=function(){return this.stop_all(),this._first_close=!1,this.presenter.submitted_comment&&this.hide_comment(),this.container.removeClass("open"),this.$("."+this.current_state).removeClass("active")},e.prototype.transition=function(e,t){var n,r,i,s,o=this;return t&&(n=t.fade),this.container.css("opacity",1),s=this.$("."+this.current_state),i=this.$("."+e),e==="comment_state"&&_.delay(function(){return o.$(".undo").fadeOut(150)},6e4),r=function(){return o.$(".active").removeClass("active"),i.addClass("active"),o.current_state=e},n?s.fadeOut(500,r):r()},e.prototype.stop_transition=function(){return clearTimeout(this.transition_timeout)},e.prototype.stop_all=function(){return this.stop_delayed_close(),this.stop_transition(),this.stop_loading()},e.prototype.show_comment=function(){return this.$(".add_comment").removeClass("hidden")},e.prototype.hide_comment=function(){return this.$(".add_comment").addClass("hidden")},e.prototype.comment_text=function(){return this.$(".comment_body > input").val()},e.prototype.show_comment_preview=function(){return this.$(".add_comment").addClass("submitted"),this.$(".comment_body, .submit_comment").hide(),this.$(".comment_preview").text(this.comment_text()).show()},e}()}).call(this);


/* app/views/read/store/_buy_now.coffee @ 1370554908 */
(function(){Scribd.UI.SetupBuyButtons=function(e,t){var n,r,i;n=$(e);if(!Scribd.ServerOptions||!Scribd.ServerOptions.payments_store_disabled)return r=new Scribd.UI.BuyDocManager(t),i=r.get_premium_callback("sidebar_signup"),n.find(".premium_signup").click(i),n.find(".buy_button_row a").click(function(e,t){var n,r;return n=$(this).attr("href"),r=function(){return window.location.href=n},Scribd.logged_in?Scribd.FacebookSession.attempt_facebook_upgrade(r):r(),!1})}}).call(this);
